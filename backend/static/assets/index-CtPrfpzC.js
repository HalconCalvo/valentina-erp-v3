function $y(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function Hy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _m={exports:{}},Vc={},Sm={exports:{}},Ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Il=Symbol.for("react.element"),Gy=Symbol.for("react.portal"),Wy=Symbol.for("react.fragment"),Xy=Symbol.for("react.strict_mode"),qy=Symbol.for("react.profiler"),Yy=Symbol.for("react.provider"),Ky=Symbol.for("react.context"),Qy=Symbol.for("react.forward_ref"),Jy=Symbol.for("react.suspense"),Zy=Symbol.for("react.memo"),ew=Symbol.for("react.lazy"),Ih=Symbol.iterator;function tw(e){return e===null||typeof e!="object"?null:(e=Ih&&e[Ih]||e["@@iterator"],typeof e=="function"?e:null)}var Em={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nm=Object.assign,Cm={};function ci(e,t,r){this.props=e,this.context=t,this.refs=Cm,this.updater=r||Em}ci.prototype.isReactComponent={};ci.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ci.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Tm(){}Tm.prototype=ci.prototype;function Wd(e,t,r){this.props=e,this.context=t,this.refs=Cm,this.updater=r||Em}var Xd=Wd.prototype=new Tm;Xd.constructor=Wd;Nm(Xd,ci.prototype);Xd.isPureReactComponent=!0;var Ph=Array.isArray,bm=Object.prototype.hasOwnProperty,qd={current:null},Am={key:!0,ref:!0,__self:!0,__source:!0};function jm(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)bm.call(t,n)&&!Am.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Il,type:e,key:a,ref:i,props:s,_owner:qd.current}}function rw(e,t){return{$$typeof:Il,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Yd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Il}function nw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Lh=/\/+/g;function ku(e,t){return typeof e=="object"&&e!==null&&e.key!=null?nw(""+e.key):t.toString(36)}function Do(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Il:case Gy:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+ku(i,0):n,Ph(s)?(r="",e!=null&&(r=e.replace(Lh,"$&/")+"/"),Do(s,t,r,"",function(u){return u})):s!=null&&(Yd(s)&&(s=rw(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Lh,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",Ph(e))for(var o=0;o<e.length;o++){a=e[o];var c=n+ku(a,o);i+=Do(a,t,r,c,s)}else if(c=tw(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=n+ku(a,o++),i+=Do(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function ro(e,t,r){if(e==null)return e;var n=[],s=0;return Do(e,n,"","",function(a){return t.call(r,a,s++)}),n}function sw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var mr={current:null},Oo={transition:null},aw={ReactCurrentDispatcher:mr,ReactCurrentBatchConfig:Oo,ReactCurrentOwner:qd};function km(){throw Error("act(...) is not supported in production builds of React.")}Ge.Children={map:ro,forEach:function(e,t,r){ro(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return ro(e,function(){t++}),t},toArray:function(e){return ro(e,function(t){return t})||[]},only:function(e){if(!Yd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ge.Component=ci;Ge.Fragment=Wy;Ge.Profiler=qy;Ge.PureComponent=Wd;Ge.StrictMode=Xy;Ge.Suspense=Jy;Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aw;Ge.act=km;Ge.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Nm({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=qd.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)bm.call(t,c)&&!Am.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Il,type:e.type,key:s,ref:a,props:n,_owner:i}};Ge.createContext=function(e){return e={$$typeof:Ky,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Yy,_context:e},e.Consumer=e};Ge.createElement=jm;Ge.createFactory=function(e){var t=jm.bind(null,e);return t.type=e,t};Ge.createRef=function(){return{current:null}};Ge.forwardRef=function(e){return{$$typeof:Qy,render:e}};Ge.isValidElement=Yd;Ge.lazy=function(e){return{$$typeof:ew,_payload:{_status:-1,_result:e},_init:sw}};Ge.memo=function(e,t){return{$$typeof:Zy,type:e,compare:t===void 0?null:t}};Ge.startTransition=function(e){var t=Oo.transition;Oo.transition={};try{e()}finally{Oo.transition=t}};Ge.unstable_act=km;Ge.useCallback=function(e,t){return mr.current.useCallback(e,t)};Ge.useContext=function(e){return mr.current.useContext(e)};Ge.useDebugValue=function(){};Ge.useDeferredValue=function(e){return mr.current.useDeferredValue(e)};Ge.useEffect=function(e,t){return mr.current.useEffect(e,t)};Ge.useId=function(){return mr.current.useId()};Ge.useImperativeHandle=function(e,t,r){return mr.current.useImperativeHandle(e,t,r)};Ge.useInsertionEffect=function(e,t){return mr.current.useInsertionEffect(e,t)};Ge.useLayoutEffect=function(e,t){return mr.current.useLayoutEffect(e,t)};Ge.useMemo=function(e,t){return mr.current.useMemo(e,t)};Ge.useReducer=function(e,t,r){return mr.current.useReducer(e,t,r)};Ge.useRef=function(e){return mr.current.useRef(e)};Ge.useState=function(e){return mr.current.useState(e)};Ge.useSyncExternalStore=function(e,t,r){return mr.current.useSyncExternalStore(e,t,r)};Ge.useTransition=function(){return mr.current.useTransition()};Ge.version="18.3.1";Sm.exports=Ge;var b=Sm.exports;const qe=Hy(b),iw=$y({__proto__:null,default:qe},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lw=b,ow=Symbol.for("react.element"),cw=Symbol.for("react.fragment"),uw=Object.prototype.hasOwnProperty,dw=lw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fw={key:!0,ref:!0,__self:!0,__source:!0};function Rm(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)uw.call(t,n)&&!fw.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:ow,type:e,key:a,ref:i,props:s,_owner:dw.current}}Vc.Fragment=cw;Vc.jsx=Rm;Vc.jsxs=Rm;_m.exports=Vc;var l=_m.exports,R0={},Fm={exports:{}},Hr={},Dm={exports:{}},Om={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(q,se){var ue=q.length;q.push(se);e:for(;0<ue;){var fe=ue-1>>>1,R=q[fe];if(0<s(R,se))q[fe]=se,q[ue]=R,ue=fe;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var se=q[0],ue=q.pop();if(ue!==se){q[0]=ue;e:for(var fe=0,R=q.length,W=R>>>1;fe<W;){var B=2*(fe+1)-1,D=q[B],te=B+1,we=q[te];if(0>s(D,ue))te<R&&0>s(we,D)?(q[fe]=we,q[te]=ue,fe=te):(q[fe]=D,q[B]=ue,fe=B);else if(te<R&&0>s(we,ue))q[fe]=we,q[te]=ue,fe=te;else break e}}return se}function s(q,se){var ue=q.sortIndex-se.sortIndex;return ue!==0?ue:q.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,x=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(q){for(var se=r(u);se!==null;){if(se.callback===null)n(u);else if(se.startTime<=q)n(u),se.sortIndex=se.expirationTime,t(c,se);else break;se=r(u)}}function _(q){if(x=!1,w(q),!m)if(r(c)!==null)m=!0,G(S);else{var se=r(u);se!==null&&J(_,se.startTime-q)}}function S(q,se){m=!1,x&&(x=!1,y(I),I=-1),p=!0;var ue=f;try{for(w(se),h=r(c);h!==null&&(!(h.expirationTime>se)||q&&!X());){var fe=h.callback;if(typeof fe=="function"){h.callback=null,f=h.priorityLevel;var R=fe(h.expirationTime<=se);se=e.unstable_now(),typeof R=="function"?h.callback=R:h===r(c)&&n(c),w(se)}else n(c);h=r(c)}if(h!==null)var W=!0;else{var B=r(u);B!==null&&J(_,B.startTime-se),W=!1}return W}finally{h=null,f=ue,p=!1}}var P=!1,N=null,I=-1,M=5,L=-1;function X(){return!(e.unstable_now()-L<M)}function C(){if(N!==null){var q=e.unstable_now();L=q;var se=!0;try{se=N(!0,q)}finally{se?U():(P=!1,N=null)}}else P=!1}var U;if(typeof v=="function")U=function(){v(C)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,V=z.port2;z.port1.onmessage=C,U=function(){V.postMessage(null)}}else U=function(){g(C,0)};function G(q){N=q,P||(P=!0,U())}function J(q,se){I=g(function(){q(e.unstable_now())},se)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,G(S))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(q){switch(f){case 1:case 2:case 3:var se=3;break;default:se=f}var ue=f;f=se;try{return q()}finally{f=ue}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,se){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ue=f;f=q;try{return se()}finally{f=ue}},e.unstable_scheduleCallback=function(q,se,ue){var fe=e.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?fe+ue:fe):ue=fe,q){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=ue+R,q={id:d++,callback:se,priorityLevel:q,startTime:ue,expirationTime:R,sortIndex:-1},ue>fe?(q.sortIndex=ue,t(u,q),r(c)===null&&q===r(u)&&(x?(y(I),I=-1):x=!0,J(_,ue-fe))):(q.sortIndex=R,t(c,q),m||p||(m=!0,G(S))),q},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(q){var se=f;return function(){var ue=f;f=se;try{return q.apply(this,arguments)}finally{f=ue}}}})(Om);Dm.exports=Om;var hw=Dm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pw=b,zr=hw;function ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Im=new Set,al={};function da(e,t){Za(e,t),Za(e+"Capture",t)}function Za(e,t){for(al[e]=t,e=0;e<t.length;e++)Im.add(t[e])}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),F0=Object.prototype.hasOwnProperty,xw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mh={},Bh={};function mw(e){return F0.call(Bh,e)?!0:F0.call(Mh,e)?!1:xw.test(e)?Bh[e]=!0:(Mh[e]=!0,!1)}function gw(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vw(e,t,r,n){if(t===null||typeof t>"u"||gw(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function gr(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Kt[e]=new gr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Kt[t]=new gr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Kt[e]=new gr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Kt[e]=new gr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Kt[e]=new gr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Kt[e]=new gr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Kt[e]=new gr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Kt[e]=new gr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Kt[e]=new gr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Kd=/[\-:]([a-z])/g;function Qd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Kd,Qd);Kt[t]=new gr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Kd,Qd);Kt[t]=new gr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Kd,Qd);Kt[t]=new gr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Kt[e]=new gr(e,1,!1,e.toLowerCase(),null,!1,!1)});Kt.xlinkHref=new gr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Kt[e]=new gr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Jd(e,t,r,n){var s=Kt.hasOwnProperty(t)?Kt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(vw(t,r,s,n)&&(r=null),n||s===null?mw(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Zn=pw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,no=Symbol.for("react.element"),ba=Symbol.for("react.portal"),Aa=Symbol.for("react.fragment"),Zd=Symbol.for("react.strict_mode"),D0=Symbol.for("react.profiler"),Pm=Symbol.for("react.provider"),Lm=Symbol.for("react.context"),ef=Symbol.for("react.forward_ref"),O0=Symbol.for("react.suspense"),I0=Symbol.for("react.suspense_list"),tf=Symbol.for("react.memo"),as=Symbol.for("react.lazy"),Mm=Symbol.for("react.offscreen"),Uh=Symbol.iterator;function Ci(e){return e===null||typeof e!="object"?null:(e=Uh&&e[Uh]||e["@@iterator"],typeof e=="function"?e:null)}var vt=Object.assign,Ru;function Li(e){if(Ru===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ru=t&&t[1]||""}return`
`+Ru+e}var Fu=!1;function Du(e,t){if(!e||Fu)return"";Fu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{Fu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Li(e):""}function yw(e){switch(e.tag){case 5:return Li(e.type);case 16:return Li("Lazy");case 13:return Li("Suspense");case 19:return Li("SuspenseList");case 0:case 2:case 15:return e=Du(e.type,!1),e;case 11:return e=Du(e.type.render,!1),e;case 1:return e=Du(e.type,!0),e;default:return""}}function P0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Aa:return"Fragment";case ba:return"Portal";case D0:return"Profiler";case Zd:return"StrictMode";case O0:return"Suspense";case I0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Lm:return(e.displayName||"Context")+".Consumer";case Pm:return(e._context.displayName||"Context")+".Provider";case ef:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case tf:return t=e.displayName||null,t!==null?t:P0(e.type)||"Memo";case as:t=e._payload,e=e._init;try{return P0(e(t))}catch{}}return null}function ww(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return P0(t);case 8:return t===Zd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ts(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Bm(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function _w(e){var t=Bm(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function so(e){e._valueTracker||(e._valueTracker=_w(e))}function Um(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Bm(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Yo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function L0(e,t){var r=t.checked;return vt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function zh(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ts(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function zm(e,t){t=t.checked,t!=null&&Jd(e,"checked",t,!1)}function M0(e,t){zm(e,t);var r=Ts(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?B0(e,t.type,r):t.hasOwnProperty("defaultValue")&&B0(e,t.type,Ts(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Vh(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function B0(e,t,r){(t!=="number"||Yo(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Mi=Array.isArray;function za(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ts(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function U0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ge(91));return vt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $h(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ge(92));if(Mi(r)){if(1<r.length)throw Error(ge(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ts(r)}}function Vm(e,t){var r=Ts(t.value),n=Ts(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Hh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function $m(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function z0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?$m(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ao,Hm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ao=ao||document.createElement("div"),ao.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ao.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function il(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Vi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sw=["Webkit","ms","Moz","O"];Object.keys(Vi).forEach(function(e){Sw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Vi[t]=Vi[e]})});function Gm(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Vi.hasOwnProperty(e)&&Vi[e]?(""+t).trim():t+"px"}function Wm(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Gm(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var Ew=vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function V0(e,t){if(t){if(Ew[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ge(62))}}function $0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var H0=null;function rf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var G0=null,Va=null,$a=null;function Gh(e){if(e=Ml(e)){if(typeof G0!="function")throw Error(ge(280));var t=e.stateNode;t&&(t=Xc(t),G0(e.stateNode,e.type,t))}}function Xm(e){Va?$a?$a.push(e):$a=[e]:Va=e}function qm(){if(Va){var e=Va,t=$a;if($a=Va=null,Gh(e),t)for(e=0;e<t.length;e++)Gh(t[e])}}function Ym(e,t){return e(t)}function Km(){}var Ou=!1;function Qm(e,t,r){if(Ou)return e(t,r);Ou=!0;try{return Ym(e,t,r)}finally{Ou=!1,(Va!==null||$a!==null)&&(Km(),qm())}}function ll(e,t){var r=e.stateNode;if(r===null)return null;var n=Xc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ge(231,t,typeof r));return r}var W0=!1;if(Xn)try{var Ti={};Object.defineProperty(Ti,"passive",{get:function(){W0=!0}}),window.addEventListener("test",Ti,Ti),window.removeEventListener("test",Ti,Ti)}catch{W0=!1}function Nw(e,t,r,n,s,a,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var $i=!1,Ko=null,Qo=!1,X0=null,Cw={onError:function(e){$i=!0,Ko=e}};function Tw(e,t,r,n,s,a,i,o,c){$i=!1,Ko=null,Nw.apply(Cw,arguments)}function bw(e,t,r,n,s,a,i,o,c){if(Tw.apply(this,arguments),$i){if($i){var u=Ko;$i=!1,Ko=null}else throw Error(ge(198));Qo||(Qo=!0,X0=u)}}function fa(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Jm(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wh(e){if(fa(e)!==e)throw Error(ge(188))}function Aw(e){var t=e.alternate;if(!t){if(t=fa(e),t===null)throw Error(ge(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return Wh(s),e;if(a===n)return Wh(s),t;a=a.sibling}throw Error(ge(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(ge(189))}}if(r.alternate!==n)throw Error(ge(190))}if(r.tag!==3)throw Error(ge(188));return r.stateNode.current===r?e:t}function Zm(e){return e=Aw(e),e!==null?eg(e):null}function eg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=eg(e);if(t!==null)return t;e=e.sibling}return null}var tg=zr.unstable_scheduleCallback,Xh=zr.unstable_cancelCallback,jw=zr.unstable_shouldYield,kw=zr.unstable_requestPaint,Tt=zr.unstable_now,Rw=zr.unstable_getCurrentPriorityLevel,nf=zr.unstable_ImmediatePriority,rg=zr.unstable_UserBlockingPriority,Jo=zr.unstable_NormalPriority,Fw=zr.unstable_LowPriority,ng=zr.unstable_IdlePriority,$c=null,An=null;function Dw(e){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot($c,e,void 0,(e.current.flags&128)===128)}catch{}}var pn=Math.clz32?Math.clz32:Pw,Ow=Math.log,Iw=Math.LN2;function Pw(e){return e>>>=0,e===0?32:31-(Ow(e)/Iw|0)|0}var io=64,lo=4194304;function Bi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zo(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Bi(o):(a&=i,a!==0&&(n=Bi(a)))}else i=r&~s,i!==0?n=Bi(i):a!==0&&(n=Bi(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-pn(t),s=1<<r,n|=e[r],t&=~s;return n}function Lw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mw(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-pn(a),o=1<<i,c=s[i];c===-1?(!(o&r)||o&n)&&(s[i]=Lw(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}function q0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sg(){var e=io;return io<<=1,!(io&4194240)&&(io=64),e}function Iu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Pl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-pn(t),e[t]=r}function Bw(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-pn(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function sf(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-pn(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var tt=0;function ag(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ig,af,lg,og,cg,Y0=!1,oo=[],ms=null,gs=null,vs=null,ol=new Map,cl=new Map,ls=[],Uw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qh(e,t){switch(e){case"focusin":case"focusout":ms=null;break;case"dragenter":case"dragleave":gs=null;break;case"mouseover":case"mouseout":vs=null;break;case"pointerover":case"pointerout":ol.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":cl.delete(t.pointerId)}}function bi(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=Ml(t),t!==null&&af(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function zw(e,t,r,n,s){switch(t){case"focusin":return ms=bi(ms,e,t,r,n,s),!0;case"dragenter":return gs=bi(gs,e,t,r,n,s),!0;case"mouseover":return vs=bi(vs,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return ol.set(a,bi(ol.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,cl.set(a,bi(cl.get(a)||null,e,t,r,n,s)),!0}return!1}function ug(e){var t=Hs(e.target);if(t!==null){var r=fa(t);if(r!==null){if(t=r.tag,t===13){if(t=Jm(r),t!==null){e.blockedOn=t,cg(e.priority,function(){lg(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Io(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=K0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);H0=n,r.target.dispatchEvent(n),H0=null}else return t=Ml(r),t!==null&&af(t),e.blockedOn=r,!1;t.shift()}return!0}function Yh(e,t,r){Io(e)&&r.delete(t)}function Vw(){Y0=!1,ms!==null&&Io(ms)&&(ms=null),gs!==null&&Io(gs)&&(gs=null),vs!==null&&Io(vs)&&(vs=null),ol.forEach(Yh),cl.forEach(Yh)}function Ai(e,t){e.blockedOn===t&&(e.blockedOn=null,Y0||(Y0=!0,zr.unstable_scheduleCallback(zr.unstable_NormalPriority,Vw)))}function ul(e){function t(s){return Ai(s,e)}if(0<oo.length){Ai(oo[0],e);for(var r=1;r<oo.length;r++){var n=oo[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ms!==null&&Ai(ms,e),gs!==null&&Ai(gs,e),vs!==null&&Ai(vs,e),ol.forEach(t),cl.forEach(t),r=0;r<ls.length;r++)n=ls[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ls.length&&(r=ls[0],r.blockedOn===null);)ug(r),r.blockedOn===null&&ls.shift()}var Ha=Zn.ReactCurrentBatchConfig,ec=!0;function $w(e,t,r,n){var s=tt,a=Ha.transition;Ha.transition=null;try{tt=1,lf(e,t,r,n)}finally{tt=s,Ha.transition=a}}function Hw(e,t,r,n){var s=tt,a=Ha.transition;Ha.transition=null;try{tt=4,lf(e,t,r,n)}finally{tt=s,Ha.transition=a}}function lf(e,t,r,n){if(ec){var s=K0(e,t,r,n);if(s===null)Gu(e,t,n,tc,r),qh(e,n);else if(zw(s,e,t,r,n))n.stopPropagation();else if(qh(e,n),t&4&&-1<Uw.indexOf(e)){for(;s!==null;){var a=Ml(s);if(a!==null&&ig(a),a=K0(e,t,r,n),a===null&&Gu(e,t,n,tc,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else Gu(e,t,n,null,r)}}var tc=null;function K0(e,t,r,n){if(tc=null,e=rf(n),e=Hs(e),e!==null)if(t=fa(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Jm(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return tc=e,null}function dg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rw()){case nf:return 1;case rg:return 4;case Jo:case Fw:return 16;case ng:return 536870912;default:return 16}default:return 16}}var us=null,of=null,Po=null;function fg(){if(Po)return Po;var e,t=of,r=t.length,n,s="value"in us?us.value:us.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return Po=s.slice(e,1<n?1-n:void 0)}function Lo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function co(){return!0}function Kh(){return!1}function Gr(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?co:Kh,this.isPropagationStopped=Kh,this}return vt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=co)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=co)},persist:function(){},isPersistent:co}),t}var ui={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cf=Gr(ui),Ll=vt({},ui,{view:0,detail:0}),Gw=Gr(Ll),Pu,Lu,ji,Hc=vt({},Ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ji&&(ji&&e.type==="mousemove"?(Pu=e.screenX-ji.screenX,Lu=e.screenY-ji.screenY):Lu=Pu=0,ji=e),Pu)},movementY:function(e){return"movementY"in e?e.movementY:Lu}}),Qh=Gr(Hc),Ww=vt({},Hc,{dataTransfer:0}),Xw=Gr(Ww),qw=vt({},Ll,{relatedTarget:0}),Mu=Gr(qw),Yw=vt({},ui,{animationName:0,elapsedTime:0,pseudoElement:0}),Kw=Gr(Yw),Qw=vt({},ui,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jw=Gr(Qw),Zw=vt({},ui,{data:0}),Jh=Gr(Zw),e_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},t_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function n_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=r_[e])?!!t[e]:!1}function uf(){return n_}var s_=vt({},Ll,{key:function(e){if(e.key){var t=e_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Lo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?t_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uf,charCode:function(e){return e.type==="keypress"?Lo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),a_=Gr(s_),i_=vt({},Hc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zh=Gr(i_),l_=vt({},Ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uf}),o_=Gr(l_),c_=vt({},ui,{propertyName:0,elapsedTime:0,pseudoElement:0}),u_=Gr(c_),d_=vt({},Hc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),f_=Gr(d_),h_=[9,13,27,32],df=Xn&&"CompositionEvent"in window,Hi=null;Xn&&"documentMode"in document&&(Hi=document.documentMode);var p_=Xn&&"TextEvent"in window&&!Hi,hg=Xn&&(!df||Hi&&8<Hi&&11>=Hi),ep=" ",tp=!1;function pg(e,t){switch(e){case"keyup":return h_.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ja=!1;function x_(e,t){switch(e){case"compositionend":return xg(t);case"keypress":return t.which!==32?null:(tp=!0,ep);case"textInput":return e=t.data,e===ep&&tp?null:e;default:return null}}function m_(e,t){if(ja)return e==="compositionend"||!df&&pg(e,t)?(e=fg(),Po=of=us=null,ja=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return hg&&t.locale!=="ko"?null:t.data;default:return null}}var g_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!g_[e.type]:t==="textarea"}function mg(e,t,r,n){Xm(n),t=rc(t,"onChange"),0<t.length&&(r=new cf("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gi=null,dl=null;function v_(e){bg(e,0)}function Gc(e){var t=Fa(e);if(Um(t))return e}function y_(e,t){if(e==="change")return t}var gg=!1;if(Xn){var Bu;if(Xn){var Uu="oninput"in document;if(!Uu){var np=document.createElement("div");np.setAttribute("oninput","return;"),Uu=typeof np.oninput=="function"}Bu=Uu}else Bu=!1;gg=Bu&&(!document.documentMode||9<document.documentMode)}function sp(){Gi&&(Gi.detachEvent("onpropertychange",vg),dl=Gi=null)}function vg(e){if(e.propertyName==="value"&&Gc(dl)){var t=[];mg(t,dl,e,rf(e)),Qm(v_,t)}}function w_(e,t,r){e==="focusin"?(sp(),Gi=t,dl=r,Gi.attachEvent("onpropertychange",vg)):e==="focusout"&&sp()}function __(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Gc(dl)}function S_(e,t){if(e==="click")return Gc(t)}function E_(e,t){if(e==="input"||e==="change")return Gc(t)}function N_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vn=typeof Object.is=="function"?Object.is:N_;function fl(e,t){if(vn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!F0.call(t,s)||!vn(e[s],t[s]))return!1}return!0}function ap(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ip(e,t){var r=ap(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ap(r)}}function yg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?yg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function wg(){for(var e=window,t=Yo();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Yo(e.document)}return t}function ff(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function C_(e){var t=wg(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&yg(r.ownerDocument.documentElement,r)){if(n!==null&&ff(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=ip(r,a);var i=ip(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var T_=Xn&&"documentMode"in document&&11>=document.documentMode,ka=null,Q0=null,Wi=null,J0=!1;function lp(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;J0||ka==null||ka!==Yo(n)||(n=ka,"selectionStart"in n&&ff(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Wi&&fl(Wi,n)||(Wi=n,n=rc(Q0,"onSelect"),0<n.length&&(t=new cf("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ka)))}function uo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ra={animationend:uo("Animation","AnimationEnd"),animationiteration:uo("Animation","AnimationIteration"),animationstart:uo("Animation","AnimationStart"),transitionend:uo("Transition","TransitionEnd")},zu={},_g={};Xn&&(_g=document.createElement("div").style,"AnimationEvent"in window||(delete Ra.animationend.animation,delete Ra.animationiteration.animation,delete Ra.animationstart.animation),"TransitionEvent"in window||delete Ra.transitionend.transition);function Wc(e){if(zu[e])return zu[e];if(!Ra[e])return e;var t=Ra[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in _g)return zu[e]=t[r];return e}var Sg=Wc("animationend"),Eg=Wc("animationiteration"),Ng=Wc("animationstart"),Cg=Wc("transitionend"),Tg=new Map,op="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Is(e,t){Tg.set(e,t),da(t,[e])}for(var Vu=0;Vu<op.length;Vu++){var $u=op[Vu],b_=$u.toLowerCase(),A_=$u[0].toUpperCase()+$u.slice(1);Is(b_,"on"+A_)}Is(Sg,"onAnimationEnd");Is(Eg,"onAnimationIteration");Is(Ng,"onAnimationStart");Is("dblclick","onDoubleClick");Is("focusin","onFocus");Is("focusout","onBlur");Is(Cg,"onTransitionEnd");Za("onMouseEnter",["mouseout","mouseover"]);Za("onMouseLeave",["mouseout","mouseover"]);Za("onPointerEnter",["pointerout","pointerover"]);Za("onPointerLeave",["pointerout","pointerover"]);da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));da("onBeforeInput",["compositionend","keypress","textInput","paste"]);da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ui="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),j_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ui));function cp(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,bw(n,t,void 0,e),e.currentTarget=null}function bg(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==a&&s.isPropagationStopped())break e;cp(s,o,u),a=c}else for(i=0;i<n.length;i++){if(o=n[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==a&&s.isPropagationStopped())break e;cp(s,o,u),a=c}}}if(Qo)throw e=X0,Qo=!1,X0=null,e}function ct(e,t){var r=t[nd];r===void 0&&(r=t[nd]=new Set);var n=e+"__bubble";r.has(n)||(Ag(t,e,2,!1),r.add(n))}function Hu(e,t,r){var n=0;t&&(n|=4),Ag(r,e,n,t)}var fo="_reactListening"+Math.random().toString(36).slice(2);function hl(e){if(!e[fo]){e[fo]=!0,Im.forEach(function(r){r!=="selectionchange"&&(j_.has(r)||Hu(r,!1,e),Hu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fo]||(t[fo]=!0,Hu("selectionchange",!1,t))}}function Ag(e,t,r,n){switch(dg(t)){case 1:var s=$w;break;case 4:s=Hw;break;default:s=lf}r=s.bind(null,t,r,e),s=void 0,!W0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Gu(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Hs(o),i===null)return;if(c=i.tag,c===5||c===6){n=a=i;continue e}o=o.parentNode}}n=n.return}Qm(function(){var u=a,d=rf(r),h=[];e:{var f=Tg.get(e);if(f!==void 0){var p=cf,m=e;switch(e){case"keypress":if(Lo(r)===0)break e;case"keydown":case"keyup":p=a_;break;case"focusin":m="focus",p=Mu;break;case"focusout":m="blur",p=Mu;break;case"beforeblur":case"afterblur":p=Mu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Qh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Xw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=o_;break;case Sg:case Eg:case Ng:p=Kw;break;case Cg:p=u_;break;case"scroll":p=Gw;break;case"wheel":p=f_;break;case"copy":case"cut":case"paste":p=Jw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Zh}var x=(t&4)!==0,g=!x&&e==="scroll",y=x?f!==null?f+"Capture":null:f;x=[];for(var v=u,w;v!==null;){w=v;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,y!==null&&(_=ll(v,y),_!=null&&x.push(pl(v,_,w)))),g)break;v=v.return}0<x.length&&(f=new p(f,m,null,r,d),h.push({event:f,listeners:x}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&r!==H0&&(m=r.relatedTarget||r.fromElement)&&(Hs(m)||m[qn]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=u,m=m?Hs(m):null,m!==null&&(g=fa(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(x=Qh,_="onMouseLeave",y="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(x=Zh,_="onPointerLeave",y="onPointerEnter",v="pointer"),g=p==null?f:Fa(p),w=m==null?f:Fa(m),f=new x(_,v+"leave",p,r,d),f.target=g,f.relatedTarget=w,_=null,Hs(d)===u&&(x=new x(y,v+"enter",m,r,d),x.target=w,x.relatedTarget=g,_=x),g=_,p&&m)t:{for(x=p,y=m,v=0,w=x;w;w=wa(w))v++;for(w=0,_=y;_;_=wa(_))w++;for(;0<v-w;)x=wa(x),v--;for(;0<w-v;)y=wa(y),w--;for(;v--;){if(x===y||y!==null&&x===y.alternate)break t;x=wa(x),y=wa(y)}x=null}else x=null;p!==null&&up(h,f,p,x,!1),m!==null&&g!==null&&up(h,g,m,x,!0)}}e:{if(f=u?Fa(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var S=y_;else if(rp(f))if(gg)S=E_;else{S=__;var P=w_}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=S_);if(S&&(S=S(e,u))){mg(h,S,r,d);break e}P&&P(e,f,u),e==="focusout"&&(P=f._wrapperState)&&P.controlled&&f.type==="number"&&B0(f,"number",f.value)}switch(P=u?Fa(u):window,e){case"focusin":(rp(P)||P.contentEditable==="true")&&(ka=P,Q0=u,Wi=null);break;case"focusout":Wi=Q0=ka=null;break;case"mousedown":J0=!0;break;case"contextmenu":case"mouseup":case"dragend":J0=!1,lp(h,r,d);break;case"selectionchange":if(T_)break;case"keydown":case"keyup":lp(h,r,d)}var N;if(df)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else ja?pg(e,r)&&(I="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(hg&&r.locale!=="ko"&&(ja||I!=="onCompositionStart"?I==="onCompositionEnd"&&ja&&(N=fg()):(us=d,of="value"in us?us.value:us.textContent,ja=!0)),P=rc(u,I),0<P.length&&(I=new Jh(I,e,null,r,d),h.push({event:I,listeners:P}),N?I.data=N:(N=xg(r),N!==null&&(I.data=N)))),(N=p_?x_(e,r):m_(e,r))&&(u=rc(u,"onBeforeInput"),0<u.length&&(d=new Jh("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=N))}bg(h,t)})}function pl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function rc(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=ll(e,r),a!=null&&n.unshift(pl(e,a,s)),a=ll(e,t),a!=null&&n.push(pl(e,a,s))),e=e.return}return n}function wa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function up(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,s?(c=ll(r,a),c!=null&&i.unshift(pl(r,c,o))):s||(c=ll(r,a),c!=null&&i.push(pl(r,c,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var k_=/\r\n?/g,R_=/\u0000|\uFFFD/g;function dp(e){return(typeof e=="string"?e:""+e).replace(k_,`
`).replace(R_,"")}function ho(e,t,r){if(t=dp(t),dp(e)!==t&&r)throw Error(ge(425))}function nc(){}var Z0=null,ed=null;function td(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var rd=typeof setTimeout=="function"?setTimeout:void 0,F_=typeof clearTimeout=="function"?clearTimeout:void 0,fp=typeof Promise=="function"?Promise:void 0,D_=typeof queueMicrotask=="function"?queueMicrotask:typeof fp<"u"?function(e){return fp.resolve(null).then(e).catch(O_)}:rd;function O_(e){setTimeout(function(){throw e})}function Wu(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),ul(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);ul(t)}function ys(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function hp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),bn="__reactFiber$"+di,xl="__reactProps$"+di,qn="__reactContainer$"+di,nd="__reactEvents$"+di,I_="__reactListeners$"+di,P_="__reactHandles$"+di;function Hs(e){var t=e[bn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[qn]||r[bn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=hp(e);e!==null;){if(r=e[bn])return r;e=hp(e)}return t}e=r,r=e.parentNode}return null}function Ml(e){return e=e[bn]||e[qn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Fa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ge(33))}function Xc(e){return e[xl]||null}var sd=[],Da=-1;function Ps(e){return{current:e}}function dt(e){0>Da||(e.current=sd[Da],sd[Da]=null,Da--)}function lt(e,t){Da++,sd[Da]=e.current,e.current=t}var bs={},lr=Ps(bs),Nr=Ps(!1),ea=bs;function ei(e,t){var r=e.type.contextTypes;if(!r)return bs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Cr(e){return e=e.childContextTypes,e!=null}function sc(){dt(Nr),dt(lr)}function pp(e,t,r){if(lr.current!==bs)throw Error(ge(168));lt(lr,t),lt(Nr,r)}function jg(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(ge(108,ww(e)||"Unknown",s));return vt({},r,n)}function ac(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bs,ea=lr.current,lt(lr,e),lt(Nr,Nr.current),!0}function xp(e,t,r){var n=e.stateNode;if(!n)throw Error(ge(169));r?(e=jg(e,t,ea),n.__reactInternalMemoizedMergedChildContext=e,dt(Nr),dt(lr),lt(lr,e)):dt(Nr),lt(Nr,r)}var Bn=null,qc=!1,Xu=!1;function kg(e){Bn===null?Bn=[e]:Bn.push(e)}function L_(e){qc=!0,kg(e)}function Ls(){if(!Xu&&Bn!==null){Xu=!0;var e=0,t=tt;try{var r=Bn;for(tt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Bn=null,qc=!1}catch(s){throw Bn!==null&&(Bn=Bn.slice(e+1)),tg(nf,Ls),s}finally{tt=t,Xu=!1}}return null}var Oa=[],Ia=0,ic=null,lc=0,qr=[],Yr=0,ta=null,Un=1,zn="";function zs(e,t){Oa[Ia++]=lc,Oa[Ia++]=ic,ic=e,lc=t}function Rg(e,t,r){qr[Yr++]=Un,qr[Yr++]=zn,qr[Yr++]=ta,ta=e;var n=Un;e=zn;var s=32-pn(n)-1;n&=~(1<<s),r+=1;var a=32-pn(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Un=1<<32-pn(t)+s|r<<s|n,zn=a+e}else Un=1<<a|r<<s|n,zn=e}function hf(e){e.return!==null&&(zs(e,1),Rg(e,1,0))}function pf(e){for(;e===ic;)ic=Oa[--Ia],Oa[Ia]=null,lc=Oa[--Ia],Oa[Ia]=null;for(;e===ta;)ta=qr[--Yr],qr[Yr]=null,zn=qr[--Yr],qr[Yr]=null,Un=qr[--Yr],qr[Yr]=null}var Ur=null,Br=null,ht=!1,cn=null;function Fg(e,t){var r=Qr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function mp(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ur=e,Br=ys(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ur=e,Br=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ta!==null?{id:Un,overflow:zn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Qr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ur=e,Br=null,!0):!1;default:return!1}}function ad(e){return(e.mode&1)!==0&&(e.flags&128)===0}function id(e){if(ht){var t=Br;if(t){var r=t;if(!mp(e,t)){if(ad(e))throw Error(ge(418));t=ys(r.nextSibling);var n=Ur;t&&mp(e,t)?Fg(n,r):(e.flags=e.flags&-4097|2,ht=!1,Ur=e)}}else{if(ad(e))throw Error(ge(418));e.flags=e.flags&-4097|2,ht=!1,Ur=e}}}function gp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ur=e}function po(e){if(e!==Ur)return!1;if(!ht)return gp(e),ht=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!td(e.type,e.memoizedProps)),t&&(t=Br)){if(ad(e))throw Dg(),Error(ge(418));for(;t;)Fg(e,t),t=ys(t.nextSibling)}if(gp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Br=ys(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Br=null}}else Br=Ur?ys(e.stateNode.nextSibling):null;return!0}function Dg(){for(var e=Br;e;)e=ys(e.nextSibling)}function ti(){Br=Ur=null,ht=!1}function xf(e){cn===null?cn=[e]:cn.push(e)}var M_=Zn.ReactCurrentBatchConfig;function ki(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ge(309));var n=r.stateNode}if(!n)throw Error(ge(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(ge(284));if(!r._owner)throw Error(ge(290,e))}return e}function xo(e,t){throw e=Object.prototype.toString.call(t),Error(ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vp(e){var t=e._init;return t(e._payload)}function Og(e){function t(y,v){if(e){var w=y.deletions;w===null?(y.deletions=[v],y.flags|=16):w.push(v)}}function r(y,v){if(!e)return null;for(;v!==null;)t(y,v),v=v.sibling;return null}function n(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function s(y,v){return y=Es(y,v),y.index=0,y.sibling=null,y}function a(y,v,w){return y.index=w,e?(w=y.alternate,w!==null?(w=w.index,w<v?(y.flags|=2,v):w):(y.flags|=2,v)):(y.flags|=1048576,v)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,v,w,_){return v===null||v.tag!==6?(v=e0(w,y.mode,_),v.return=y,v):(v=s(v,w),v.return=y,v)}function c(y,v,w,_){var S=w.type;return S===Aa?d(y,v,w.props.children,_,w.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===as&&vp(S)===v.type)?(_=s(v,w.props),_.ref=ki(y,v,w),_.return=y,_):(_=Ho(w.type,w.key,w.props,null,y.mode,_),_.ref=ki(y,v,w),_.return=y,_)}function u(y,v,w,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=t0(w,y.mode,_),v.return=y,v):(v=s(v,w.children||[]),v.return=y,v)}function d(y,v,w,_,S){return v===null||v.tag!==7?(v=Qs(w,y.mode,_,S),v.return=y,v):(v=s(v,w),v.return=y,v)}function h(y,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=e0(""+v,y.mode,w),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case no:return w=Ho(v.type,v.key,v.props,null,y.mode,w),w.ref=ki(y,null,v),w.return=y,w;case ba:return v=t0(v,y.mode,w),v.return=y,v;case as:var _=v._init;return h(y,_(v._payload),w)}if(Mi(v)||Ci(v))return v=Qs(v,y.mode,w,null),v.return=y,v;xo(y,v)}return null}function f(y,v,w,_){var S=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:o(y,v,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case no:return w.key===S?c(y,v,w,_):null;case ba:return w.key===S?u(y,v,w,_):null;case as:return S=w._init,f(y,v,S(w._payload),_)}if(Mi(w)||Ci(w))return S!==null?null:d(y,v,w,_,null);xo(y,w)}return null}function p(y,v,w,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(w)||null,o(v,y,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case no:return y=y.get(_.key===null?w:_.key)||null,c(v,y,_,S);case ba:return y=y.get(_.key===null?w:_.key)||null,u(v,y,_,S);case as:var P=_._init;return p(y,v,w,P(_._payload),S)}if(Mi(_)||Ci(_))return y=y.get(w)||null,d(v,y,_,S,null);xo(v,_)}return null}function m(y,v,w,_){for(var S=null,P=null,N=v,I=v=0,M=null;N!==null&&I<w.length;I++){N.index>I?(M=N,N=null):M=N.sibling;var L=f(y,N,w[I],_);if(L===null){N===null&&(N=M);break}e&&N&&L.alternate===null&&t(y,N),v=a(L,v,I),P===null?S=L:P.sibling=L,P=L,N=M}if(I===w.length)return r(y,N),ht&&zs(y,I),S;if(N===null){for(;I<w.length;I++)N=h(y,w[I],_),N!==null&&(v=a(N,v,I),P===null?S=N:P.sibling=N,P=N);return ht&&zs(y,I),S}for(N=n(y,N);I<w.length;I++)M=p(N,y,I,w[I],_),M!==null&&(e&&M.alternate!==null&&N.delete(M.key===null?I:M.key),v=a(M,v,I),P===null?S=M:P.sibling=M,P=M);return e&&N.forEach(function(X){return t(y,X)}),ht&&zs(y,I),S}function x(y,v,w,_){var S=Ci(w);if(typeof S!="function")throw Error(ge(150));if(w=S.call(w),w==null)throw Error(ge(151));for(var P=S=null,N=v,I=v=0,M=null,L=w.next();N!==null&&!L.done;I++,L=w.next()){N.index>I?(M=N,N=null):M=N.sibling;var X=f(y,N,L.value,_);if(X===null){N===null&&(N=M);break}e&&N&&X.alternate===null&&t(y,N),v=a(X,v,I),P===null?S=X:P.sibling=X,P=X,N=M}if(L.done)return r(y,N),ht&&zs(y,I),S;if(N===null){for(;!L.done;I++,L=w.next())L=h(y,L.value,_),L!==null&&(v=a(L,v,I),P===null?S=L:P.sibling=L,P=L);return ht&&zs(y,I),S}for(N=n(y,N);!L.done;I++,L=w.next())L=p(N,y,I,L.value,_),L!==null&&(e&&L.alternate!==null&&N.delete(L.key===null?I:L.key),v=a(L,v,I),P===null?S=L:P.sibling=L,P=L);return e&&N.forEach(function(C){return t(y,C)}),ht&&zs(y,I),S}function g(y,v,w,_){if(typeof w=="object"&&w!==null&&w.type===Aa&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case no:e:{for(var S=w.key,P=v;P!==null;){if(P.key===S){if(S=w.type,S===Aa){if(P.tag===7){r(y,P.sibling),v=s(P,w.props.children),v.return=y,y=v;break e}}else if(P.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===as&&vp(S)===P.type){r(y,P.sibling),v=s(P,w.props),v.ref=ki(y,P,w),v.return=y,y=v;break e}r(y,P);break}else t(y,P);P=P.sibling}w.type===Aa?(v=Qs(w.props.children,y.mode,_,w.key),v.return=y,y=v):(_=Ho(w.type,w.key,w.props,null,y.mode,_),_.ref=ki(y,v,w),_.return=y,y=_)}return i(y);case ba:e:{for(P=w.key;v!==null;){if(v.key===P)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){r(y,v.sibling),v=s(v,w.children||[]),v.return=y,y=v;break e}else{r(y,v);break}else t(y,v);v=v.sibling}v=t0(w,y.mode,_),v.return=y,y=v}return i(y);case as:return P=w._init,g(y,v,P(w._payload),_)}if(Mi(w))return m(y,v,w,_);if(Ci(w))return x(y,v,w,_);xo(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(r(y,v.sibling),v=s(v,w),v.return=y,y=v):(r(y,v),v=e0(w,y.mode,_),v.return=y,y=v),i(y)):r(y,v)}return g}var ri=Og(!0),Ig=Og(!1),oc=Ps(null),cc=null,Pa=null,mf=null;function gf(){mf=Pa=cc=null}function vf(e){var t=oc.current;dt(oc),e._currentValue=t}function ld(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ga(e,t){cc=e,mf=Pa=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Sr=!0),e.firstContext=null)}function Zr(e){var t=e._currentValue;if(mf!==e)if(e={context:e,memoizedValue:t,next:null},Pa===null){if(cc===null)throw Error(ge(308));Pa=e,cc.dependencies={lanes:0,firstContext:e}}else Pa=Pa.next=e;return t}var Gs=null;function yf(e){Gs===null?Gs=[e]:Gs.push(e)}function Pg(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,yf(t)):(r.next=s.next,s.next=r),t.interleaved=r,Yn(e,n)}function Yn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var is=!1;function wf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ws(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,We&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Yn(e,r)}return s=n.interleaved,s===null?(t.next=t,yf(n)):(t.next=s.next,s.next=t),n.interleaved=t,Yn(e,r)}function Mo(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sf(e,r)}}function yp(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function uc(e,t,r,n){var s=e.updateQueue;is=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(a!==null){var h=s.baseState;i=0,d=u=c=null,o=a;do{var f=o.lane,p=o.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,x=o;switch(f=t,p=r,x.tag){case 1:if(m=x.payload,typeof m=="function"){h=m.call(p,h,f);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=x.payload,f=typeof m=="function"?m.call(p,h,f):m,f==null)break e;h=vt({},h,f);break e;case 2:is=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,i|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);na|=i,e.lanes=i,e.memoizedState=h}}function wp(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ge(191,s));s.call(n)}}}var Bl={},jn=Ps(Bl),ml=Ps(Bl),gl=Ps(Bl);function Ws(e){if(e===Bl)throw Error(ge(174));return e}function _f(e,t){switch(lt(gl,t),lt(ml,e),lt(jn,Bl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:z0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=z0(t,e)}dt(jn),lt(jn,t)}function ni(){dt(jn),dt(ml),dt(gl)}function Mg(e){Ws(gl.current);var t=Ws(jn.current),r=z0(t,e.type);t!==r&&(lt(ml,e),lt(jn,r))}function Sf(e){ml.current===e&&(dt(jn),dt(ml))}var mt=Ps(0);function dc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qu=[];function Ef(){for(var e=0;e<qu.length;e++)qu[e]._workInProgressVersionPrimary=null;qu.length=0}var Bo=Zn.ReactCurrentDispatcher,Yu=Zn.ReactCurrentBatchConfig,ra=0,gt=null,Ot=null,Mt=null,fc=!1,Xi=!1,vl=0,B_=0;function Zt(){throw Error(ge(321))}function Nf(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!vn(e[r],t[r]))return!1;return!0}function Cf(e,t,r,n,s,a){if(ra=a,gt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bo.current=e===null||e.memoizedState===null?$_:H_,e=r(n,s),Xi){a=0;do{if(Xi=!1,vl=0,25<=a)throw Error(ge(301));a+=1,Mt=Ot=null,t.updateQueue=null,Bo.current=G_,e=r(n,s)}while(Xi)}if(Bo.current=hc,t=Ot!==null&&Ot.next!==null,ra=0,Mt=Ot=gt=null,fc=!1,t)throw Error(ge(300));return e}function Tf(){var e=vl!==0;return vl=0,e}function Cn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?gt.memoizedState=Mt=e:Mt=Mt.next=e,Mt}function en(){if(Ot===null){var e=gt.alternate;e=e!==null?e.memoizedState:null}else e=Ot.next;var t=Mt===null?gt.memoizedState:Mt.next;if(t!==null)Mt=t,Ot=e;else{if(e===null)throw Error(ge(310));Ot=e,e={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},Mt===null?gt.memoizedState=Mt=e:Mt=Mt.next=e}return Mt}function yl(e,t){return typeof t=="function"?t(e):t}function Ku(e){var t=en(),r=t.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=e;var n=Ot,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,c=null,u=a;do{var d=u.lane;if((ra&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=h,i=n):c=c.next=h,gt.lanes|=d,na|=d}u=u.next}while(u!==null&&u!==a);c===null?i=n:c.next=o,vn(n,t.memoizedState)||(Sr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,gt.lanes|=a,na|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Qu(e){var t=en(),r=t.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);vn(a,t.memoizedState)||(Sr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Bg(){}function Ug(e,t){var r=gt,n=en(),s=t(),a=!vn(n.memoizedState,s);if(a&&(n.memoizedState=s,Sr=!0),n=n.queue,bf($g.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Mt!==null&&Mt.memoizedState.tag&1){if(r.flags|=2048,wl(9,Vg.bind(null,r,n,s,t),void 0,null),Vt===null)throw Error(ge(349));ra&30||zg(r,t,s)}return s}function zg(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Vg(e,t,r,n){t.value=r,t.getSnapshot=n,Hg(t)&&Gg(e)}function $g(e,t,r){return r(function(){Hg(t)&&Gg(e)})}function Hg(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!vn(e,r)}catch{return!0}}function Gg(e){var t=Yn(e,1);t!==null&&xn(t,e,1,-1)}function _p(e){var t=Cn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:e},t.queue=e,e=e.dispatch=V_.bind(null,gt,e),[t.memoizedState,e]}function wl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=gt.updateQueue,t===null?(t={lastEffect:null,stores:null},gt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Wg(){return en().memoizedState}function Uo(e,t,r,n){var s=Cn();gt.flags|=e,s.memoizedState=wl(1|t,r,void 0,n===void 0?null:n)}function Yc(e,t,r,n){var s=en();n=n===void 0?null:n;var a=void 0;if(Ot!==null){var i=Ot.memoizedState;if(a=i.destroy,n!==null&&Nf(n,i.deps)){s.memoizedState=wl(t,r,a,n);return}}gt.flags|=e,s.memoizedState=wl(1|t,r,a,n)}function Sp(e,t){return Uo(8390656,8,e,t)}function bf(e,t){return Yc(2048,8,e,t)}function Xg(e,t){return Yc(4,2,e,t)}function qg(e,t){return Yc(4,4,e,t)}function Yg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Kg(e,t,r){return r=r!=null?r.concat([e]):null,Yc(4,4,Yg.bind(null,t,e),r)}function Af(){}function Qg(e,t){var r=en();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nf(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Jg(e,t){var r=en();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nf(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Zg(e,t,r){return ra&21?(vn(r,t)||(r=sg(),gt.lanes|=r,na|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Sr=!0),e.memoizedState=r)}function U_(e,t){var r=tt;tt=r!==0&&4>r?r:4,e(!0);var n=Yu.transition;Yu.transition={};try{e(!1),t()}finally{tt=r,Yu.transition=n}}function e1(){return en().memoizedState}function z_(e,t,r){var n=Ss(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},t1(e))r1(t,r);else if(r=Pg(e,t,r,n),r!==null){var s=hr();xn(r,e,n,s),n1(r,t,n)}}function V_(e,t,r){var n=Ss(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(t1(e))r1(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,vn(o,i)){var c=t.interleaved;c===null?(s.next=s,yf(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=Pg(e,t,s,n),r!==null&&(s=hr(),xn(r,e,n,s),n1(r,t,n))}}function t1(e){var t=e.alternate;return e===gt||t!==null&&t===gt}function r1(e,t){Xi=fc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function n1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sf(e,r)}}var hc={readContext:Zr,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},$_={readContext:Zr,useCallback:function(e,t){return Cn().memoizedState=[e,t===void 0?null:t],e},useContext:Zr,useEffect:Sp,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Uo(4194308,4,Yg.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Uo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Uo(4,2,e,t)},useMemo:function(e,t){var r=Cn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Cn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=z_.bind(null,gt,e),[n.memoizedState,e]},useRef:function(e){var t=Cn();return e={current:e},t.memoizedState=e},useState:_p,useDebugValue:Af,useDeferredValue:function(e){return Cn().memoizedState=e},useTransition:function(){var e=_p(!1),t=e[0];return e=U_.bind(null,e[1]),Cn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=gt,s=Cn();if(ht){if(r===void 0)throw Error(ge(407));r=r()}else{if(r=t(),Vt===null)throw Error(ge(349));ra&30||zg(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,Sp($g.bind(null,n,a,e),[e]),n.flags|=2048,wl(9,Vg.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Cn(),t=Vt.identifierPrefix;if(ht){var r=zn,n=Un;r=(n&~(1<<32-pn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=vl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=B_++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},H_={readContext:Zr,useCallback:Qg,useContext:Zr,useEffect:bf,useImperativeHandle:Kg,useInsertionEffect:Xg,useLayoutEffect:qg,useMemo:Jg,useReducer:Ku,useRef:Wg,useState:function(){return Ku(yl)},useDebugValue:Af,useDeferredValue:function(e){var t=en();return Zg(t,Ot.memoizedState,e)},useTransition:function(){var e=Ku(yl)[0],t=en().memoizedState;return[e,t]},useMutableSource:Bg,useSyncExternalStore:Ug,useId:e1,unstable_isNewReconciler:!1},G_={readContext:Zr,useCallback:Qg,useContext:Zr,useEffect:bf,useImperativeHandle:Kg,useInsertionEffect:Xg,useLayoutEffect:qg,useMemo:Jg,useReducer:Qu,useRef:Wg,useState:function(){return Qu(yl)},useDebugValue:Af,useDeferredValue:function(e){var t=en();return Ot===null?t.memoizedState=e:Zg(t,Ot.memoizedState,e)},useTransition:function(){var e=Qu(yl)[0],t=en().memoizedState;return[e,t]},useMutableSource:Bg,useSyncExternalStore:Ug,useId:e1,unstable_isNewReconciler:!1};function ln(e,t){if(e&&e.defaultProps){t=vt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function od(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:vt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Kc={isMounted:function(e){return(e=e._reactInternals)?fa(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=hr(),s=Ss(e),a=$n(n,s);a.payload=t,r!=null&&(a.callback=r),t=ws(e,a,s),t!==null&&(xn(t,e,s,n),Mo(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=hr(),s=Ss(e),a=$n(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ws(e,a,s),t!==null&&(xn(t,e,s,n),Mo(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=hr(),n=Ss(e),s=$n(r,n);s.tag=2,t!=null&&(s.callback=t),t=ws(e,s,n),t!==null&&(xn(t,e,n,r),Mo(t,e,n))}};function Ep(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!fl(r,n)||!fl(s,a):!0}function s1(e,t,r){var n=!1,s=bs,a=t.contextType;return typeof a=="object"&&a!==null?a=Zr(a):(s=Cr(t)?ea:lr.current,n=t.contextTypes,a=(n=n!=null)?ei(e,s):bs),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Kc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function Np(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Kc.enqueueReplaceState(t,t.state,null)}function cd(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},wf(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Zr(a):(a=Cr(t)?ea:lr.current,s.context=ei(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(od(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Kc.enqueueReplaceState(s,s.state,null),uc(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function si(e,t){try{var r="",n=t;do r+=yw(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function Ju(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ud(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var W_=typeof WeakMap=="function"?WeakMap:Map;function a1(e,t,r){r=$n(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){xc||(xc=!0,wd=n),ud(e,t)},r}function i1(e,t,r){r=$n(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){ud(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){ud(e,t),typeof n!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Cp(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new W_;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=iS.bind(null,e,t,r),t.then(e,e))}function Tp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function bp(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=$n(-1,1),t.tag=2,ws(r,t,1))),r.lanes|=1),e)}var X_=Zn.ReactCurrentOwner,Sr=!1;function or(e,t,r,n){t.child=e===null?Ig(t,null,r,n):ri(t,e.child,r,n)}function Ap(e,t,r,n,s){r=r.render;var a=t.ref;return Ga(t,s),n=Cf(e,t,r,n,a,s),r=Tf(),e!==null&&!Sr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Kn(e,t,s)):(ht&&r&&hf(t),t.flags|=1,or(e,t,n,s),t.child)}function jp(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Pf(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,l1(e,t,a,n,s)):(e=Ho(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:fl,r(i,n)&&e.ref===t.ref)return Kn(e,t,s)}return t.flags|=1,e=Es(a,n),e.ref=t.ref,e.return=t,t.child=e}function l1(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(fl(a,n)&&e.ref===t.ref)if(Sr=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(Sr=!0);else return t.lanes=e.lanes,Kn(e,t,s)}return dd(e,t,r,n,s)}function o1(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},lt(Ma,Or),Or|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,lt(Ma,Or),Or|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,lt(Ma,Or),Or|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,lt(Ma,Or),Or|=n;return or(e,t,s,r),t.child}function c1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function dd(e,t,r,n,s){var a=Cr(r)?ea:lr.current;return a=ei(t,a),Ga(t,s),r=Cf(e,t,r,n,a,s),n=Tf(),e!==null&&!Sr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Kn(e,t,s)):(ht&&n&&hf(t),t.flags|=1,or(e,t,r,s),t.child)}function kp(e,t,r,n,s){if(Cr(r)){var a=!0;ac(t)}else a=!1;if(Ga(t,s),t.stateNode===null)zo(e,t),s1(t,r,n),cd(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Zr(u):(u=Cr(r)?ea:lr.current,u=ei(t,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||c!==u)&&Np(t,i,n,u),is=!1;var f=t.memoizedState;i.state=f,uc(t,n,i,s),c=t.memoizedState,o!==n||f!==c||Nr.current||is?(typeof d=="function"&&(od(t,r,d,n),c=t.memoizedState),(o=is||Ep(t,r,o,n,f,c,u))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Lg(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ln(t.type,o),i.props=u,h=t.pendingProps,f=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Zr(c):(c=Cr(r)?ea:lr.current,c=ei(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||f!==c)&&Np(t,i,n,c),is=!1,f=t.memoizedState,i.state=f,uc(t,n,i,s);var m=t.memoizedState;o!==h||f!==m||Nr.current||is?(typeof p=="function"&&(od(t,r,p,n),m=t.memoizedState),(u=is||Ep(t,r,u,n,f,m,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,m,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,m,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return fd(e,t,r,n,a,s)}function fd(e,t,r,n,s,a){c1(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&xp(t,r,!1),Kn(e,t,a);n=t.stateNode,X_.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=ri(t,e.child,null,a),t.child=ri(t,null,o,a)):or(e,t,o,a),t.memoizedState=n.state,s&&xp(t,r,!0),t.child}function u1(e){var t=e.stateNode;t.pendingContext?pp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&pp(e,t.context,!1),_f(e,t.containerInfo)}function Rp(e,t,r,n,s){return ti(),xf(s),t.flags|=256,or(e,t,r,n),t.child}var hd={dehydrated:null,treeContext:null,retryLane:0};function pd(e){return{baseLanes:e,cachePool:null,transitions:null}}function d1(e,t,r){var n=t.pendingProps,s=mt.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),lt(mt,s&1),e===null)return id(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Zc(i,n,0,null),e=Qs(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=pd(r),t.memoizedState=hd,e):jf(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return q_(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Es(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Es(o,a):(a=Qs(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?pd(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=hd,n}return a=e.child,e=a.sibling,n=Es(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function jf(e,t){return t=Zc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function mo(e,t,r,n){return n!==null&&xf(n),ri(t,e.child,null,r),e=jf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function q_(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=Ju(Error(ge(422))),mo(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Zc({mode:"visible",children:n.children},s,0,null),a=Qs(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&ri(t,e.child,null,i),t.child.memoizedState=pd(i),t.memoizedState=hd,a);if(!(t.mode&1))return mo(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(ge(419)),n=Ju(a,n,void 0),mo(e,t,i,n)}if(o=(i&e.childLanes)!==0,Sr||o){if(n=Vt,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Yn(e,s),xn(n,e,s,-1))}return If(),n=Ju(Error(ge(421))),mo(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=lS.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,Br=ys(s.nextSibling),Ur=t,ht=!0,cn=null,e!==null&&(qr[Yr++]=Un,qr[Yr++]=zn,qr[Yr++]=ta,Un=e.id,zn=e.overflow,ta=t),t=jf(t,n.children),t.flags|=4096,t)}function Fp(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ld(e.return,t,r)}function Zu(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function f1(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(or(e,t,n.children,r),n=mt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Fp(e,r,t);else if(e.tag===19)Fp(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(lt(mt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&dc(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Zu(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&dc(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Zu(t,!0,r,null,a);break;case"together":Zu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Kn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),na|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ge(153));if(t.child!==null){for(e=t.child,r=Es(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Es(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Y_(e,t,r){switch(t.tag){case 3:u1(t),ti();break;case 5:Mg(t);break;case 1:Cr(t.type)&&ac(t);break;case 4:_f(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;lt(oc,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(lt(mt,mt.current&1),t.flags|=128,null):r&t.child.childLanes?d1(e,t,r):(lt(mt,mt.current&1),e=Kn(e,t,r),e!==null?e.sibling:null);lt(mt,mt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return f1(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),lt(mt,mt.current),n)break;return null;case 22:case 23:return t.lanes=0,o1(e,t,r)}return Kn(e,t,r)}var h1,xd,p1,x1;h1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};xd=function(){};p1=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Ws(jn.current);var a=null;switch(r){case"input":s=L0(e,s),n=L0(e,n),a=[];break;case"select":s=vt({},s,{value:void 0}),n=vt({},n,{value:void 0}),a=[];break;case"textarea":s=U0(e,s),n=U0(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=nc)}V0(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(al.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(al.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ct("scroll",e),a||o===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};x1=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ri(e,t){if(!ht)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function er(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function K_(e,t,r){var n=t.pendingProps;switch(pf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return er(t),null;case 1:return Cr(t.type)&&sc(),er(t),null;case 3:return n=t.stateNode,ni(),dt(Nr),dt(lr),Ef(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(po(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,cn!==null&&(Ed(cn),cn=null))),xd(e,t),er(t),null;case 5:Sf(t);var s=Ws(gl.current);if(r=t.type,e!==null&&t.stateNode!=null)p1(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ge(166));return er(t),null}if(e=Ws(jn.current),po(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[bn]=t,n[xl]=a,e=(t.mode&1)!==0,r){case"dialog":ct("cancel",n),ct("close",n);break;case"iframe":case"object":case"embed":ct("load",n);break;case"video":case"audio":for(s=0;s<Ui.length;s++)ct(Ui[s],n);break;case"source":ct("error",n);break;case"img":case"image":case"link":ct("error",n),ct("load",n);break;case"details":ct("toggle",n);break;case"input":zh(n,a),ct("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},ct("invalid",n);break;case"textarea":$h(n,a),ct("invalid",n)}V0(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&ho(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&ho(n.textContent,o,e),s=["children",""+o]):al.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&ct("scroll",n)}switch(r){case"input":so(n),Vh(n,a,!0);break;case"textarea":so(n),Hh(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=nc)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$m(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[bn]=t,e[xl]=n,h1(e,t,!1,!1),t.stateNode=e;e:{switch(i=$0(r,n),r){case"dialog":ct("cancel",e),ct("close",e),s=n;break;case"iframe":case"object":case"embed":ct("load",e),s=n;break;case"video":case"audio":for(s=0;s<Ui.length;s++)ct(Ui[s],e);s=n;break;case"source":ct("error",e),s=n;break;case"img":case"image":case"link":ct("error",e),ct("load",e),s=n;break;case"details":ct("toggle",e),s=n;break;case"input":zh(e,n),s=L0(e,n),ct("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=vt({},n,{value:void 0}),ct("invalid",e);break;case"textarea":$h(e,n),s=U0(e,n),ct("invalid",e);break;default:s=n}V0(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?Wm(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Hm(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&il(e,c):typeof c=="number"&&il(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(al.hasOwnProperty(a)?c!=null&&a==="onScroll"&&ct("scroll",e):c!=null&&Jd(e,a,c,i))}switch(r){case"input":so(e),Vh(e,n,!1);break;case"textarea":so(e),Hh(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ts(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?za(e,!!n.multiple,a,!1):n.defaultValue!=null&&za(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=nc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return er(t),null;case 6:if(e&&t.stateNode!=null)x1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ge(166));if(r=Ws(gl.current),Ws(jn.current),po(t)){if(n=t.stateNode,r=t.memoizedProps,n[bn]=t,(a=n.nodeValue!==r)&&(e=Ur,e!==null))switch(e.tag){case 3:ho(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ho(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[bn]=t,t.stateNode=n}return er(t),null;case 13:if(dt(mt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ht&&Br!==null&&t.mode&1&&!(t.flags&128))Dg(),ti(),t.flags|=98560,a=!1;else if(a=po(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(ge(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ge(317));a[bn]=t}else ti(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;er(t),a=!1}else cn!==null&&(Ed(cn),cn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||mt.current&1?It===0&&(It=3):If())),t.updateQueue!==null&&(t.flags|=4),er(t),null);case 4:return ni(),xd(e,t),e===null&&hl(t.stateNode.containerInfo),er(t),null;case 10:return vf(t.type._context),er(t),null;case 17:return Cr(t.type)&&sc(),er(t),null;case 19:if(dt(mt),a=t.memoizedState,a===null)return er(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)Ri(a,!1);else{if(It!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=dc(e),i!==null){for(t.flags|=128,Ri(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return lt(mt,mt.current&1|2),t.child}e=e.sibling}a.tail!==null&&Tt()>ai&&(t.flags|=128,n=!0,Ri(a,!1),t.lanes=4194304)}else{if(!n)if(e=dc(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ri(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!ht)return er(t),null}else 2*Tt()-a.renderingStartTime>ai&&r!==1073741824&&(t.flags|=128,n=!0,Ri(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Tt(),t.sibling=null,r=mt.current,lt(mt,n?r&1|2:r&1),t):(er(t),null);case 22:case 23:return Of(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Or&1073741824&&(er(t),t.subtreeFlags&6&&(t.flags|=8192)):er(t),null;case 24:return null;case 25:return null}throw Error(ge(156,t.tag))}function Q_(e,t){switch(pf(t),t.tag){case 1:return Cr(t.type)&&sc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ni(),dt(Nr),dt(lr),Ef(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Sf(t),null;case 13:if(dt(mt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ge(340));ti()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return dt(mt),null;case 4:return ni(),null;case 10:return vf(t.type._context),null;case 22:case 23:return Of(),null;case 24:return null;default:return null}}var go=!1,nr=!1,J_=typeof WeakSet=="function"?WeakSet:Set,De=null;function La(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){yt(e,t,n)}else r.current=null}function md(e,t,r){try{r()}catch(n){yt(e,t,n)}}var Dp=!1;function Z_(e,t){if(Z0=ec,e=wg(),ff(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=i+s),h!==a||n!==0&&h.nodeType!==3||(c=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===e)break t;if(f===r&&++u===s&&(o=i),f===a&&++d===n&&(c=i),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ed={focusedElem:e,selectionRange:r},ec=!1,De=t;De!==null;)if(t=De,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,De=e;else for(;De!==null;){t=De;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var x=m.memoizedProps,g=m.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:ln(t.type,x),g);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(_){yt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,De=e;break}De=t.return}return m=Dp,Dp=!1,m}function qi(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&md(t,r,a)}s=s.next}while(s!==n)}}function Qc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function gd(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function m1(e){var t=e.alternate;t!==null&&(e.alternate=null,m1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[bn],delete t[xl],delete t[nd],delete t[I_],delete t[P_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function g1(e){return e.tag===5||e.tag===3||e.tag===4}function Op(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||g1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=nc));else if(n!==4&&(e=e.child,e!==null))for(vd(e,t,r),e=e.sibling;e!==null;)vd(e,t,r),e=e.sibling}function yd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(yd(e,t,r),e=e.sibling;e!==null;)yd(e,t,r),e=e.sibling}var Ht=null,on=!1;function ts(e,t,r){for(r=r.child;r!==null;)v1(e,t,r),r=r.sibling}function v1(e,t,r){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount($c,r)}catch{}switch(r.tag){case 5:nr||La(r,t);case 6:var n=Ht,s=on;Ht=null,ts(e,t,r),Ht=n,on=s,Ht!==null&&(on?(e=Ht,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ht.removeChild(r.stateNode));break;case 18:Ht!==null&&(on?(e=Ht,r=r.stateNode,e.nodeType===8?Wu(e.parentNode,r):e.nodeType===1&&Wu(e,r),ul(e)):Wu(Ht,r.stateNode));break;case 4:n=Ht,s=on,Ht=r.stateNode.containerInfo,on=!0,ts(e,t,r),Ht=n,on=s;break;case 0:case 11:case 14:case 15:if(!nr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&md(r,t,i),s=s.next}while(s!==n)}ts(e,t,r);break;case 1:if(!nr&&(La(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){yt(r,t,o)}ts(e,t,r);break;case 21:ts(e,t,r);break;case 22:r.mode&1?(nr=(n=nr)||r.memoizedState!==null,ts(e,t,r),nr=n):ts(e,t,r);break;default:ts(e,t,r)}}function Ip(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new J_),t.forEach(function(n){var s=oS.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function nn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Ht=o.stateNode,on=!1;break e;case 3:Ht=o.stateNode.containerInfo,on=!0;break e;case 4:Ht=o.stateNode.containerInfo,on=!0;break e}o=o.return}if(Ht===null)throw Error(ge(160));v1(a,i,s),Ht=null,on=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){yt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)y1(t,e),t=t.sibling}function y1(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(nn(t,e),_n(e),n&4){try{qi(3,e,e.return),Qc(3,e)}catch(x){yt(e,e.return,x)}try{qi(5,e,e.return)}catch(x){yt(e,e.return,x)}}break;case 1:nn(t,e),_n(e),n&512&&r!==null&&La(r,r.return);break;case 5:if(nn(t,e),_n(e),n&512&&r!==null&&La(r,r.return),e.flags&32){var s=e.stateNode;try{il(s,"")}catch(x){yt(e,e.return,x)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&zm(s,a),$0(o,i);var u=$0(o,a);for(i=0;i<c.length;i+=2){var d=c[i],h=c[i+1];d==="style"?Wm(s,h):d==="dangerouslySetInnerHTML"?Hm(s,h):d==="children"?il(s,h):Jd(s,d,h,u)}switch(o){case"input":M0(s,a);break;case"textarea":Vm(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?za(s,!!a.multiple,p,!1):f!==!!a.multiple&&(a.defaultValue!=null?za(s,!!a.multiple,a.defaultValue,!0):za(s,!!a.multiple,a.multiple?[]:"",!1))}s[xl]=a}catch(x){yt(e,e.return,x)}}break;case 6:if(nn(t,e),_n(e),n&4){if(e.stateNode===null)throw Error(ge(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(x){yt(e,e.return,x)}}break;case 3:if(nn(t,e),_n(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ul(t.containerInfo)}catch(x){yt(e,e.return,x)}break;case 4:nn(t,e),_n(e);break;case 13:nn(t,e),_n(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Ff=Tt())),n&4&&Ip(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(nr=(u=nr)||d,nn(t,e),nr=u):nn(t,e),_n(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(De=e,d=e.child;d!==null;){for(h=De=d;De!==null;){switch(f=De,p=f.child,f.tag){case 0:case 11:case 14:case 15:qi(4,f,f.return);break;case 1:La(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(x){yt(n,r,x)}}break;case 5:La(f,f.return);break;case 22:if(f.memoizedState!==null){Lp(h);continue}}p!==null?(p.return=f,De=p):Lp(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,c=h.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Gm("display",i))}catch(x){yt(e,e.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){yt(e,e.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:nn(t,e),_n(e),n&4&&Ip(e);break;case 21:break;default:nn(t,e),_n(e)}}function _n(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(g1(r)){var n=r;break e}r=r.return}throw Error(ge(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(il(s,""),n.flags&=-33);var a=Op(e);yd(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=Op(e);vd(e,o,i);break;default:throw Error(ge(161))}}catch(c){yt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function eS(e,t,r){De=e,w1(e)}function w1(e,t,r){for(var n=(e.mode&1)!==0;De!==null;){var s=De,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||go;if(!i){var o=s.alternate,c=o!==null&&o.memoizedState!==null||nr;o=go;var u=nr;if(go=i,(nr=c)&&!u)for(De=s;De!==null;)i=De,c=i.child,i.tag===22&&i.memoizedState!==null?Mp(s):c!==null?(c.return=i,De=c):Mp(s);for(;a!==null;)De=a,w1(a),a=a.sibling;De=s,go=o,nr=u}Pp(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,De=a):Pp(e)}}function Pp(e){for(;De!==null;){var t=De;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:nr||Qc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!nr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ln(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&wp(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}wp(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&ul(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}nr||t.flags&512&&gd(t)}catch(f){yt(t,t.return,f)}}if(t===e){De=null;break}if(r=t.sibling,r!==null){r.return=t.return,De=r;break}De=t.return}}function Lp(e){for(;De!==null;){var t=De;if(t===e){De=null;break}var r=t.sibling;if(r!==null){r.return=t.return,De=r;break}De=t.return}}function Mp(e){for(;De!==null;){var t=De;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Qc(4,t)}catch(c){yt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){yt(t,s,c)}}var a=t.return;try{gd(t)}catch(c){yt(t,a,c)}break;case 5:var i=t.return;try{gd(t)}catch(c){yt(t,i,c)}}}catch(c){yt(t,t.return,c)}if(t===e){De=null;break}var o=t.sibling;if(o!==null){o.return=t.return,De=o;break}De=t.return}}var tS=Math.ceil,pc=Zn.ReactCurrentDispatcher,kf=Zn.ReactCurrentOwner,Jr=Zn.ReactCurrentBatchConfig,We=0,Vt=null,jt=null,qt=0,Or=0,Ma=Ps(0),It=0,_l=null,na=0,Jc=0,Rf=0,Yi=null,wr=null,Ff=0,ai=1/0,Ln=null,xc=!1,wd=null,_s=null,vo=!1,ds=null,mc=0,Ki=0,_d=null,Vo=-1,$o=0;function hr(){return We&6?Tt():Vo!==-1?Vo:Vo=Tt()}function Ss(e){return e.mode&1?We&2&&qt!==0?qt&-qt:M_.transition!==null?($o===0&&($o=sg()),$o):(e=tt,e!==0||(e=window.event,e=e===void 0?16:dg(e.type)),e):1}function xn(e,t,r,n){if(50<Ki)throw Ki=0,_d=null,Error(ge(185));Pl(e,r,n),(!(We&2)||e!==Vt)&&(e===Vt&&(!(We&2)&&(Jc|=r),It===4&&os(e,qt)),Tr(e,n),r===1&&We===0&&!(t.mode&1)&&(ai=Tt()+500,qc&&Ls()))}function Tr(e,t){var r=e.callbackNode;Mw(e,t);var n=Zo(e,e===Vt?qt:0);if(n===0)r!==null&&Xh(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Xh(r),t===1)e.tag===0?L_(Bp.bind(null,e)):kg(Bp.bind(null,e)),D_(function(){!(We&6)&&Ls()}),r=null;else{switch(ag(n)){case 1:r=nf;break;case 4:r=rg;break;case 16:r=Jo;break;case 536870912:r=ng;break;default:r=Jo}r=A1(r,_1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function _1(e,t){if(Vo=-1,$o=0,We&6)throw Error(ge(327));var r=e.callbackNode;if(Wa()&&e.callbackNode!==r)return null;var n=Zo(e,e===Vt?qt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=gc(e,n);else{t=n;var s=We;We|=2;var a=E1();(Vt!==e||qt!==t)&&(Ln=null,ai=Tt()+500,Ks(e,t));do try{sS();break}catch(o){S1(e,o)}while(!0);gf(),pc.current=a,We=s,jt!==null?t=0:(Vt=null,qt=0,t=It)}if(t!==0){if(t===2&&(s=q0(e),s!==0&&(n=s,t=Sd(e,s))),t===1)throw r=_l,Ks(e,0),os(e,n),Tr(e,Tt()),r;if(t===6)os(e,n);else{if(s=e.current.alternate,!(n&30)&&!rS(s)&&(t=gc(e,n),t===2&&(a=q0(e),a!==0&&(n=a,t=Sd(e,a))),t===1))throw r=_l,Ks(e,0),os(e,n),Tr(e,Tt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(ge(345));case 2:Vs(e,wr,Ln);break;case 3:if(os(e,n),(n&130023424)===n&&(t=Ff+500-Tt(),10<t)){if(Zo(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){hr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=rd(Vs.bind(null,e,wr,Ln),t);break}Vs(e,wr,Ln);break;case 4:if(os(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-pn(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=Tt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*tS(n/1960))-n,10<n){e.timeoutHandle=rd(Vs.bind(null,e,wr,Ln),n);break}Vs(e,wr,Ln);break;case 5:Vs(e,wr,Ln);break;default:throw Error(ge(329))}}}return Tr(e,Tt()),e.callbackNode===r?_1.bind(null,e):null}function Sd(e,t){var r=Yi;return e.current.memoizedState.isDehydrated&&(Ks(e,t).flags|=256),e=gc(e,t),e!==2&&(t=wr,wr=r,t!==null&&Ed(t)),e}function Ed(e){wr===null?wr=e:wr.push.apply(wr,e)}function rS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!vn(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function os(e,t){for(t&=~Rf,t&=~Jc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-pn(t),n=1<<r;e[r]=-1,t&=~n}}function Bp(e){if(We&6)throw Error(ge(327));Wa();var t=Zo(e,0);if(!(t&1))return Tr(e,Tt()),null;var r=gc(e,t);if(e.tag!==0&&r===2){var n=q0(e);n!==0&&(t=n,r=Sd(e,n))}if(r===1)throw r=_l,Ks(e,0),os(e,t),Tr(e,Tt()),r;if(r===6)throw Error(ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Vs(e,wr,Ln),Tr(e,Tt()),null}function Df(e,t){var r=We;We|=1;try{return e(t)}finally{We=r,We===0&&(ai=Tt()+500,qc&&Ls())}}function sa(e){ds!==null&&ds.tag===0&&!(We&6)&&Wa();var t=We;We|=1;var r=Jr.transition,n=tt;try{if(Jr.transition=null,tt=1,e)return e()}finally{tt=n,Jr.transition=r,We=t,!(We&6)&&Ls()}}function Of(){Or=Ma.current,dt(Ma)}function Ks(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,F_(r)),jt!==null)for(r=jt.return;r!==null;){var n=r;switch(pf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&sc();break;case 3:ni(),dt(Nr),dt(lr),Ef();break;case 5:Sf(n);break;case 4:ni();break;case 13:dt(mt);break;case 19:dt(mt);break;case 10:vf(n.type._context);break;case 22:case 23:Of()}r=r.return}if(Vt=e,jt=e=Es(e.current,null),qt=Or=t,It=0,_l=null,Rf=Jc=na=0,wr=Yi=null,Gs!==null){for(t=0;t<Gs.length;t++)if(r=Gs[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Gs=null}return e}function S1(e,t){do{var r=jt;try{if(gf(),Bo.current=hc,fc){for(var n=gt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}fc=!1}if(ra=0,Mt=Ot=gt=null,Xi=!1,vl=0,kf.current=null,r===null||r.return===null){It=1,_l=t,jt=null;break}e:{var a=e,i=r.return,o=r,c=t;if(t=qt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Tp(i);if(p!==null){p.flags&=-257,bp(p,i,o,a,t),p.mode&1&&Cp(a,u,t),t=p,c=u;var m=t.updateQueue;if(m===null){var x=new Set;x.add(c),t.updateQueue=x}else m.add(c);break e}else{if(!(t&1)){Cp(a,u,t),If();break e}c=Error(ge(426))}}else if(ht&&o.mode&1){var g=Tp(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),bp(g,i,o,a,t),xf(si(c,o));break e}}a=c=si(c,o),It!==4&&(It=2),Yi===null?Yi=[a]:Yi.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var y=a1(a,c,t);yp(a,y);break e;case 1:o=c;var v=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(_s===null||!_s.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t;var _=i1(a,o,t);yp(a,_);break e}}a=a.return}while(a!==null)}C1(r)}catch(S){t=S,jt===r&&r!==null&&(jt=r=r.return);continue}break}while(!0)}function E1(){var e=pc.current;return pc.current=hc,e===null?hc:e}function If(){(It===0||It===3||It===2)&&(It=4),Vt===null||!(na&268435455)&&!(Jc&268435455)||os(Vt,qt)}function gc(e,t){var r=We;We|=2;var n=E1();(Vt!==e||qt!==t)&&(Ln=null,Ks(e,t));do try{nS();break}catch(s){S1(e,s)}while(!0);if(gf(),We=r,pc.current=n,jt!==null)throw Error(ge(261));return Vt=null,qt=0,It}function nS(){for(;jt!==null;)N1(jt)}function sS(){for(;jt!==null&&!jw();)N1(jt)}function N1(e){var t=b1(e.alternate,e,Or);e.memoizedProps=e.pendingProps,t===null?C1(e):jt=t,kf.current=null}function C1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Q_(r,t),r!==null){r.flags&=32767,jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{It=6,jt=null;return}}else if(r=K_(r,t,Or),r!==null){jt=r;return}if(t=t.sibling,t!==null){jt=t;return}jt=t=e}while(t!==null);It===0&&(It=5)}function Vs(e,t,r){var n=tt,s=Jr.transition;try{Jr.transition=null,tt=1,aS(e,t,r,n)}finally{Jr.transition=s,tt=n}return null}function aS(e,t,r,n){do Wa();while(ds!==null);if(We&6)throw Error(ge(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ge(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(Bw(e,a),e===Vt&&(jt=Vt=null,qt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vo||(vo=!0,A1(Jo,function(){return Wa(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Jr.transition,Jr.transition=null;var i=tt;tt=1;var o=We;We|=4,kf.current=null,Z_(e,r),y1(r,e),C_(ed),ec=!!Z0,ed=Z0=null,e.current=r,eS(r),kw(),We=o,tt=i,Jr.transition=a}else e.current=r;if(vo&&(vo=!1,ds=e,mc=s),a=e.pendingLanes,a===0&&(_s=null),Dw(r.stateNode),Tr(e,Tt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(xc)throw xc=!1,e=wd,wd=null,e;return mc&1&&e.tag!==0&&Wa(),a=e.pendingLanes,a&1?e===_d?Ki++:(Ki=0,_d=e):Ki=0,Ls(),null}function Wa(){if(ds!==null){var e=ag(mc),t=Jr.transition,r=tt;try{if(Jr.transition=null,tt=16>e?16:e,ds===null)var n=!1;else{if(e=ds,ds=null,mc=0,We&6)throw Error(ge(331));var s=We;for(We|=4,De=e.current;De!==null;){var a=De,i=a.child;if(De.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(De=u;De!==null;){var d=De;switch(d.tag){case 0:case 11:case 15:qi(8,d,a)}var h=d.child;if(h!==null)h.return=d,De=h;else for(;De!==null;){d=De;var f=d.sibling,p=d.return;if(m1(d),d===u){De=null;break}if(f!==null){f.return=p,De=f;break}De=p}}}var m=a.alternate;if(m!==null){var x=m.child;if(x!==null){m.child=null;do{var g=x.sibling;x.sibling=null,x=g}while(x!==null)}}De=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,De=i;else e:for(;De!==null;){if(a=De,a.flags&2048)switch(a.tag){case 0:case 11:case 15:qi(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,De=y;break e}De=a.return}}var v=e.current;for(De=v;De!==null;){i=De;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,De=w;else e:for(i=v;De!==null;){if(o=De,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Qc(9,o)}}catch(S){yt(o,o.return,S)}if(o===i){De=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,De=_;break e}De=o.return}}if(We=s,Ls(),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot($c,e)}catch{}n=!0}return n}finally{tt=r,Jr.transition=t}}return!1}function Up(e,t,r){t=si(r,t),t=a1(e,t,1),e=ws(e,t,1),t=hr(),e!==null&&(Pl(e,1,t),Tr(e,t))}function yt(e,t,r){if(e.tag===3)Up(e,e,r);else for(;t!==null;){if(t.tag===3){Up(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(_s===null||!_s.has(n))){e=si(r,e),e=i1(t,e,1),t=ws(t,e,1),e=hr(),t!==null&&(Pl(t,1,e),Tr(t,e));break}}t=t.return}}function iS(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=hr(),e.pingedLanes|=e.suspendedLanes&r,Vt===e&&(qt&r)===r&&(It===4||It===3&&(qt&130023424)===qt&&500>Tt()-Ff?Ks(e,0):Rf|=r),Tr(e,t)}function T1(e,t){t===0&&(e.mode&1?(t=lo,lo<<=1,!(lo&130023424)&&(lo=4194304)):t=1);var r=hr();e=Yn(e,t),e!==null&&(Pl(e,t,r),Tr(e,r))}function lS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),T1(e,r)}function oS(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ge(314))}n!==null&&n.delete(t),T1(e,r)}var b1;b1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Nr.current)Sr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Sr=!1,Y_(e,t,r);Sr=!!(e.flags&131072)}else Sr=!1,ht&&t.flags&1048576&&Rg(t,lc,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;zo(e,t),e=t.pendingProps;var s=ei(t,lr.current);Ga(t,r),s=Cf(null,t,n,e,s,r);var a=Tf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Cr(n)?(a=!0,ac(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,wf(t),s.updater=Kc,t.stateNode=s,s._reactInternals=t,cd(t,n,e,r),t=fd(null,t,n,!0,a,r)):(t.tag=0,ht&&a&&hf(t),or(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(zo(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=uS(n),e=ln(n,e),s){case 0:t=dd(null,t,n,e,r);break e;case 1:t=kp(null,t,n,e,r);break e;case 11:t=Ap(null,t,n,e,r);break e;case 14:t=jp(null,t,n,ln(n.type,e),r);break e}throw Error(ge(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),dd(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),kp(e,t,n,s,r);case 3:e:{if(u1(t),e===null)throw Error(ge(387));n=t.pendingProps,a=t.memoizedState,s=a.element,Lg(e,t),uc(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=si(Error(ge(423)),t),t=Rp(e,t,n,r,s);break e}else if(n!==s){s=si(Error(ge(424)),t),t=Rp(e,t,n,r,s);break e}else for(Br=ys(t.stateNode.containerInfo.firstChild),Ur=t,ht=!0,cn=null,r=Ig(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ti(),n===s){t=Kn(e,t,r);break e}or(e,t,n,r)}t=t.child}return t;case 5:return Mg(t),e===null&&id(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,td(n,s)?i=null:a!==null&&td(n,a)&&(t.flags|=32),c1(e,t),or(e,t,i,r),t.child;case 6:return e===null&&id(t),null;case 13:return d1(e,t,r);case 4:return _f(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ri(t,null,n,r):or(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),Ap(e,t,n,s,r);case 7:return or(e,t,t.pendingProps,r),t.child;case 8:return or(e,t,t.pendingProps.children,r),t.child;case 12:return or(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,lt(oc,n._currentValue),n._currentValue=i,a!==null)if(vn(a.value,i)){if(a.children===s.children&&!Nr.current){t=Kn(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=$n(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),ld(a.return,r,t),o.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ge(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),ld(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}or(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ga(t,r),s=Zr(s),n=n(s),t.flags|=1,or(e,t,n,r),t.child;case 14:return n=t.type,s=ln(n,t.pendingProps),s=ln(n.type,s),jp(e,t,n,s,r);case 15:return l1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ln(n,s),zo(e,t),t.tag=1,Cr(n)?(e=!0,ac(t)):e=!1,Ga(t,r),s1(t,n,s),cd(t,n,s,r),fd(null,t,n,!0,e,r);case 19:return f1(e,t,r);case 22:return o1(e,t,r)}throw Error(ge(156,t.tag))};function A1(e,t){return tg(e,t)}function cS(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qr(e,t,r,n){return new cS(e,t,r,n)}function Pf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function uS(e){if(typeof e=="function")return Pf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ef)return 11;if(e===tf)return 14}return 2}function Es(e,t){var r=e.alternate;return r===null?(r=Qr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ho(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Pf(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Aa:return Qs(r.children,s,a,t);case Zd:i=8,s|=8;break;case D0:return e=Qr(12,r,t,s|2),e.elementType=D0,e.lanes=a,e;case O0:return e=Qr(13,r,t,s),e.elementType=O0,e.lanes=a,e;case I0:return e=Qr(19,r,t,s),e.elementType=I0,e.lanes=a,e;case Mm:return Zc(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Pm:i=10;break e;case Lm:i=9;break e;case ef:i=11;break e;case tf:i=14;break e;case as:i=16,n=null;break e}throw Error(ge(130,e==null?e:typeof e,""))}return t=Qr(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Qs(e,t,r,n){return e=Qr(7,e,n,t),e.lanes=r,e}function Zc(e,t,r,n){return e=Qr(22,e,n,t),e.elementType=Mm,e.lanes=r,e.stateNode={isHidden:!1},e}function e0(e,t,r){return e=Qr(6,e,null,t),e.lanes=r,e}function t0(e,t,r){return t=Qr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function dS(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Iu(0),this.expirationTimes=Iu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Iu(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Lf(e,t,r,n,s,a,i,o,c){return e=new dS(e,t,r,o,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Qr(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},wf(a),e}function fS(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ba,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function j1(e){if(!e)return bs;e=e._reactInternals;e:{if(fa(e)!==e||e.tag!==1)throw Error(ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Cr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ge(171))}if(e.tag===1){var r=e.type;if(Cr(r))return jg(e,r,t)}return t}function k1(e,t,r,n,s,a,i,o,c){return e=Lf(r,n,!0,e,s,a,i,o,c),e.context=j1(null),r=e.current,n=hr(),s=Ss(r),a=$n(n,s),a.callback=t??null,ws(r,a,s),e.current.lanes=s,Pl(e,s,n),Tr(e,n),e}function eu(e,t,r,n){var s=t.current,a=hr(),i=Ss(s);return r=j1(r),t.context===null?t.context=r:t.pendingContext=r,t=$n(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ws(s,t,i),e!==null&&(xn(e,s,i,a),Mo(e,s,i)),i}function vc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function zp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Mf(e,t){zp(e,t),(e=e.alternate)&&zp(e,t)}function hS(){return null}var R1=typeof reportError=="function"?reportError:function(e){console.error(e)};function Bf(e){this._internalRoot=e}tu.prototype.render=Bf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ge(409));eu(e,t,null,null)};tu.prototype.unmount=Bf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sa(function(){eu(null,e,null,null)}),t[qn]=null}};function tu(e){this._internalRoot=e}tu.prototype.unstable_scheduleHydration=function(e){if(e){var t=og();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ls.length&&t!==0&&t<ls[r].priority;r++);ls.splice(r,0,e),r===0&&ug(e)}};function Uf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ru(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Vp(){}function pS(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=vc(i);a.call(u)}}var i=k1(t,n,e,0,null,!1,!1,"",Vp);return e._reactRootContainer=i,e[qn]=i.current,hl(e.nodeType===8?e.parentNode:e),sa(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=vc(c);o.call(u)}}var c=Lf(e,0,!1,null,null,!1,!1,"",Vp);return e._reactRootContainer=c,e[qn]=c.current,hl(e.nodeType===8?e.parentNode:e),sa(function(){eu(t,c,r,n)}),c}function nu(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var c=vc(i);o.call(c)}}eu(t,i,e,s)}else i=pS(r,t,e,s,n);return vc(i)}ig=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Bi(t.pendingLanes);r!==0&&(sf(t,r|1),Tr(t,Tt()),!(We&6)&&(ai=Tt()+500,Ls()))}break;case 13:sa(function(){var n=Yn(e,1);if(n!==null){var s=hr();xn(n,e,1,s)}}),Mf(e,1)}};af=function(e){if(e.tag===13){var t=Yn(e,134217728);if(t!==null){var r=hr();xn(t,e,134217728,r)}Mf(e,134217728)}};lg=function(e){if(e.tag===13){var t=Ss(e),r=Yn(e,t);if(r!==null){var n=hr();xn(r,e,t,n)}Mf(e,t)}};og=function(){return tt};cg=function(e,t){var r=tt;try{return tt=e,t()}finally{tt=r}};G0=function(e,t,r){switch(t){case"input":if(M0(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Xc(n);if(!s)throw Error(ge(90));Um(n),M0(n,s)}}}break;case"textarea":Vm(e,r);break;case"select":t=r.value,t!=null&&za(e,!!r.multiple,t,!1)}};Ym=Df;Km=sa;var xS={usingClientEntryPoint:!1,Events:[Ml,Fa,Xc,Xm,qm,Df]},Fi={findFiberByHostInstance:Hs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mS={bundleType:Fi.bundleType,version:Fi.version,rendererPackageName:Fi.rendererPackageName,rendererConfig:Fi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zm(e),e===null?null:e.stateNode},findFiberByHostInstance:Fi.findFiberByHostInstance||hS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yo.isDisabled&&yo.supportsFiber)try{$c=yo.inject(mS),An=yo}catch{}}Hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xS;Hr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Uf(t))throw Error(ge(200));return fS(e,t,null,r)};Hr.createRoot=function(e,t){if(!Uf(e))throw Error(ge(299));var r=!1,n="",s=R1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Lf(e,1,!1,null,null,r,!1,n,s),e[qn]=t.current,hl(e.nodeType===8?e.parentNode:e),new Bf(t)};Hr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ge(188)):(e=Object.keys(e).join(","),Error(ge(268,e)));return e=Zm(t),e=e===null?null:e.stateNode,e};Hr.flushSync=function(e){return sa(e)};Hr.hydrate=function(e,t,r){if(!ru(t))throw Error(ge(200));return nu(null,e,t,!0,r)};Hr.hydrateRoot=function(e,t,r){if(!Uf(e))throw Error(ge(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=R1;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=k1(t,null,e,1,r??null,s,!1,a,i),e[qn]=t.current,hl(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new tu(t)};Hr.render=function(e,t,r){if(!ru(t))throw Error(ge(200));return nu(null,e,t,!1,r)};Hr.unmountComponentAtNode=function(e){if(!ru(e))throw Error(ge(40));return e._reactRootContainer?(sa(function(){nu(null,null,e,!1,function(){e._reactRootContainer=null,e[qn]=null})}),!0):!1};Hr.unstable_batchedUpdates=Df;Hr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ru(r))throw Error(ge(200));if(e==null||e._reactInternals===void 0)throw Error(ge(38));return nu(e,t,r,!1,n)};Hr.version="18.3.1-next-f1338f8080-20240426";function F1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(F1)}catch(e){console.error(e)}}F1(),Fm.exports=Hr;var gS=Fm.exports,$p=gS;R0.createRoot=$p.createRoot,R0.hydrateRoot=$p.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sl(){return Sl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sl.apply(this,arguments)}var fs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(fs||(fs={}));const Hp="popstate";function vS(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Nd("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:yc(s)}return wS(t,r,null,e)}function bt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function zf(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function yS(){return Math.random().toString(36).substr(2,8)}function Gp(e,t){return{usr:e.state,key:e.key,idx:t}}function Nd(e,t,r,n){return r===void 0&&(r=null),Sl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?fi(t):t,{state:r,key:t&&t.key||n||yS()})}function yc(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function fi(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function wS(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=fs.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(Sl({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function h(){o=fs.Pop;let g=d(),y=g==null?null:g-u;u=g,c&&c({action:o,location:x.location,delta:y})}function f(g,y){o=fs.Push;let v=Nd(x.location,g,y);u=d()+1;let w=Gp(v,u),_=x.createHref(v);try{i.pushState(w,"",_)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(_)}a&&c&&c({action:o,location:x.location,delta:1})}function p(g,y){o=fs.Replace;let v=Nd(x.location,g,y);u=d();let w=Gp(v,u),_=x.createHref(v);i.replaceState(w,"",_),a&&c&&c({action:o,location:x.location,delta:0})}function m(g){let y=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof g=="string"?g:yc(g);return v=v.replace(/ $/,"%20"),bt(y,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,y)}let x={get action(){return o},get location(){return e(s,i)},listen(g){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Hp,h),c=g,()=>{s.removeEventListener(Hp,h),c=null}},createHref(g){return t(s,g)},createURL:m,encodeLocation(g){let y=m(g);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:p,go(g){return i.go(g)}};return x}var Wp;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Wp||(Wp={}));function _S(e,t,r){return r===void 0&&(r="/"),SS(e,t,r)}function SS(e,t,r,n){let s=typeof t=="string"?fi(t):t,a=Vf(s.pathname||"/",r);if(a==null)return null;let i=D1(e);ES(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let u=IS(a);o=FS(i[c],u)}return o}function D1(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(bt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Ns([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(bt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),D1(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:kS(u,a.index),routesMeta:d})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of O1(a.path))s(a,i,c)}),t}function O1(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=O1(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function ES(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:RS(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const NS=/^:[\w-]+$/,CS=3,TS=2,bS=1,AS=10,jS=-2,Xp=e=>e==="*";function kS(e,t){let r=e.split("/"),n=r.length;return r.some(Xp)&&(n+=jS),t&&(n+=TS),r.filter(s=>!Xp(s)).reduce((s,a)=>s+(NS.test(a)?CS:a===""?bS:AS),n)}function RS(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function FS(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",h=DS({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h)return null;Object.assign(s,h.params),i.push({params:s,pathname:Ns([a,h.pathname]),pathnameBase:US(Ns([a,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(a=Ns([a,h.pathnameBase]))}return i}function DS(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=OS(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:f,isOptional:p}=d;if(f==="*"){let x=o[h]||"";i=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const m=o[h];return p&&!m?u[f]=void 0:u[f]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function OS(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),zf(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function IS(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return zf(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Vf(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const PS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LS=e=>PS.test(e);function MS(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?fi(e):e,a;if(r)if(LS(r))a=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),zf(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?a=qp(r.substring(1),"/"):a=qp(r,t)}else a=t;return{pathname:a,search:zS(n),hash:VS(s)}}function qp(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function r0(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function BS(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function $f(e,t){let r=BS(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Hf(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=fi(e):(s=Sl({},e),bt(!s.pathname||!s.pathname.includes("?"),r0("?","pathname","search",s)),bt(!s.pathname||!s.pathname.includes("#"),r0("#","pathname","hash",s)),bt(!s.search||!s.search.includes("#"),r0("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let h=t.length-1;if(!n&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}o=h>=0?t[h]:"/"}let c=MS(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ns=e=>e.join("/").replace(/\/\/+/g,"/"),US=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),zS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,VS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function $S(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const I1=["post","put","patch","delete"];new Set(I1);const HS=["get",...I1];new Set(HS);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function El(){return El=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},El.apply(this,arguments)}const Gf=b.createContext(null),GS=b.createContext(null),Ms=b.createContext(null),su=b.createContext(null),Dn=b.createContext({outlet:null,matches:[],isDataRoute:!1}),P1=b.createContext(null);function WS(e,t){let{relative:r}=t===void 0?{}:t;hi()||bt(!1);let{basename:n,navigator:s}=b.useContext(Ms),{hash:a,pathname:i,search:o}=B1(e,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:Ns([n,i])),s.createHref({pathname:c,search:o,hash:a})}function hi(){return b.useContext(su)!=null}function pi(){return hi()||bt(!1),b.useContext(su).location}function L1(e){b.useContext(Ms).static||b.useLayoutEffect(e)}function On(){let{isDataRoute:e}=b.useContext(Dn);return e?lE():XS()}function XS(){hi()||bt(!1);let e=b.useContext(Gf),{basename:t,future:r,navigator:n}=b.useContext(Ms),{matches:s}=b.useContext(Dn),{pathname:a}=pi(),i=JSON.stringify($f(s,r.v7_relativeSplatPath)),o=b.useRef(!1);return L1(()=>{o.current=!0}),b.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=Hf(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Ns([t,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[t,n,i,a,e])}const qS=b.createContext(null);function YS(e){let t=b.useContext(Dn).outlet;return t&&b.createElement(qS.Provider,{value:e},t)}function M1(){let{matches:e}=b.useContext(Dn),t=e[e.length-1];return t?t.params:{}}function B1(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=b.useContext(Ms),{matches:s}=b.useContext(Dn),{pathname:a}=pi(),i=JSON.stringify($f(s,n.v7_relativeSplatPath));return b.useMemo(()=>Hf(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function KS(e,t){return QS(e,t)}function QS(e,t,r,n){hi()||bt(!1);let{navigator:s}=b.useContext(Ms),{matches:a}=b.useContext(Dn),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=pi(),d;if(t){var h;let g=typeof t=="string"?fi(t):t;c==="/"||(h=g.pathname)!=null&&h.startsWith(c)||bt(!1),d=g}else d=u;let f=d.pathname||"/",p=f;if(c!=="/"){let g=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let m=_S(e,{pathname:p}),x=rE(m&&m.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:Ns([c,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:Ns([c,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),a,r,n);return t&&x?b.createElement(su.Provider,{value:{location:El({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:fs.Pop}},x):x}function JS(){let e=iE(),t=$S(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},t),r?b.createElement("pre",{style:s},r):null,null)}const ZS=b.createElement(JS,null);class eE extends b.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?b.createElement(Dn.Provider,{value:this.props.routeContext},b.createElement(P1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function tE(e){let{routeContext:t,match:r,children:n}=e,s=b.useContext(Gf);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),b.createElement(Dn.Provider,{value:t},n)}function rE(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||bt(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:p}=r,m=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||m){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,h,f)=>{let p,m=!1,x=null,g=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,x=h.route.errorElement||ZS,c&&(u<0&&f===0?(oE("route-fallback"),m=!0,g=null):u===f&&(m=!0,g=h.route.hydrateFallbackElement||null)));let y=t.concat(i.slice(0,f+1)),v=()=>{let w;return p?w=x:m?w=g:h.route.Component?w=b.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=d,b.createElement(tE,{match:h,routeContext:{outlet:d,matches:y,isDataRoute:r!=null},children:w})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?b.createElement(eE,{location:r.location,revalidation:r.revalidation,component:x,error:p,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}var U1=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(U1||{}),z1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(z1||{});function nE(e){let t=b.useContext(Gf);return t||bt(!1),t}function sE(e){let t=b.useContext(GS);return t||bt(!1),t}function aE(e){let t=b.useContext(Dn);return t||bt(!1),t}function V1(e){let t=aE(),r=t.matches[t.matches.length-1];return r.route.id||bt(!1),r.route.id}function iE(){var e;let t=b.useContext(P1),r=sE(),n=V1();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function lE(){let{router:e}=nE(U1.UseNavigateStable),t=V1(z1.UseNavigateStable),r=b.useRef(!1);return L1(()=>{r.current=!0}),b.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,El({fromRouteId:t},a)))},[e,t])}const Yp={};function oE(e,t,r){Yp[e]||(Yp[e]=!0)}function cE(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Wf(e){let{to:t,replace:r,state:n,relative:s}=e;hi()||bt(!1);let{future:a,static:i}=b.useContext(Ms),{matches:o}=b.useContext(Dn),{pathname:c}=pi(),u=On(),d=Hf(t,$f(o,a.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return b.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:s}),[u,h,s,r,n]),null}function uE(e){return YS(e.context)}function Lt(e){bt(!1)}function dE(e){let{basename:t="/",children:r=null,location:n,navigationType:s=fs.Pop,navigator:a,static:i=!1,future:o}=e;hi()&&bt(!1);let c=t.replace(/^\/*/,"/"),u=b.useMemo(()=>({basename:c,navigator:a,static:i,future:El({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=fi(n));let{pathname:d="/",search:h="",hash:f="",state:p=null,key:m="default"}=n,x=b.useMemo(()=>{let g=Vf(d,c);return g==null?null:{location:{pathname:g,search:h,hash:f,state:p,key:m},navigationType:s}},[c,d,h,f,p,m,s]);return x==null?null:b.createElement(Ms.Provider,{value:u},b.createElement(su.Provider,{children:r,value:x}))}function fE(e){let{children:t,location:r}=e;return KS(Cd(t),r)}new Promise(()=>{});function Cd(e,t){t===void 0&&(t=[]);let r=[];return b.Children.forEach(e,(n,s)=>{if(!b.isValidElement(n))return;let a=[...t,s];if(n.type===b.Fragment){r.push.apply(r,Cd(n.props.children,a));return}n.type!==Lt&&bt(!1),!n.props.index||!n.props.children||bt(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Cd(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Td(){return Td=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Td.apply(this,arguments)}function hE(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function pE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function xE(e,t){return e.button===0&&(!t||t==="_self")&&!pE(e)}const mE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],gE="6";try{window.__reactRouterVersion=gE}catch{}const vE="startTransition",Kp=iw[vE];function yE(e){let{basename:t,children:r,future:n,window:s}=e,a=b.useRef();a.current==null&&(a.current=vS({window:s,v5Compat:!0}));let i=a.current,[o,c]=b.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=b.useCallback(h=>{u&&Kp?Kp(()=>c(h)):c(h)},[c,u]);return b.useLayoutEffect(()=>i.listen(d),[i,d]),b.useEffect(()=>cE(n),[n]),b.createElement(dE,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const wE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_E=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,SE=b.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:c,to:u,preventScrollReset:d,viewTransition:h}=t,f=hE(t,mE),{basename:p}=b.useContext(Ms),m,x=!1;if(typeof u=="string"&&_E.test(u)&&(m=u,wE))try{let w=new URL(window.location.href),_=u.startsWith("//")?new URL(w.protocol+u):new URL(u),S=Vf(_.pathname,p);_.origin===w.origin&&S!=null?u=S+_.search+_.hash:x=!0}catch{}let g=WS(u,{relative:s}),y=EE(u,{replace:i,state:o,target:c,preventScrollReset:d,relative:s,viewTransition:h});function v(w){n&&n(w),w.defaultPrevented||y(w)}return b.createElement("a",Td({},f,{href:m||g,onClick:x||a?n:v,ref:r,target:c}))});var Qp;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Qp||(Qp={}));var Jp;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Jp||(Jp={}));function EE(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,c=On(),u=pi(),d=B1(e,{relative:i});return b.useCallback(h=>{if(xE(h,r)){h.preventDefault();let f=n!==void 0?n:yc(u)===yc(d);c(e,{replace:f,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[u,c,d,n,s,r,e,a,i,o])}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var NE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ne=(e,t)=>{const r=b.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:c,...u},d)=>b.createElement("svg",{ref:d,...NE,width:s,height:s,stroke:n,strokeWidth:i?Number(a)*24/Number(s):a,className:["lucide",`lucide-${CE(e)}`,o].join(" "),...u},[...t.map(([h,f])=>b.createElement(h,f)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=Ne("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=Ne("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=Ne("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=Ne("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $1=Ne("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wc=Ne("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=Ne("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=Ne("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=Ne("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=Ne("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=Ne("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H1=Ne("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=Ne("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=Ne("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Ne("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=Ne("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=Ne("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qf=Ne("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yf=Ne("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G1=Ne("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=Ne("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=Ne("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=Ne("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=Ne("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W1=Ne("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=Ne("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X1=Ne("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=Ne("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=Ne("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=Ne("FileMinus",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"9",x2:"15",y1:"15",y2:"15",key:"110plj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=Ne("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=Ne("FilterX",[["path",{d:"M13.013 3H2l8 9.46V19l4 2v-8.54l.9-1.055",key:"1fi1da"}],["path",{d:"m22 3-5 5",key:"12jva0"}],["path",{d:"m17 3 5 5",key:"k36vhe"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q1=Ne("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y1=Ne("Hammer",[["path",{d:"m15 12-8.5 8.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L12 9",key:"1afvon"}],["path",{d:"M17.64 15 22 10.64",key:"zsji6s"}],["path",{d:"m20.91 11.7-1.25-1.25c-.6-.6-.93-1.4-.93-2.25v-.86L16.01 4.6a5.56 5.56 0 0 0-3.94-1.64H9l.92.82A6.18 6.18 0 0 1 12 8.4v1.56l2 2h2.47l2.26 1.91",key:"lehyy1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K1=Ne("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=Ne("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=Ne("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=Ne("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=Ne("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kf=Ne("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=Ne("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ex=Ne("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qf=Ne("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=Ne("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=Ne("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=Ne("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=Ne("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=Ne("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=Ne("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=Ne("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=Ne("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Ne("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=Ne("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q1=Ne("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tx=Ne("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=Ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=Ne("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=Ne("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=Ne("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J1=Ne("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ou=Ne("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=Ne("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=Ne("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=Ne("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ec=Ne("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z1=Ne("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rx=Ne("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=Ne("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=Ne("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=Ne("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ev=Ne("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tv=Ne("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=Ne("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=Ne("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=Ne("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=Ne("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=Ne("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=Ne("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rv=Ne("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=Ne("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=Ne("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=Ne("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function nv(e,t){return function(){return e.apply(t,arguments)}}const{toString:JE}=Object.prototype,{getPrototypeOf:eh}=Object,{iterator:cu,toStringTag:sv}=Symbol,uu=(e=>t=>{const r=JE.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),yn=e=>(e=e.toLowerCase(),t=>uu(t)===e),du=e=>t=>typeof t===e,{isArray:xi}=Array,li=du("undefined");function Ul(e){return e!==null&&!li(e)&&e.constructor!==null&&!li(e.constructor)&&br(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const av=yn("ArrayBuffer");function ZE(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&av(e.buffer),t}const eN=du("string"),br=du("function"),iv=du("number"),zl=e=>e!==null&&typeof e=="object",tN=e=>e===!0||e===!1,Wo=e=>{if(uu(e)!=="object")return!1;const t=eh(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(sv in e)&&!(cu in e)},rN=e=>{if(!zl(e)||Ul(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},nN=yn("Date"),sN=yn("File"),aN=yn("Blob"),iN=yn("FileList"),lN=e=>zl(e)&&br(e.pipe),oN=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||br(e.append)&&((t=uu(e))==="formdata"||t==="object"&&br(e.toString)&&e.toString()==="[object FormData]"))},cN=yn("URLSearchParams"),[uN,dN,fN,hN]=["ReadableStream","Request","Response","Headers"].map(yn),pN=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Vl(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),xi(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(Ul(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let o;for(n=0;n<i;n++)o=a[n],t.call(null,e[o],o,e)}}function lv(e,t){if(Ul(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const qs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ov=e=>!li(e)&&e!==qs;function jd(){const{caseless:e,skipUndefined:t}=ov(this)&&this||{},r={},n=(s,a)=>{const i=e&&lv(r,a)||a;Wo(r[i])&&Wo(s)?r[i]=jd(r[i],s):Wo(s)?r[i]=jd({},s):xi(s)?r[i]=s.slice():(!t||!li(s))&&(r[i]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&Vl(arguments[s],n);return r}const xN=(e,t,r,{allOwnKeys:n}={})=>(Vl(t,(s,a)=>{r&&br(s)?e[a]=nv(s,r):e[a]=s},{allOwnKeys:n}),e),mN=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),gN=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},vN=(e,t,r,n)=>{let s,a,i;const o={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)i=s[a],(!n||n(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=r!==!1&&eh(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},yN=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},wN=e=>{if(!e)return null;if(xi(e))return e;let t=e.length;if(!iv(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},_N=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&eh(Uint8Array)),SN=(e,t)=>{const n=(e&&e[cu]).call(e);let s;for(;(s=n.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},EN=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},NN=yn("HTMLFormElement"),CN=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),nx=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),TN=yn("RegExp"),cv=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Vl(r,(s,a)=>{let i;(i=t(s,a,e))!==!1&&(n[a]=i||s)}),Object.defineProperties(e,n)},bN=e=>{cv(e,(t,r)=>{if(br(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(br(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},AN=(e,t)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return xi(e)?n(e):n(String(e).split(t)),r},jN=()=>{},kN=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function RN(e){return!!(e&&br(e.append)&&e[sv]==="FormData"&&e[cu])}const FN=e=>{const t=new Array(10),r=(n,s)=>{if(zl(n)){if(t.indexOf(n)>=0)return;if(Ul(n))return n;if(!("toJSON"in n)){t[s]=n;const a=xi(n)?[]:{};return Vl(n,(i,o)=>{const c=r(i,s+1);!li(c)&&(a[o]=c)}),t[s]=void 0,a}}return n};return r(e,0)},DN=yn("AsyncFunction"),ON=e=>e&&(zl(e)||br(e))&&br(e.then)&&br(e.catch),uv=((e,t)=>e?setImmediate:t?((r,n)=>(qs.addEventListener("message",({source:s,data:a})=>{s===qs&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),qs.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",br(qs.postMessage)),IN=typeof queueMicrotask<"u"?queueMicrotask.bind(qs):typeof process<"u"&&process.nextTick||uv,PN=e=>e!=null&&br(e[cu]),re={isArray:xi,isArrayBuffer:av,isBuffer:Ul,isFormData:oN,isArrayBufferView:ZE,isString:eN,isNumber:iv,isBoolean:tN,isObject:zl,isPlainObject:Wo,isEmptyObject:rN,isReadableStream:uN,isRequest:dN,isResponse:fN,isHeaders:hN,isUndefined:li,isDate:nN,isFile:sN,isBlob:aN,isRegExp:TN,isFunction:br,isStream:lN,isURLSearchParams:cN,isTypedArray:_N,isFileList:iN,forEach:Vl,merge:jd,extend:xN,trim:pN,stripBOM:mN,inherits:gN,toFlatObject:vN,kindOf:uu,kindOfTest:yn,endsWith:yN,toArray:wN,forEachEntry:SN,matchAll:EN,isHTMLForm:NN,hasOwnProperty:nx,hasOwnProp:nx,reduceDescriptors:cv,freezeMethods:bN,toObjectSet:AN,toCamelCase:CN,noop:jN,toFiniteNumber:kN,findKey:lv,global:qs,isContextDefined:ov,isSpecCompliantForm:RN,toJSONObject:FN,isAsyncFn:DN,isThenable:ON,setImmediate:uv,asap:IN,isIterable:PN};function ze(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}re.inherits(ze,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:re.toJSONObject(this.config),code:this.code,status:this.status}}});const dv=ze.prototype,fv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{fv[e]={value:e}});Object.defineProperties(ze,fv);Object.defineProperty(dv,"isAxiosError",{value:!0});ze.from=(e,t,r,n,s,a)=>{const i=Object.create(dv);re.toFlatObject(e,i,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return ze.call(i,o,c,r,n,s),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",a&&Object.assign(i,a),i};const LN=null;function kd(e){return re.isPlainObject(e)||re.isArray(e)}function hv(e){return re.endsWith(e,"[]")?e.slice(0,-2):e}function sx(e,t,r){return e?e.concat(t).map(function(s,a){return s=hv(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}function MN(e){return re.isArray(e)&&!e.some(kd)}const BN=re.toFlatObject(re,{},null,function(t){return/^is[A-Z]/.test(t)});function fu(e,t,r){if(!re.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=re.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,g){return!re.isUndefined(g[x])});const n=r.metaTokens,s=r.visitor||d,a=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&re.isSpecCompliantForm(t);if(!re.isFunction(s))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(re.isDate(m))return m.toISOString();if(re.isBoolean(m))return m.toString();if(!c&&re.isBlob(m))throw new ze("Blob is not supported. Use a Buffer instead.");return re.isArrayBuffer(m)||re.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,x,g){let y=m;if(m&&!g&&typeof m=="object"){if(re.endsWith(x,"{}"))x=n?x:x.slice(0,-2),m=JSON.stringify(m);else if(re.isArray(m)&&MN(m)||(re.isFileList(m)||re.endsWith(x,"[]"))&&(y=re.toArray(m)))return x=hv(x),y.forEach(function(w,_){!(re.isUndefined(w)||w===null)&&t.append(i===!0?sx([x],_,a):i===null?x:x+"[]",u(w))}),!1}return kd(m)?!0:(t.append(sx(g,x,a),u(m)),!1)}const h=[],f=Object.assign(BN,{defaultVisitor:d,convertValue:u,isVisitable:kd});function p(m,x){if(!re.isUndefined(m)){if(h.indexOf(m)!==-1)throw Error("Circular reference detected in "+x.join("."));h.push(m),re.forEach(m,function(y,v){(!(re.isUndefined(y)||y===null)&&s.call(t,y,re.isString(v)?v.trim():v,x,f))===!0&&p(y,x?x.concat(v):[v])}),h.pop()}}if(!re.isObject(e))throw new TypeError("data must be an object");return p(e),t}function ax(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function th(e,t){this._pairs=[],e&&fu(e,this,t)}const pv=th.prototype;pv.append=function(t,r){this._pairs.push([t,r])};pv.toString=function(t){const r=t?function(n){return t.call(this,n,ax)}:ax;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function UN(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function xv(e,t,r){if(!t)return e;const n=r&&r.encode||UN;re.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let a;if(s?a=s(t,r):a=re.isURLSearchParams(t)?t.toString():new th(t,r).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class ix{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){re.forEach(this.handlers,function(n){n!==null&&t(n)})}}const mv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},zN=typeof URLSearchParams<"u"?URLSearchParams:th,VN=typeof FormData<"u"?FormData:null,$N=typeof Blob<"u"?Blob:null,HN={isBrowser:!0,classes:{URLSearchParams:zN,FormData:VN,Blob:$N},protocols:["http","https","file","blob","url","data"]},rh=typeof window<"u"&&typeof document<"u",Rd=typeof navigator=="object"&&navigator||void 0,GN=rh&&(!Rd||["ReactNative","NativeScript","NS"].indexOf(Rd.product)<0),WN=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",XN=rh&&window.location.href||"http://localhost",qN=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:rh,hasStandardBrowserEnv:GN,hasStandardBrowserWebWorkerEnv:WN,navigator:Rd,origin:XN},Symbol.toStringTag,{value:"Module"})),sr={...qN,...HN};function YN(e,t){return fu(e,new sr.classes.URLSearchParams,{visitor:function(r,n,s,a){return sr.isNode&&re.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function KN(e){return re.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function QN(e){const t={},r=Object.keys(e);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],t[a]=e[a];return t}function gv(e){function t(r,n,s,a){let i=r[a++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),c=a>=r.length;return i=!i&&re.isArray(s)?s.length:i,c?(re.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!o):((!s[i]||!re.isObject(s[i]))&&(s[i]=[]),t(r,n,s[i],a)&&re.isArray(s[i])&&(s[i]=QN(s[i])),!o)}if(re.isFormData(e)&&re.isFunction(e.entries)){const r={};return re.forEachEntry(e,(n,s)=>{t(KN(n),s,r,0)}),r}return null}function JN(e,t,r){if(re.isString(e))try{return(t||JSON.parse)(e),re.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const $l={transitional:mv,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=re.isObject(t);if(a&&re.isHTMLForm(t)&&(t=new FormData(t)),re.isFormData(t))return s?JSON.stringify(gv(t)):t;if(re.isArrayBuffer(t)||re.isBuffer(t)||re.isStream(t)||re.isFile(t)||re.isBlob(t)||re.isReadableStream(t))return t;if(re.isArrayBufferView(t))return t.buffer;if(re.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return YN(t,this.formSerializer).toString();if((o=re.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return fu(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),JN(t)):t}],transformResponse:[function(t){const r=this.transitional||$l.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(re.isResponse(t)||re.isReadableStream(t))return t;if(t&&re.isString(t)&&(n&&!this.responseType||s)){const i=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(o){if(i)throw o.name==="SyntaxError"?ze.from(o,ze.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:sr.classes.FormData,Blob:sr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};re.forEach(["delete","get","head","post","put","patch"],e=>{$l.headers[e]={}});const ZN=re.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),e4=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(i){s=i.indexOf(":"),r=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!r||t[r]&&ZN[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},lx=Symbol("internals");function Di(e){return e&&String(e).trim().toLowerCase()}function Xo(e){return e===!1||e==null?e:re.isArray(e)?e.map(Xo):String(e)}function t4(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const r4=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function n0(e,t,r,n,s){if(re.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!re.isString(t)){if(re.isString(n))return t.indexOf(n)!==-1;if(re.isRegExp(n))return n.test(t)}}function n4(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function s4(e,t){const r=re.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,a,i){return this[n].call(this,t,s,a,i)},configurable:!0})})}let Ar=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function a(o,c,u){const d=Di(c);if(!d)throw new Error("header name must be a non-empty string");const h=re.findKey(s,d);(!h||s[h]===void 0||u===!0||u===void 0&&s[h]!==!1)&&(s[h||c]=Xo(o))}const i=(o,c)=>re.forEach(o,(u,d)=>a(u,d,c));if(re.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(re.isString(t)&&(t=t.trim())&&!r4(t))i(e4(t),r);else if(re.isObject(t)&&re.isIterable(t)){let o={},c,u;for(const d of t){if(!re.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?re.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}i(o,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=Di(t),t){const n=re.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return t4(s);if(re.isFunction(r))return r.call(this,s,n);if(re.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Di(t),t){const n=re.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||n0(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function a(i){if(i=Di(i),i){const o=re.findKey(n,i);o&&(!r||n0(n,n[o],o,r))&&(delete n[o],s=!0)}}return re.isArray(t)?t.forEach(a):a(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!t||n0(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const r=this,n={};return re.forEach(this,(s,a)=>{const i=re.findKey(n,a);if(i){r[i]=Xo(s),delete r[a];return}const o=t?n4(a):String(a).trim();o!==a&&delete r[a],r[o]=Xo(s),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return re.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&re.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[lx]=this[lx]={accessors:{}}).accessors,s=this.prototype;function a(i){const o=Di(i);n[o]||(s4(s,i),n[o]=!0)}return re.isArray(t)?t.forEach(a):a(t),this}};Ar.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);re.reduceDescriptors(Ar.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});re.freezeMethods(Ar);function s0(e,t){const r=this||$l,n=t||r,s=Ar.from(n.headers);let a=n.data;return re.forEach(e,function(o){a=o.call(r,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function vv(e){return!!(e&&e.__CANCEL__)}function mi(e,t,r){ze.call(this,e??"canceled",ze.ERR_CANCELED,t,r),this.name="CanceledError"}re.inherits(mi,ze,{__CANCEL__:!0});function yv(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new ze("Request failed with status code "+r.status,[ze.ERR_BAD_REQUEST,ze.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function a4(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function i4(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,a=0,i;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[a];i||(i=u),r[s]=c,n[s]=u;let h=a,f=0;for(;h!==s;)f+=r[h++],h=h%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),u-i<t)return;const p=d&&u-d;return p?Math.round(f*1e3/p):void 0}}function l4(e,t){let r=0,n=1e3/t,s,a;const i=(u,d=Date.now())=>{r=d,s=null,a&&(clearTimeout(a),a=null),e(...u)};return[(...u)=>{const d=Date.now(),h=d-r;h>=n?i(u,d):(s=u,a||(a=setTimeout(()=>{a=null,i(s)},n-h)))},()=>s&&i(s)]}const Nc=(e,t,r=3)=>{let n=0;const s=i4(50,250);return l4(a=>{const i=a.loaded,o=a.lengthComputable?a.total:void 0,c=i-n,u=s(c),d=i<=o;n=i;const h={loaded:i,total:o,progress:o?i/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-i)/u:void 0,event:a,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(h)},r)},ox=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},cx=e=>(...t)=>re.asap(()=>e(...t)),o4=sr.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,sr.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(sr.origin),sr.navigator&&/(msie|trident)/i.test(sr.navigator.userAgent)):()=>!0,c4=sr.hasStandardBrowserEnv?{write(e,t,r,n,s,a,i){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];re.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),re.isString(n)&&o.push(`path=${n}`),re.isString(s)&&o.push(`domain=${s}`),a===!0&&o.push("secure"),re.isString(i)&&o.push(`SameSite=${i}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function u4(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function d4(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function wv(e,t,r){let n=!u4(t);return e&&(n||r==!1)?d4(e,t):t}const ux=e=>e instanceof Ar?{...e}:e;function ia(e,t){t=t||{};const r={};function n(u,d,h,f){return re.isPlainObject(u)&&re.isPlainObject(d)?re.merge.call({caseless:f},u,d):re.isPlainObject(d)?re.merge({},d):re.isArray(d)?d.slice():d}function s(u,d,h,f){if(re.isUndefined(d)){if(!re.isUndefined(u))return n(void 0,u,h,f)}else return n(u,d,h,f)}function a(u,d){if(!re.isUndefined(d))return n(void 0,d)}function i(u,d){if(re.isUndefined(d)){if(!re.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function o(u,d,h){if(h in t)return n(u,d);if(h in e)return n(void 0,u)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(u,d,h)=>s(ux(u),ux(d),h,!0)};return re.forEach(Object.keys({...e,...t}),function(d){const h=c[d]||s,f=h(e[d],t[d],d);re.isUndefined(f)&&h!==o||(r[d]=f)}),r}const _v=e=>{const t=ia({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:i,auth:o}=t;if(t.headers=i=Ar.from(i),t.url=xv(wv(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),re.isFormData(r)){if(sr.hasStandardBrowserEnv||sr.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(re.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,h])=>{u.includes(d.toLowerCase())&&i.set(d,h)})}}if(sr.hasStandardBrowserEnv&&(n&&re.isFunction(n)&&(n=n(t)),n||n!==!1&&o4(t.url))){const c=s&&a&&c4.read(a);c&&i.set(s,c)}return t},f4=typeof XMLHttpRequest<"u",h4=f4&&function(e){return new Promise(function(r,n){const s=_v(e);let a=s.data;const i=Ar.from(s.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=s,d,h,f,p,m;function x(){p&&p(),m&&m(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let g=new XMLHttpRequest;g.open(s.method.toUpperCase(),s.url,!0),g.timeout=s.timeout;function y(){if(!g)return;const w=Ar.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),S={data:!o||o==="text"||o==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:w,config:e,request:g};yv(function(N){r(N),x()},function(N){n(N),x()},S),g=null}"onloadend"in g?g.onloadend=y:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(y)},g.onabort=function(){g&&(n(new ze("Request aborted",ze.ECONNABORTED,e,g)),g=null)},g.onerror=function(_){const S=_&&_.message?_.message:"Network Error",P=new ze(S,ze.ERR_NETWORK,e,g);P.event=_||null,n(P),g=null},g.ontimeout=function(){let _=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const S=s.transitional||mv;s.timeoutErrorMessage&&(_=s.timeoutErrorMessage),n(new ze(_,S.clarifyTimeoutError?ze.ETIMEDOUT:ze.ECONNABORTED,e,g)),g=null},a===void 0&&i.setContentType(null),"setRequestHeader"in g&&re.forEach(i.toJSON(),function(_,S){g.setRequestHeader(S,_)}),re.isUndefined(s.withCredentials)||(g.withCredentials=!!s.withCredentials),o&&o!=="json"&&(g.responseType=s.responseType),u&&([f,m]=Nc(u,!0),g.addEventListener("progress",f)),c&&g.upload&&([h,p]=Nc(c),g.upload.addEventListener("progress",h),g.upload.addEventListener("loadend",p)),(s.cancelToken||s.signal)&&(d=w=>{g&&(n(!w||w.type?new mi(null,e,g):w),g.abort(),g=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const v=a4(s.url);if(v&&sr.protocols.indexOf(v)===-1){n(new ze("Unsupported protocol "+v+":",ze.ERR_BAD_REQUEST,e));return}g.send(a||null)})},p4=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const a=function(u){if(!s){s=!0,o();const d=u instanceof Error?u:this.reason;n.abort(d instanceof ze?d:new mi(d instanceof Error?d.message:d))}};let i=t&&setTimeout(()=>{i=null,a(new ze(`timeout ${t} of ms exceeded`,ze.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),e=null)};e.forEach(u=>u.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>re.asap(o),c}},x4=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},m4=async function*(e,t){for await(const r of g4(e))yield*x4(r,t)},g4=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},dx=(e,t,r,n)=>{const s=m4(e,t);let a=0,i,o=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){o(),c.close();return}let h=d.byteLength;if(r){let f=a+=h;r(f)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),s.return()}},{highWaterMark:2})},fx=64*1024,{isFunction:_o}=re,v4=(({Request:e,Response:t})=>({Request:e,Response:t}))(re.global),{ReadableStream:hx,TextEncoder:px}=re.global,xx=(e,...t)=>{try{return!!e(...t)}catch{return!1}},y4=e=>{e=re.merge.call({skipUndefined:!0},v4,e);const{fetch:t,Request:r,Response:n}=e,s=t?_o(t):typeof fetch=="function",a=_o(r),i=_o(n);if(!s)return!1;const o=s&&_o(hx),c=s&&(typeof px=="function"?(m=>x=>m.encode(x))(new px):async m=>new Uint8Array(await new r(m).arrayBuffer())),u=a&&o&&xx(()=>{let m=!1;const x=new r(sr.origin,{body:new hx,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!x}),d=i&&o&&xx(()=>re.isReadableStream(new n("").body)),h={stream:d&&(m=>m.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!h[m]&&(h[m]=(x,g)=>{let y=x&&x[m];if(y)return y.call(x);throw new ze(`Response type '${m}' is not supported`,ze.ERR_NOT_SUPPORT,g)})});const f=async m=>{if(m==null)return 0;if(re.isBlob(m))return m.size;if(re.isSpecCompliantForm(m))return(await new r(sr.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(re.isArrayBufferView(m)||re.isArrayBuffer(m))return m.byteLength;if(re.isURLSearchParams(m)&&(m=m+""),re.isString(m))return(await c(m)).byteLength},p=async(m,x)=>{const g=re.toFiniteNumber(m.getContentLength());return g??f(x)};return async m=>{let{url:x,method:g,data:y,signal:v,cancelToken:w,timeout:_,onDownloadProgress:S,onUploadProgress:P,responseType:N,headers:I,withCredentials:M="same-origin",fetchOptions:L}=_v(m),X=t||fetch;N=N?(N+"").toLowerCase():"text";let C=p4([v,w&&w.toAbortSignal()],_),U=null;const z=C&&C.unsubscribe&&(()=>{C.unsubscribe()});let V;try{if(P&&u&&g!=="get"&&g!=="head"&&(V=await p(I,y))!==0){let fe=new r(x,{method:"POST",body:y,duplex:"half"}),R;if(re.isFormData(y)&&(R=fe.headers.get("content-type"))&&I.setContentType(R),fe.body){const[W,B]=ox(V,Nc(cx(P)));y=dx(fe.body,fx,W,B)}}re.isString(M)||(M=M?"include":"omit");const G=a&&"credentials"in r.prototype,J={...L,signal:C,method:g.toUpperCase(),headers:I.normalize().toJSON(),body:y,duplex:"half",credentials:G?M:void 0};U=a&&new r(x,J);let q=await(a?X(U,L):X(x,J));const se=d&&(N==="stream"||N==="response");if(d&&(S||se&&z)){const fe={};["status","statusText","headers"].forEach(D=>{fe[D]=q[D]});const R=re.toFiniteNumber(q.headers.get("content-length")),[W,B]=S&&ox(R,Nc(cx(S),!0))||[];q=new n(dx(q.body,fx,W,()=>{B&&B(),z&&z()}),fe)}N=N||"text";let ue=await h[re.findKey(h,N)||"text"](q,m);return!se&&z&&z(),await new Promise((fe,R)=>{yv(fe,R,{data:ue,headers:Ar.from(q.headers),status:q.status,statusText:q.statusText,config:m,request:U})})}catch(G){throw z&&z(),G&&G.name==="TypeError"&&/Load failed|fetch/i.test(G.message)?Object.assign(new ze("Network Error",ze.ERR_NETWORK,m,U),{cause:G.cause||G}):ze.from(G,G&&G.code,m,U)}}},w4=new Map,Sv=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:s}=t,a=[n,s,r];let i=a.length,o=i,c,u,d=w4;for(;o--;)c=a[o],u=d.get(c),u===void 0&&d.set(c,u=o?new Map:y4(t)),d=u;return u};Sv();const nh={http:LN,xhr:h4,fetch:{get:Sv}};re.forEach(nh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const mx=e=>`- ${e}`,_4=e=>re.isFunction(e)||e===null||e===!1;function S4(e,t){e=re.isArray(e)?e:[e];const{length:r}=e;let n,s;const a={};for(let i=0;i<r;i++){n=e[i];let o;if(s=n,!_4(n)&&(s=nh[(o=String(n)).toLowerCase()],s===void 0))throw new ze(`Unknown adapter '${o}'`);if(s&&(re.isFunction(s)||(s=s.get(t))))break;a[o||"#"+i]=s}if(!s){const i=Object.entries(a).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?i.length>1?`since :
`+i.map(mx).join(`
`):" "+mx(i[0]):"as no adapter specified";throw new ze("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s}const Ev={getAdapter:S4,adapters:nh};function a0(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new mi(null,e)}function gx(e){return a0(e),e.headers=Ar.from(e.headers),e.data=s0.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ev.getAdapter(e.adapter||$l.adapter,e)(e).then(function(n){return a0(e),n.data=s0.call(e,e.transformResponse,n),n.headers=Ar.from(n.headers),n},function(n){return vv(n)||(a0(e),n&&n.response&&(n.response.data=s0.call(e,e.transformResponse,n.response),n.response.headers=Ar.from(n.response.headers))),Promise.reject(n)})}const Nv="1.13.2",hu={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{hu[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const vx={};hu.transitional=function(t,r,n){function s(a,i){return"[Axios v"+Nv+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,o)=>{if(t===!1)throw new ze(s(i," has been removed"+(r?" in "+r:"")),ze.ERR_DEPRECATED);return r&&!vx[i]&&(vx[i]=!0,console.warn(s(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,o):!0}};hu.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function E4(e,t,r){if(typeof e!="object")throw new ze("options must be an object",ze.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const a=n[s],i=t[a];if(i){const o=e[a],c=o===void 0||i(o,a,e);if(c!==!0)throw new ze("option "+a+" must be "+c,ze.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ze("Unknown option "+a,ze.ERR_BAD_OPTION)}}const qo={assertOptions:E4,validators:hu},Sn=qo.validators;let Js=class{constructor(t){this.defaults=t||{},this.interceptors={request:new ix,response:new ix}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ia(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&qo.assertOptions(n,{silentJSONParsing:Sn.transitional(Sn.boolean),forcedJSONParsing:Sn.transitional(Sn.boolean),clarifyTimeoutError:Sn.transitional(Sn.boolean)},!1),s!=null&&(re.isFunction(s)?r.paramsSerializer={serialize:s}:qo.assertOptions(s,{encode:Sn.function,serialize:Sn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),qo.assertOptions(r,{baseUrl:Sn.spelling("baseURL"),withXsrfToken:Sn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&re.merge(a.common,a[r.method]);a&&re.forEach(["delete","get","head","post","put","patch","common"],m=>{delete a[m]}),r.headers=Ar.concat(i,a);const o=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(c=c&&x.synchronous,o.unshift(x.fulfilled,x.rejected))});const u=[];this.interceptors.response.forEach(function(x){u.push(x.fulfilled,x.rejected)});let d,h=0,f;if(!c){const m=[gx.bind(this),void 0];for(m.unshift(...o),m.push(...u),f=m.length,d=Promise.resolve(r);h<f;)d=d.then(m[h++],m[h++]);return d}f=o.length;let p=r;for(;h<f;){const m=o[h++],x=o[h++];try{p=m(p)}catch(g){x.call(this,g);break}}try{d=gx.call(this,p)}catch(m){return Promise.reject(m)}for(h=0,f=u.length;h<f;)d=d.then(u[h++],u[h++]);return d}getUri(t){t=ia(this.defaults,t);const r=wv(t.baseURL,t.url,t.allowAbsoluteUrls);return xv(r,t.params,t.paramsSerializer)}};re.forEach(["delete","get","head","options"],function(t){Js.prototype[t]=function(r,n){return this.request(ia(n||{},{method:t,url:r,data:(n||{}).data}))}});re.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,o){return this.request(ia(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}Js.prototype[t]=r(),Js.prototype[t+"Form"]=r(!0)});let N4=class Cv{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const i=new Promise(o=>{n.subscribe(o),a=o}).then(s);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,o){n.reason||(n.reason=new mi(a,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Cv(function(s){t=s}),cancel:t}}};function C4(e){return function(r){return e.apply(null,r)}}function T4(e){return re.isObject(e)&&e.isAxiosError===!0}const Fd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Fd).forEach(([e,t])=>{Fd[t]=e});function Tv(e){const t=new Js(e),r=nv(Js.prototype.request,t);return re.extend(r,Js.prototype,t,{allOwnKeys:!0}),re.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return Tv(ia(e,s))},r}const Nt=Tv($l);Nt.Axios=Js;Nt.CanceledError=mi;Nt.CancelToken=N4;Nt.isCancel=vv;Nt.VERSION=Nv;Nt.toFormData=fu;Nt.AxiosError=ze;Nt.Cancel=Nt.CanceledError;Nt.all=function(t){return Promise.all(t)};Nt.spread=C4;Nt.isAxiosError=T4;Nt.mergeConfig=ia;Nt.AxiosHeaders=Ar;Nt.formToJSON=e=>gv(re.isHTMLForm(e)?new FormData(e):e);Nt.getAdapter=Ev.getAdapter;Nt.HttpStatusCode=Fd;Nt.default=Nt;const{Axios:g5,AxiosError:v5,CanceledError:y5,isCancel:w5,CancelToken:_5,VERSION:S5,all:E5,Cancel:N5,isAxiosError:C5,spread:T5,toFormData:b5,AxiosHeaders:A5,HttpStatusCode:j5,formToJSON:k5,getAdapter:R5,mergeConfig:F5}=Nt,b4="http://127.0.0.1:8000/api/v1",Oe=Nt.create({baseURL:b4,headers:{"Content-Type":"application/json"}});Oe.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e});Oe.interceptors.response.use(e=>e,e=>(e.response&&e.response.status,Promise.reject(e)));const pu=()=>{const[e,t]=b.useState(null),[r,n]=b.useState([]),[s,a]=b.useState(!0),[i,o]=b.useState(null),[c,u]=b.useState(!1),d=b.useCallback(async()=>{try{a(!0);const[x,g]=await Promise.all([Oe.get("/foundations/config"),Oe.get("/foundations/tax-rates")]);t(x.data),n(g.data),o(null)}catch(x){console.error("Error cargando datos:",x),o("Error cargando configuracin del servidor.")}finally{a(!1)}},[]);return b.useEffect(()=>{d()},[d]),{config:e,taxRates:r,loading:s,error:i,saving:c,fetchConfig:d,refreshData:d,updateConfig:async x=>{u(!0);try{const{data:g}=await Oe.put("/foundations/config",x);return t(g),{success:!0}}catch(g){return console.error("Error guardando config:",g),{success:!1}}finally{u(!1)}},createTaxRate:async(x,g)=>{u(!0);try{return await Oe.post("/foundations/tax-rates",{name:x,rate:g,is_active:!0}),await d(),{success:!0}}catch(y){return console.error("Error creando impuesto:",y),{success:!1,error:"Error al crear impuesto"}}finally{u(!1)}},toggleTaxRate:async x=>{try{return await Oe.put(`/foundations/tax-rates/${x}/toggle`),await d(),{success:!0}}catch(g){return console.error("Error cambiando estado impuesto:",g),{success:!1}}},uploadLogo:async x=>{u(!0);const g=new FormData;g.append("file",x);try{const y=await Oe.post("/foundations/config/upload-logo",g,{headers:{"Content-Type":"multipart/form-data"}});return e&&t({...e,logo_path:y.data.url}),!0}catch(y){return console.error("Error subiendo logo:",y),!1}finally{u(!1)}}}},A4="https://valentina-erp-v3.uc.r.appspot.com",j4=[{icon:Kf,label:"Dashboard",path:"/",allowedRoles:["DIRECTOR","ADMIN","SALES","DESIGN","WAREHOUSE","PRODUCTION"]},{icon:bl,label:"Proveedores",path:"/providers",allowedRoles:["DIRECTOR","ADMIN","WAREHOUSE"]},{icon:Cs,label:"Materiales",path:"/materials",allowedRoles:["DIRECTOR","ADMIN","DESIGN","WAREHOUSE","PRODUCTION"]},{icon:G1,label:"Almacn",path:"/inventory/reception",allowedRoles:["DIRECTOR","ADMIN","WAREHOUSE","PRODUCTION"]},{icon:Xf,label:"Clientes",path:"/clients",allowedRoles:["DIRECTOR","ADMIN","SALES"]},{icon:Z1,label:"Ventas",path:"/sales",allowedRoles:["DIRECTOR","ADMIN","SALES"]},{icon:J1,label:"Diseo",path:"/design",allowedRoles:["DIRECTOR","ADMIN","SALES","DESIGN","PRODUCTION"]},{icon:X1,label:"Produccin",path:"/production",allowedRoles:["DIRECTOR","ADMIN","DESIGN","PRODUCTION"]},{icon:tv,label:"Logstica",path:"/logistics",allowedRoles:["DIRECTOR","ADMIN","WAREHOUSE","SALES"]},{icon:ev,label:"Gerencia",path:"/management",allowedRoles:["DIRECTOR","ADMIN"]},{icon:Go,label:"Usuarios",path:"/users",allowedRoles:["DIRECTOR"]},{icon:Tl,label:"Impuestos",path:"/tax-rates",allowedRoles:["DIRECTOR","ADMIN"]},{icon:WE,label:"Configuracin",path:"/config",allowedRoles:["DIRECTOR"]}];function k4(){const{config:e,fetchConfig:t,loading:r}=pu(),n=pi(),s=On(),a=n.pathname,[i,o]=b.useState("DIRECTOR");b.useEffect(()=>{t();const x=localStorage.getItem("user_role");x&&o(x.toUpperCase())},[t]);const c=x=>x==="/"?a==="/":a.startsWith(x),u=x=>x?x.startsWith("http")?x:`${A4}/${x}`:"",h=(x=>{switch(x){case"DIRECTOR":return{label:"DIRECCIN",className:"bg-slate-900 text-white border-slate-700"};case"ADMIN":return{label:"ADMINISTRACIN",className:"bg-indigo-100 text-indigo-700 border-indigo-200"};case"SALES":return{label:"VENTAS",className:"bg-emerald-100 text-emerald-700 border-emerald-200"};case"DESIGN":return{label:"DISEO",className:"bg-pink-100 text-pink-700 border-pink-200"};case"WAREHOUSE":return{label:"ALMACN",className:"bg-orange-100 text-orange-800 border-orange-200"};case"PRODUCTION":return{label:"PRODUCCIN",className:"bg-blue-100 text-blue-700 border-blue-200"};default:return{label:x,className:"bg-slate-100 text-slate-500 border-slate-200"}}})(i),f=j4.filter(x=>x.allowedRoles.includes(i)),p=x=>{switch(x){case"DIRECTOR":return"Director General";case"ADMIN":return"Administracin";case"SALES":return"Ventas";case"DESIGN":return"Ingeniera";case"WAREHOUSE":return"Almacn";case"PRODUCTION":return"Jefe Produccin";default:return"Usuario"}},m=()=>{window.confirm("Cerrar sesin?")&&(localStorage.clear(),s("/login"))};return l.jsxs("aside",{className:"w-64 bg-white h-screen fixed left-0 top-0 flex flex-col border-r border-slate-200 z-50 transition-all",children:[l.jsx("div",{className:"h-16 flex items-center px-6 border-b border-slate-100",children:l.jsxs("div",{className:"flex items-center gap-3 w-full",children:[r?l.jsx("div",{className:"w-8 h-8 bg-slate-100 animate-pulse rounded-lg flex-shrink-0"}):e!=null&&e.logo_path?l.jsx("img",{src:u(e.logo_path),alt:"Logo",className:"w-8 h-8 object-contain flex-shrink-0",onError:x=>{x.currentTarget.style.display="none"}}):l.jsx("div",{className:"w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center shadow-sm shadow-indigo-200 flex-shrink-0",children:l.jsx("span",{className:"text-white font-bold text-sm",children:e!=null&&e.company_name?e.company_name.charAt(0).toUpperCase():"S"})}),l.jsx("span",{className:"text-lg font-bold text-slate-800 truncate flex-1 block",title:e==null?void 0:e.company_name,children:r?"Cargando...":(e==null?void 0:e.company_name)||"SGP V3"})]})}),l.jsxs("nav",{className:"flex-1 py-6 px-4 space-y-1 overflow-y-auto custom-scrollbar",children:[l.jsxs("div",{className:"flex items-center justify-between px-2 mb-3",children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Mdulos"}),l.jsx("span",{className:`text-[9px] px-2 py-0.5 rounded border font-bold uppercase ${h.className}`,children:h.label})]}),f.map(x=>{const g=c(x.path);return l.jsxs(SE,{to:x.path,className:`
                group flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200
                ${g?"bg-indigo-50 text-indigo-700":"text-slate-500 hover:bg-slate-50 hover:text-slate-900"}
              `,children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(x.icon,{size:18,className:g?"stroke-[2px]":"stroke-[1.5px]"}),l.jsx("span",{children:x.label})]}),l.jsx(Yf,{size:14,className:`transition-opacity ${g?"opacity-100":"opacity-0 group-hover:opacity-50"}`})]},x.path)})]}),l.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50/50",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3 p-2 rounded-lg hover:bg-white hover:shadow-sm transition-all cursor-pointer group border border-transparent hover:border-slate-100",children:[l.jsxs("div",{className:`w-9 h-9 rounded-full border flex items-center justify-center font-bold text-xs shadow-sm
            ${i==="DIRECTOR"?"bg-slate-800 border-slate-900 text-white":""}
            ${i==="ADMIN"?"bg-indigo-100 border-indigo-200 text-indigo-700":""}
            ${i==="SALES"?"bg-emerald-100 border-emerald-200 text-emerald-700":""}
            ${i==="DESIGN"?"bg-pink-100 border-pink-200 text-pink-700":""}
            ${i==="WAREHOUSE"?"bg-orange-100 border-orange-200 text-orange-700":""}
            ${i==="PRODUCTION"?"bg-blue-100 border-blue-200 text-blue-700":""}
          `,children:[i==="DIRECTOR"&&l.jsx(Ec,{size:16}),i==="ADMIN"&&l.jsx(Xf,{size:16}),i==="SALES"&&l.jsx(ks,{size:16}),i==="DESIGN"&&l.jsx(Jf,{size:16}),i==="WAREHOUSE"&&l.jsx(Cs,{size:16}),i==="PRODUCTION"&&l.jsx(Y1,{size:16})]}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-bold text-slate-700 truncate group-hover:text-indigo-600 transition-colors",children:p(i)}),l.jsxs("p",{className:"text-xs text-slate-400 font-medium flex items-center gap-1",children:[l.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"})," En lnea"]})]})]}),l.jsxs("button",{onClick:m,className:"w-full flex items-center justify-center gap-2 p-2 rounded-md border border-slate-200 text-slate-500 hover:bg-red-50 hover:text-red-600 hover:border-red-100 transition-all text-xs font-medium mb-4 bg-white",children:[l.jsx(UE,{size:14})," Cerrar Sesin"]}),l.jsxs("div",{className:"pt-3 border-t border-slate-200 text-center group cursor-default",children:[l.jsxs("div",{className:"flex items-baseline justify-center gap-1 opacity-70 group-hover:opacity-100 transition-opacity",children:[l.jsx("span",{className:"font-serif italic text-lg text-slate-600 font-medium tracking-wide",children:"Valentina"}),l.jsx("span",{className:"text-[10px] text-slate-400 font-sans tracking-normal font-normal",children:"Software"})]}),l.jsx("p",{className:"text-[9px] text-slate-400 font-mono mt-0.5 tracking-tight uppercase",children:"Sistema de Produccin v3.0"})]})]})]})}function R4(){return l.jsxs("header",{className:"h-14 bg-white border-b border-slate-200 sticky top-0 z-30 px-6 flex items-center justify-between transition-all",children:[l.jsx("div",{className:"flex-1 max-w-lg",children:l.jsxs("div",{className:"relative group",children:[l.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500 transition-colors",size:16}),l.jsx("input",{type:"text",placeholder:"Buscar orden, cliente o material...",className:"w-full pl-9 pr-4 py-1.5 bg-slate-100 border-none rounded-full text-xs font-medium text-slate-700 focus:ring-2 focus:ring-indigo-500/20 focus:bg-white transition-all outline-none placeholder:text-slate-400"})]})}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"hidden lg:flex items-center gap-2 bg-emerald-50 px-2.5 py-1 rounded-full border border-emerald-100",children:[l.jsx(X1,{size:14,className:"text-emerald-600"}),l.jsx("span",{className:"text-[10px] font-bold text-emerald-700 uppercase tracking-wide",children:"Planta Mrida"}),l.jsx("span",{className:"w-px h-3 bg-emerald-200 mx-1"}),l.jsxs("span",{className:"text-[10px] font-bold text-emerald-600 flex items-center gap-1",children:[l.jsx(QE,{size:10})," Operativo"]})]}),l.jsx("div",{className:"h-6 w-px bg-slate-200 hidden lg:block"}),l.jsxs("button",{className:"relative p-1.5 text-slate-400 hover:text-indigo-600 transition-colors",children:[l.jsx(AE,{size:18}),l.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full border border-white"})]})]})]})}function F4(){return l.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden font-sans",children:[l.jsx(k4,{}),l.jsxs("div",{className:"flex-1 flex flex-col ml-64 transition-all duration-300 h-screen",children:[l.jsx(R4,{}),l.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-slate-50 p-6",children:l.jsx("div",{className:"max-w-7xl mx-auto",children:l.jsx(uE,{})})})]})]})}const it={AUTH:{LOGIN:"/auth/login",ME:"/auth/me",USERS:"/auth/users"},FOUNDATIONS:{CLIENTS:"/foundations/clients",PROVIDERS:"/foundations/providers",MATERIALS:"/foundations/materials",TAX_RATES:"/foundations/tax-rates",GLOBAL_CONFIG:"/foundations/config",UPLOAD_LOGO:"/foundations/config/upload-logo"},DESIGN:{MASTERS:"/design/masters",PRODUCTS:"/design/masters",MASTER_DETAIL:e=>`/design/masters/${e}`,VERSIONS_BY_MASTER:e=>`/design/masters/${e}/versions`,VERSIONS:"/design/versions",VERSION_DETAIL:e=>`/design/versions/${e}`,VERSION_STATUS:e=>`/design/versions/${e}/status`},SALES:{ORDERS:"/sales/orders",ORDER_DETAIL:e=>`/sales/orders/${e}`,ORDER_STATUS:e=>`/sales/orders/${e}/status`}},wt={createOrder:async e=>(await Oe.post(it.SALES.ORDERS,e)).data,getOrders:async(e,t)=>{const r={};return e&&(r.status=e),t&&(r.client_id=t),(await Oe.get(it.SALES.ORDERS,{params:r})).data},getOrderDetail:async e=>{const t=it.SALES.ORDER_DETAIL(e);return(await Oe.get(t)).data},updateOrder:async(e,t)=>{const r=it.SALES.ORDER_DETAIL(e);return(await Oe.patch(r,t)).data},deleteOrder:async e=>{const t=it.SALES.ORDER_DETAIL(e);await Oe.delete(t)},downloadPDF:async(e,t="Cotizacion.pdf")=>{const r=`${it.SALES.ORDER_DETAIL(e)}/pdf`;try{const n=await Oe.get(r,{responseType:"blob"}),s=new Blob([n.data],{type:"application/pdf"}),a=window.URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.setAttribute("download",t),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(a)}catch(n){throw console.error("Error descargando PDF:",n),n}},requestAuth:async e=>{const t=`${it.SALES.ORDER_DETAIL(e)}/request-auth`;await Oe.post(t)},authorizeOrder:async e=>{const t=`${it.SALES.ORDER_DETAIL(e)}/authorize`;await Oe.post(t)},rejectOrder:async e=>{const t=`${it.SALES.ORDER_DETAIL(e)}/reject`;await Oe.post(t)},markAsSold:async e=>{const t=`${it.SALES.ORDER_DETAIL(e)}/mark_sold`;await Oe.post(t)},markAsLost:async e=>{const t=`${it.SALES.ORDER_DETAIL(e)}/mark_lost`;await Oe.post(t)},requestChanges:async e=>{const t=`${it.SALES.ORDER_DETAIL(e)}/request_changes`;await Oe.post(t)}},sh=()=>{const[e,t]=b.useState([]),[r,n]=b.useState(null),[s,a]=b.useState(!1),[i,o]=b.useState(null),c=b.useCallback(async(f,p,m=!1)=>{var x,g;m||a(!0),o(null);try{const y=await wt.getOrders(f,p);t(y)}catch(y){console.error("Error al cargar rdenes:",y),m||o(((g=(x=y.response)==null?void 0:x.data)==null?void 0:g.detail)||"Error al cargar el listado de ventas.")}finally{m||a(!1)}},[]),u=b.useCallback(async f=>{var p,m;a(!0),o(null);try{const x=await wt.getOrderDetail(f);return n(x),x}catch(x){return console.error("Error al cargar detalle:",x),o(((m=(p=x.response)==null?void 0:p.data)==null?void 0:m.detail)||"Error al cargar el detalle."),null}finally{a(!1)}},[]);return{orders:e,currentOrder:r,loading:s,error:i,fetchOrders:c,fetchOrderDetail:u,createQuote:async f=>{var p,m;a(!0),o(null);try{const x=await wt.createOrder(f);return t(g=>[x,...g]),{success:!0,order:x}}catch(x){console.error("Error al crear cotizacin:",x);const g=((m=(p=x.response)==null?void 0:p.data)==null?void 0:m.detail)||"No se pudo crear la cotizacin.";return o(g),{success:!1,error:g}}finally{a(!1)}},updateOrderStatus:async(f,p)=>{var m,x;a(!0);try{const g=await wt.updateOrder(f,{status:p});return t(y=>y.map(v=>v.id===f?g:v)),r&&r.id===f&&n(g),{success:!0}}catch(g){return{success:!1,error:((x=(m=g.response)==null?void 0:m.data)==null?void 0:x.detail)||"Error al actualizar estatus."}}finally{a(!1)}}}},_r={getPayableDashboardStats:async()=>(await Oe.get("/finance/payable-stats")).data,requestPayment:async e=>(await Oe.post("/finance/payments/request",e)).data,updatePaymentRequest:async(e,t)=>(await Oe.put(`/finance/payments/request/${e}`,t)).data,cancelPaymentRequest:async e=>{await Oe.delete(`/finance/payments/request/${e}`)},getPendingApprovals:async()=>(await Oe.get("/finance/payments/pending-approvals")).data,updatePaymentStatus:async(e,t)=>(await Oe.put(`/finance/payments/${e}/status`,{status:t})).data,getPendingInvoices:async()=>(await Oe.get("/finance/invoices/pending")).data};var Pe=(e=>(e.DRAFT="DRAFT",e.SENT="SENT",e.ACCEPTED="ACCEPTED",e.REJECTED="REJECTED",e.SOLD="SOLD",e.CLIENT_REJECTED="CLIENT_REJECTED",e.CHANGE_REQUESTED="CHANGE_REQUESTED",e.IN_PRODUCTION="IN_PRODUCTION",e.COMPLETED="COMPLETED",e.CANCELLED="CANCELLED",e))(Pe||{});const St=({children:e,className:t="",...r})=>l.jsx("div",{className:`bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow ${t}`,...r,children:e}),ot=({children:e,variant:t="primary",className:r="",...n})=>{const s="px-4 py-2 rounded-lg font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",a={primary:"bg-indigo-600 text-white hover:bg-indigo-700 shadow-md shadow-indigo-200",secondary:"bg-white text-slate-700 border border-slate-300 hover:bg-slate-50",outline:"bg-transparent border border-indigo-600 text-indigo-600 hover:bg-indigo-50",danger:"bg-red-50 text-red-600 border border-red-200 hover:bg-red-100"};return l.jsx("button",{className:`${s} ${a[t]} ${r}`,...n,children:e})},la=({children:e,variant:t="secondary"})=>{const r={success:"bg-emerald-100 text-emerald-700 border-emerald-200",warning:"bg-amber-100 text-amber-700 border-amber-200",danger:"bg-red-100 text-red-700 border-red-200",secondary:"bg-slate-100 text-slate-600 border-slate-200",info:"bg-blue-100 text-blue-700 border-blue-200"};return l.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-bold border ${r[t]}`,children:e})},D4=({orderId:e,onClose:t,onOrderUpdated:r})=>{const[n,s]=b.useState(!1),[a,i]=b.useState(!1),[o,c]=b.useState(null),[u,d]=b.useState(0),[h,f]=b.useState(0),[p,m]=b.useState([]),[x,g]=b.useState(new Set),y=b.useMemo(()=>o?[Pe.SOLD,Pe.REJECTED,Pe.CLIENT_REJECTED,Pe.CANCELLED].includes(o.status):!0,[o]);b.useEffect(()=>{e&&v(e)},[e]);const v=async L=>{s(!0);try{const X=await wt.getOrderDetail(L);c(X);let C=X.applied_commission_percent||0;C>0&&C<1&&(C=C*100),f(Number(C.toFixed(2)));const U=X.items.map(J=>{const q=J.frozen_unit_cost||0,se=J.unit_price||0,ue=1+C/100,fe=se/ue;if(q===0||fe===0)return 40;const R=(fe/q-1)*100;return Number(R.toFixed(2))});m(U);let z=0,V=0;X.items.forEach((J,q)=>{const se=J.quantity||1,ue=J.frozen_unit_cost||0,fe=U[q],R=ue*(1+fe/100);z+=ue*se,V+=R*se});const G=z>0?(V-z)/z*100:0;d(Number(G.toFixed(2)))}catch(X){console.error("Error cargando orden:",X),alert("No se pudo cargar la informacin."),t()}finally{s(!1)}},w=L=>{if(y)return;const X=isNaN(L)?0:L;if(d(X),o){const C=new Array(o.items.length).fill(X);m(C)}},_=(L,X)=>{if(y||!o)return;const C=isNaN(X)?0:X,U=[...p];U[L]=C,m(U);let z=0,V=0;o.items.forEach((J,q)=>{const se=J.quantity||1,ue=J.frozen_unit_cost||0,fe=U[q],R=ue*(1+fe/100);z+=ue*se,V+=R*se});const G=z>0?(V-z)/z*100:0;d(Number(G.toFixed(2)))},S=b.useMemo(()=>{if(!o||p.length===0)return null;let L=0,X=0;const C=o.items.map((ue,fe)=>{const R=ue.frozen_unit_cost||0;L+=R*ue.quantity;const W=p[fe]||0,B=1+W/100,D=R*B;X+=D*ue.quantity;const te=1+h/100,we=D*te;return{...ue,usedMargin:W,baseUnitPrice:D,newUnitPrice:we}}),U=X*(h/100),z=X+U,V=o.subtotal>0?o.tax_amount/o.subtotal:.16,G=z*V,J=z+G,q=z-U-L,se=L>0?(X-L)/L*100:0;return{totalBaseCost:L,sumOfItems:X,commissionAmount:U,subtotal:z,taxAmount:G,total:J,netUtility:q,realWeightedMargin:se,simulatedItems:C}},[o,p,h]),P=L=>{const X=new Set(x);X.has(L)?X.delete(L):X.add(L),g(X)},N=async()=>{if(!(!o||!S)&&window.confirm("Confirmar Autorizacin de Precios?")){i(!0);try{const L=S.simulatedItems.map(C=>({product_name:C.product_name,origin_version_id:C.origin_version_id,quantity:C.quantity,unit_price:Number(C.baseUnitPrice.toFixed(2)),frozen_unit_cost:C.frozen_unit_cost,cost_snapshot:C.cost_snapshot})),X=h;await wt.updateOrder(o.id,{status:Pe.ACCEPTED,applied_margin_percent:Number(S.realWeightedMargin.toFixed(2)),applied_commission_percent:X,items:L,subtotal:S.subtotal,tax_amount:S.taxAmount,total_price:S.total}),r(),t()}catch(L){console.error(L),alert("Error al autorizar.")}finally{i(!1)}}},I=async()=>{if(o&&window.confirm("Rechazar cotizacin?")){i(!0);try{await wt.rejectOrder(o.id),r(),t()}catch(L){console.error(L),alert("Error")}finally{i(!1)}}},M=L=>L.toLocaleString("es-MX",{style:"currency",currency:"MXN"});return!e||!S?null:n?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 text-white backdrop-blur-sm",children:"Cargando..."}):l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-slate-50 rounded-xl shadow-2xl w-full max-w-7xl h-[95vh] flex flex-col overflow-hidden relative border border-slate-700",children:[l.jsxs("div",{className:"bg-slate-900 text-white p-4 flex justify-between items-center shrink-0",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[l.jsx(H1,{size:20,className:"text-emerald-400"}),"Ingeniera Financiera",y&&l.jsxs("span",{className:"text-xs bg-red-500 text-white px-2 py-0.5 rounded ml-2 flex items-center gap-1",children:[l.jsx(aa,{size:10})," SOLO LECTURA"]})]}),l.jsxs("p",{className:"text-xs text-slate-400",children:["Folio #",o==null?void 0:o.id,"  Proyecto: ",l.jsx("span",{className:"text-white font-medium",children:o==null?void 0:o.project_name})]})]}),l.jsx("button",{onClick:t,className:"bg-slate-800 hover:bg-slate-700 p-2 rounded-full transition-colors",children:l.jsx(kr,{size:20})})]}),l.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col lg:flex-row",children:[l.jsxs("div",{className:"flex-1 overflow-y-auto p-4 border-r border-slate-200 bg-white",children:[l.jsx("div",{className:"flex justify-between items-center mb-3",children:l.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase flex items-center gap-2",children:[l.jsx(_c,{size:14})," Partidas (",o==null?void 0:o.items.length,")"]})}),l.jsx("div",{className:"space-y-3",children:S.simulatedItems.map((L,X)=>{var C;return l.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:`flex items-center p-3 gap-2 ${x.has(X)?"bg-slate-50 border-b border-slate-200":""}`,children:[l.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[180px]",children:[l.jsx("button",{onClick:()=>P(X),className:"text-slate-400 hover:text-indigo-600",children:x.has(X)?l.jsx(qf,{size:16}):l.jsx(Yf,{size:16})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-bold text-slate-700 text-sm truncate w-full max-w-[200px]",title:L.product_name,children:L.product_name}),l.jsxs("div",{className:"text-[10px] text-slate-400",children:["Cant: ",L.quantity]})]})]}),l.jsxs("div",{className:"flex flex-col items-center px-2 border-l border-slate-100",children:[l.jsx("label",{className:"text-[9px] font-bold text-slate-400 mb-1",children:"MARGEN %"}),l.jsx("div",{className:"relative w-20",children:l.jsx("input",{type:"number",step:"0.01",disabled:y,value:p[X],onChange:U=>_(X,parseFloat(U.target.value)),className:`w-full text-center font-bold text-sm border rounded py-1 outline-none focus:ring-2 focus:ring-indigo-500 disabled:bg-slate-100 disabled:text-slate-500 ${!y&&p[X]<30?"text-red-600 bg-red-50 border-red-200":"text-indigo-700 border-indigo-200"}`})})]}),l.jsxs("div",{className:"w-24 text-center hidden md:block border-l border-r border-slate-100 mx-2",children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase",children:"Costo Unit."}),l.jsx("div",{className:"font-mono font-bold text-slate-800 text-sm",children:M(L.frozen_unit_cost)})]}),l.jsxs("div",{className:"w-28 text-right pl-2",children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase",children:"Precio Base"}),l.jsx("div",{className:"font-mono font-bold text-slate-600 text-sm",children:M(L.baseUnitPrice)})]})]}),x.has(X)&&l.jsx("div",{className:"bg-slate-50 p-3 shadow-inner text-xs",children:(C=L.cost_snapshot)!=null&&C.ingredients?l.jsx("div",{className:"max-h-40 overflow-y-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"text-slate-400 text-left bg-slate-100 border-b border-slate-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"pb-1 pl-2 py-1 w-[40%]",children:"Concepto"}),l.jsx("th",{className:"pb-1 text-center py-1",children:"Cant."}),l.jsx("th",{className:"pb-1 text-right py-1",children:"Costo Unit."}),l.jsx("th",{className:"pb-1 text-right pr-2 py-1 bg-slate-200/50",children:"Importe"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-200",children:L.cost_snapshot.ingredients.map((U,z)=>l.jsxs("tr",{children:[l.jsx("td",{className:"py-1 pl-2 text-slate-600 font-medium",children:U.name}),l.jsx("td",{className:"py-1 text-center text-slate-500",children:U.qty_recipe}),l.jsx("td",{className:"py-1 text-right font-mono text-slate-400",children:M(U.frozen_unit_cost)}),l.jsx("td",{className:"py-1 text-right font-mono font-bold text-slate-700 pr-2 bg-slate-50",children:M(U.frozen_unit_cost*U.qty_recipe)})]},z))})]})}):l.jsxs("div",{className:"text-amber-600 flex items-center gap-2",children:[l.jsx(Vn,{size:12})," Sin receta vinculada."]})})]},X)})})]}),l.jsxs("div",{className:"w-full lg:w-[380px] bg-slate-50 p-6 flex flex-col border-l border-slate-200 shadow-xl z-10",children:[l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm mb-6",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-800 flex items-center gap-2 mb-4 pb-2 border-b border-slate-100",children:[l.jsx(fn,{size:16,className:"text-indigo-600"})," Control Maestro"]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:y?"opacity-50 pointer-events-none":"",children:[l.jsx("div",{className:"flex justify-between items-center mb-1",children:l.jsxs("label",{className:"text-xs font-bold text-slate-600 flex items-center gap-1",children:[l.jsx(HE,{size:10,className:"text-slate-400"}),"Aplicar Margen a Todo (%)"]})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"range",min:"0",max:"100",step:"0.01",disabled:y,value:u,onChange:L=>w(parseFloat(L.target.value)),className:"flex-1 h-2 bg-indigo-100 rounded-lg appearance-none cursor-pointer accent-indigo-600"}),l.jsx("input",{type:"number",step:"0.01",disabled:y,value:u,onChange:L=>w(parseFloat(L.target.value)),className:"w-16 p-1 text-right text-xs font-bold border rounded border-indigo-200 text-indigo-700 outline-none"})]})]}),l.jsxs("div",{className:y?"opacity-50 pointer-events-none":"",children:[l.jsx("div",{className:"flex justify-between items-center mb-1",children:l.jsx("label",{className:"text-xs font-bold text-slate-600",children:"Comisin Vendedor (Add-on)"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"range",min:"0",max:"50",step:"0.5",disabled:y,value:h,onChange:L=>f(Number(L.target.value)),className:"flex-1 h-2 bg-amber-100 rounded-lg appearance-none cursor-pointer accent-amber-500"}),l.jsx("input",{type:"number",step:"0.1",disabled:y,value:h,onChange:L=>f(Number(L.target.value)),className:"w-16 p-1 text-right text-xs font-bold border rounded border-amber-200 text-amber-700 outline-none"})]})]})]})]}),l.jsxs("div",{className:"flex-1 space-y-3 bg-white p-4 rounded-xl border border-slate-200",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-slate-500",children:"Suma Importes:"}),l.jsx("span",{className:"font-mono text-slate-700",children:M(S.sumOfItems)})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsxs("span",{className:"text-amber-600 font-medium flex items-center gap-1",children:[l.jsx(xr,{size:10})," Comisin (",h.toFixed(1),"%):"]}),l.jsx("span",{className:"font-mono text-amber-600 font-bold",children:M(S.commissionAmount)})]}),l.jsxs("div",{className:"flex justify-between text-sm border-t border-dashed border-slate-200 pt-2",children:[l.jsx("span",{className:"text-slate-700 font-bold",children:"Subtotal:"}),l.jsx("span",{className:"font-mono font-bold text-slate-800",children:M(S.subtotal)})]}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-slate-500",children:"IVA:"}),l.jsx("span",{className:"font-mono text-slate-500",children:M(S.taxAmount)})]}),l.jsxs("div",{className:"flex justify-between text-lg border-t-2 border-slate-800 pt-2 mt-1",children:[l.jsx("span",{className:"text-slate-900 font-black",children:"TOTAL:"}),l.jsx("span",{className:"font-mono font-black text-emerald-600",children:M(S.total)})]}),l.jsx("div",{className:"mt-4 pt-2 border-t border-slate-100",children:l.jsxs("div",{className:"flex justify-between items-center text-xs",children:[l.jsx("span",{className:"text-slate-400 uppercase font-bold",children:"Utilidad Neta Real:"}),l.jsxs("span",{className:`font-mono font-bold ${S.netUtility>0?"text-emerald-600":"text-red-500"}`,children:[M(S.netUtility)," (",S.realWeightedMargin.toFixed(1),"%)"]})]})})]}),l.jsx("div",{className:"mt-6 space-y-3",children:y?l.jsxs("div",{className:"bg-slate-200 p-4 rounded-lg text-center text-slate-500 text-sm font-medium border border-slate-300",children:[l.jsx(aa,{size:20,className:"mx-auto mb-2 text-slate-400"}),"Cotizacin cerrada / vendida."]}):l.jsxs(l.Fragment,{children:[l.jsxs(ot,{onClick:N,disabled:a,className:"w-full bg-emerald-600 hover:bg-emerald-700 py-3 shadow-md text-sm uppercase tracking-wide font-bold",children:[l.jsx(FE,{size:18,className:"mr-2"})," AUTORIZAR COTIZACIN"]}),l.jsxs(ot,{variant:"secondary",onClick:I,disabled:a,className:"w-full bg-white border-red-200 text-red-600 hover:bg-red-50 text-xs",children:[l.jsx(Zf,{size:14,className:"mr-2"})," Rechazar Cotizacin"]})]})})]})]})]})})},fr=({label:e,className:t="",...r})=>l.jsxs("div",{className:"w-full",children:[e&&l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:e}),l.jsx("input",{className:`w-full px-3 py-2 bg-white border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all ${t}`,...r})]}),bv=({invoice:e,existingRequest:t,onClose:r,onSubmit:n})=>{const[s,a]=b.useState(t?t.amount:0),[i,o]=b.useState(t?new Date(t.payment_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0]),[c,u]=b.useState(t?t.payment_method:"TRANSFERENCIA"),[d,h]=b.useState(t&&t.reference||""),[f,p]=b.useState(t&&t.notes||""),[m,x]=b.useState(!1);b.useEffect(()=>{e&&!t&&a(e.outstanding_balance)},[e,t]);const g=async w=>{w.preventDefault();const _=t?t.amount+((e==null?void 0:e.outstanding_balance)||0):(e==null?void 0:e.outstanding_balance)||0;if(s<=0){alert("Monto invlido.");return}if(!t&&s>_){alert(`Monto invlido. No puede ser mayor al saldo pendiente ($${_}).`);return}x(!0);const S=t?t.purchase_invoice_id||t.invoice_id:e.id;try{await n({invoice_id:S,amount:s,payment_date:new Date(i).toISOString(),payment_method:c,reference:d,notes:f}),r()}catch(P){console.error(P),alert("Error al procesar la solicitud.")}finally{x(!1)}},y=t?t.invoice_folio:(e==null?void 0:e.invoice_number)||"S/N",v=e?e.outstanding_balance:0;return l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 backdrop-blur-sm p-4 animate-fadeIn",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden",children:[l.jsxs("div",{className:"bg-slate-50 px-6 py-4 border-b border-slate-100 flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-bold text-slate-800",children:t?"Editar Solicitud":"Solicitar Pago"}),l.jsxs("p",{className:"text-xs text-slate-500",children:["Factura: ",y]})]}),l.jsx("button",{onClick:r,className:"text-slate-400 hover:text-slate-600",children:l.jsx(kr,{size:20})})]}),l.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Monto a Pagar"}),l.jsxs("div",{className:"relative",children:[l.jsx(fn,{size:16,className:"absolute left-3 top-3 text-slate-400"}),l.jsx("input",{type:"number",step:"0.01",className:"w-full pl-9 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none font-mono text-lg font-bold text-slate-700",value:s,onChange:w=>a(parseFloat(w.target.value))})]}),!t&&l.jsxs("p",{className:"text-[10px] text-right mt-1 text-slate-400",children:["Saldo pendiente: ",l.jsxs("span",{className:"font-bold text-red-500",children:["$",v.toLocaleString("es-MX")]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Fecha Pago"}),l.jsxs("div",{className:"relative",children:[l.jsx(kn,{size:16,className:"absolute left-3 top-3 text-slate-400"}),l.jsx("input",{type:"date",className:"w-full pl-9 pr-2 py-2 border border-slate-300 rounded-lg text-sm outline-none focus:border-indigo-500",value:i,onChange:w=>o(w.target.value)})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Mtodo"}),l.jsxs("div",{className:"relative",children:[l.jsx(kE,{size:16,className:"absolute left-3 top-3 text-slate-400"}),l.jsxs("select",{className:"w-full pl-9 pr-2 py-2 border border-slate-300 rounded-lg text-sm bg-white outline-none focus:border-indigo-500",value:c,onChange:w=>u(w.target.value),children:[l.jsx("option",{value:"TRANSFERENCIA",children:"Transferencia"}),l.jsx("option",{value:"CHEQUE",children:"Cheque"}),l.jsx("option",{value:"EFECTIVO",children:"Efectivo"}),l.jsx("option",{value:"TARJETA",children:"Tarjeta"})]})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Referencia / Folio"}),l.jsxs("div",{className:"relative",children:[l.jsx(K1,{size:16,className:"absolute left-3 top-3 text-slate-400"}),l.jsx(fr,{className:"pl-9",placeholder:"Ej. SPEI-123456",value:d,onChange:w=>h(w.target.value)})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Notas Internas"}),l.jsxs("div",{className:"relative",children:[l.jsx(As,{size:16,className:"absolute left-3 top-3 text-slate-400"}),l.jsx(fr,{className:"pl-9",placeholder:"Opcional...",value:f,onChange:w=>p(w.target.value)})]})]}),l.jsxs("div",{className:"pt-4 flex gap-3",children:[l.jsx(ot,{variant:"secondary",onClick:r,type:"button",className:"flex-1",children:"Cancelar"}),l.jsx(ot,{type:"submit",className:"flex-1 bg-indigo-600 hover:bg-indigo-700 text-white",disabled:m,children:m?"Guardando...":t?"Actualizar Solicitud":"Solicitar Autorizacin"})]})]})]})})},O4=({onClose:e,onUpdate:t})=>{const[r,n]=b.useState([]),[s,a]=b.useState(!0),[i,o]=b.useState(null);b.useEffect(()=>{c()},[]);const c=async()=>{try{const d=await _r.getPendingApprovals();n(d)}catch(d){console.error("Error cargando solicitudes:",d)}finally{a(!1)}},u=async(d,h)=>{if(confirm(`Ests seguro de ${h==="APPROVED"?"AUTORIZAR":"RECHAZAR"} este pago?`)){o(d);try{await _r.updatePaymentStatus(d,h),n(f=>f.filter(p=>p.id!==d)),r.length===1&&(t(),e())}catch{alert("Error al procesar la solicitud.")}finally{o(null)}}};return l.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 animate-fadeIn p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-hidden flex flex-col max-h-[90vh]",children:[l.jsxs("div",{className:"bg-slate-50 px-6 py-4 border-b border-slate-100 flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-xl font-black text-slate-800 flex items-center gap-2",children:[l.jsx(As,{className:"text-indigo-600"})," Firmas Pendientes"]}),l.jsx("p",{className:"text-sm text-slate-500",children:"Autorizacin de egresos solicitados por Gerencia."})]}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-200 rounded-full transition-colors",children:l.jsx(kr,{size:20,className:"text-slate-500"})})]}),l.jsx("div",{className:"overflow-y-auto p-6 bg-slate-50/50 flex-1",children:s?l.jsx("div",{className:"text-center py-10 text-slate-400",children:"Cargando solicitudes..."}):r.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-slate-400",children:[l.jsx(Ad,{className:"w-16 h-16 text-emerald-200 mb-4"}),l.jsx("p",{className:"font-medium text-lg text-slate-600",children:"Todo al da!"}),l.jsx("p",{className:"text-sm",children:"No hay pagos pendientes de firma."})]}):l.jsx("div",{className:"grid gap-4",children:r.map(d=>l.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-shadow flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"bg-indigo-50 text-indigo-700 text-[10px] font-bold px-2 py-0.5 rounded border border-indigo-100 uppercase tracking-wide",children:d.payment_method}),l.jsxs("span",{className:"text-xs text-slate-400 flex items-center gap-1",children:[l.jsx(kn,{size:10})," Solicitado el ",new Date(d.created_at).toLocaleDateString()]})]}),l.jsx("h3",{className:"text-lg font-bold text-slate-800",children:d.provider_name}),l.jsxs("p",{className:"text-sm text-slate-500",children:["Factura: ",l.jsx("span",{className:"font-mono text-slate-700",children:d.invoice_folio}),d.reference&&`  Ref: ${d.reference}`]}),d.notes&&l.jsxs("div",{className:"mt-2 text-xs bg-amber-50 text-amber-800 p-2 rounded border border-amber-100 flex items-start gap-2",children:[l.jsx(Nl,{size:12,className:"mt-0.5 shrink-0"}),d.notes]})]}),l.jsxs("div",{className:"flex flex-col items-end gap-3 w-full md:w-auto",children:[l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-xs text-slate-400 font-bold uppercase",children:"Monto a Pagar"}),l.jsxs("div",{className:"text-2xl font-black text-slate-800",children:["$",d.amount.toLocaleString("es-MX",{minimumFractionDigits:2})]})]}),l.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[l.jsxs(ot,{variant:"danger",size:"sm",onClick:()=>u(d.id,"REJECTED"),disabled:i===d.id,className:"flex-1 md:flex-none",children:[l.jsx(bE,{size:16,className:"mr-1"})," Rechazar"]}),l.jsx(ot,{size:"sm",className:"bg-emerald-600 hover:bg-emerald-700 text-white flex-1 md:flex-none",onClick:()=>u(d.id,"APPROVED"),disabled:i===d.id,children:i===d.id?"Procesando...":l.jsxs(l.Fragment,{children:[l.jsx(Ad,{size:16,className:"mr-1"})," Autorizar Pago"]})})]})]})]},d.id))})}),l.jsx("div",{className:"bg-white p-4 border-t border-slate-100 flex justify-end",children:l.jsx(ot,{variant:"secondary",onClick:e,children:"Cerrar"})})]})})},I4=()=>{const e=On(),[t,r]=b.useState("DIRECTOR"),[n,s]=b.useState("Usuario"),[a,i]=b.useState(new Date),{orders:o,fetchOrders:c}=sh(),[u,d]=b.useState(null),[h,f]=b.useState([]),[p,m]=b.useState(!1),[x,g]=b.useState(null),[y,v]=b.useState(null),[w,_]=b.useState("NONE"),[S,P]=b.useState("dashboard"),[N,I]=b.useState(null),[M,L]=b.useState(!1),X=oe=>{const A={DRAFT:"bg-gray-100 text-gray-800",SENT:"bg-yellow-100 text-yellow-800",ACCEPTED:"bg-blue-100 text-blue-800",CHANGE_REQUESTED:"bg-orange-100 text-orange-800",SOLD:"bg-emerald-100 text-emerald-800",PAID:"bg-teal-100 text-teal-800",REJECTED:"bg-red-100 text-red-800",CLIENT_REJECTED:"bg-red-100 text-red-800"},H={DRAFT:"Borrador",SENT:"Por Autorizar",ACCEPTED:"Autorizada",CHANGE_REQUESTED:"Cambios Solicitados",SOLD:"Vendida",PAID:"Pagada",REJECTED:"Rechazada Int.",CLIENT_REJECTED:"Rechazada Cte."};return l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-bold rounded-full ${A[oe]||"bg-gray-100 text-gray-800"}`,children:H[oe]||oe})};b.useEffect(()=>{const oe=(localStorage.getItem("user_role")||"DIRECTOR").toUpperCase(),A=localStorage.getItem("full_name")||localStorage.getItem("user_name")||"Usuario";r(oe),s(A);const H=setInterval(()=>i(new Date),1e3*60);return()=>clearInterval(H)},[]),b.useEffect(()=>{const oe=t==="ADMIN"||t==="DIRECTOR",A=async()=>{c&&c();try{const H=await _r.getPayableDashboardStats();d(H)}catch(H){console.error("Error polling finance stats:",H)}};if(oe){A();const H=setInterval(()=>{A()},3e4);return()=>clearInterval(H)}},[t,c]),b.useEffect(()=>{w==="PAYABLES"?(m(!0),_r.getPendingInvoices().then(oe=>f(oe)).finally(()=>m(!1))):g(null)},[w]);const C=oe=>{w==="SALES_AUDIT"&&S===oe?_("NONE"):(_("SALES_AUDIT"),P(oe))},U=()=>{_(w==="RECEIVABLES"?"NONE":"RECEIVABLES")},z=()=>{_(w==="PAYABLES"?"NONE":"PAYABLES")},G=(()=>{if(!x)return[];const oe=new Date;oe.setHours(0,0,0,0);const A=oe.getDay();let H=5-A;A===6&&(H=6);const Z=new Date(oe);Z.setDate(oe.getDate()+H),Z.setHours(23,59,59,999);const de=new Date(Z);return de.setDate(Z.getDate()+15),h.filter(ve=>{const he=new Date(ve.due_date+"T12:00:00");return x==="THIS_FRIDAY"?he<=Z:x==="NEXT_15_DAYS"?he>Z&&he<=de:x==="FUTURE"?he>de:!1})})(),J=async oe=>{try{await _r.requestPayment(oe),alert("Solicitud enviada a Direccin"),v(null),c();const A=await _r.getPayableDashboardStats();d(A);const H=await _r.getPendingInvoices();f(H)}catch{alert("Error al solicitar pago")}},q=Array.isArray(o)?o:[],se=new Date().getMonth(),ue=new Date().getFullYear(),fe=new Date().toLocaleString("es-MX",{month:"long"}),R=q.filter(oe=>oe.status===Pe.SENT),W=R.reduce((oe,A)=>oe+(A.total_price||0),0),B=R.length>0,D=q.filter(oe=>{const A=oe.status===Pe.SOLD||oe.status===Pe.PAID,H=oe.created_at?new Date(oe.created_at):new Date;return A&&H.getMonth()===se&&H.getFullYear()===ue}),te=D.reduce((oe,A)=>oe+(A.total_price||0),0),we=q.filter(oe=>oe.status===Pe.SOLD),Ee=we.reduce((oe,A)=>oe+(A.total_price||0),0),xe=oe=>oe.toLocaleString("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2,maximumFractionDigits:2}),pe=oe=>{if(!oe)return"-";if(oe.includes("T"))return new Date(oe).toLocaleDateString("es-MX",{day:"2-digit",month:"2-digit"});const[A,H,Z]=oe.split("-");return`${Z}/${H}`},Le=b.useMemo(()=>{const oe=q.filter(A=>A.status!==Pe.DRAFT);switch(S){case"dashboard":return oe.filter(A=>A.status===Pe.SENT||A.status===Pe.CHANGE_REQUESTED);case"pipeline":return oe.filter(A=>A.status===Pe.ACCEPTED||A.status===Pe.SOLD);case"history":return oe.filter(A=>A.status===Pe.PAID||A.status===Pe.SOLD||A.status===Pe.REJECTED||A.status===Pe.CLIENT_REJECTED);default:return oe}},[q,S]),ie=()=>S==="dashboard"?"Cotizaciones por Autorizar":S==="history"?"Historial de Ventas (Cerradas)":"Auditora General",ke=(()=>{switch(t){case"SALES":return{title:"Panel Comercial",subtitle:"Gestiona cotizaciones.",color:"from-emerald-500 to-teal-600",shortcuts:[{label:"Nueva Cotizacin",icon:tx,path:"/sales/new",color:"bg-emerald-100 text-emerald-700"},{label:"Ver Ventas",icon:Z1,path:"/sales",color:"bg-blue-100 text-blue-700"},{label:"Clientes",icon:bl,path:"/clients",color:"bg-indigo-100 text-indigo-700"},{label:"Stock",icon:ii,path:"/materials",color:"bg-slate-100 text-slate-700"}]};case"DESIGN":return{title:"Ingeniera",subtitle:"Desarrollo de productos.",color:"from-pink-500 to-rose-600",shortcuts:[{label:"Nuevo Producto",icon:tx,path:"/design",color:"bg-pink-100 text-pink-700"},{label:"Catlogo",icon:Jf,path:"/design",color:"bg-purple-100 text-purple-700"},{label:"Materiales",icon:Cs,path:"/materials",color:"bg-amber-100 text-amber-700"},{label:"Produccin",icon:Kf,path:"/production",color:"bg-slate-100 text-slate-700"}]};case"WAREHOUSE":return{title:"Logstica",subtitle:"Control de inventarios.",color:"from-orange-500 to-amber-600",shortcuts:[{label:"Recepcin",icon:ClipboardList,path:"/inventory/reception",color:"bg-orange-100 text-orange-700"},{label:"Inventario",icon:Cs,path:"/materials",color:"bg-emerald-100 text-emerald-700"},{label:"Proveedores",icon:tv,path:"/providers",color:"bg-blue-100 text-blue-700"},{label:"Movimientos",icon:ii,path:"/inventory/movements",color:"bg-slate-100 text-slate-700"}]};case"PRODUCTION":return{title:"Fbrica",subtitle:"Gestin de produccin.",color:"from-blue-600 to-indigo-700",shortcuts:[{label:"rdenes",icon:ClipboardList,path:"/production",color:"bg-blue-100 text-blue-700"},{label:"Materiales",icon:Cs,path:"/materials",color:"bg-slate-100 text-slate-700"}]};case"ADMIN":return{title:"Administracin",subtitle:"Finanzas y Control.",color:"from-indigo-600 to-violet-800",shortcuts:[]};default:return{title:"Direccin General",subtitle:"Cuadro de Mando Integral.",color:"from-slate-800 to-black",shortcuts:[]}}})(),Xe=()=>{const oe=a.getHours();return oe<12?"Buenos das":oe<18?"Buenas tardes":"Buenas noches"},$e=t==="ADMIN"||t==="DIRECTOR",Te=(u==null?void 0:u.total_pending_approval)||0,ce=((u==null?void 0:u.overdue_amount)||0)+((u==null?void 0:u.next_period_amount)||0)+((u==null?void 0:u.future_amount)||0),be=((u==null?void 0:u.overdue_count)||0)+((u==null?void 0:u.next_period_count)||0)+((u==null?void 0:u.future_count)||0);return l.jsxs("div",{className:"min-h-full p-8 space-y-8 animate-in fade-in duration-500 pb-24",children:[l.jsx("div",{className:`rounded-2xl shadow-xl p-8 text-white bg-gradient-to-r ${ke.color} relative overflow-hidden transition-colors duration-500`,children:l.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-end gap-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 text-white/80 text-sm font-medium mb-1",children:[l.jsx(kn,{size:14})," ",a.toLocaleDateString("es-MX",{weekday:"long",day:"numeric",month:"long"})]}),l.jsxs("h1",{className:"text-4xl font-black tracking-tight mb-2",children:[Xe(),", ",l.jsx("span",{className:"opacity-90",children:n})]}),l.jsx("p",{className:"text-white/80 max-w-lg text-lg",children:ke.subtitle})]}),l.jsx("div",{className:"bg-white/20 backdrop-blur-sm p-3 rounded-lg border border-white/10",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Xa,{size:18}),l.jsx("span",{className:"font-mono text-xl font-bold",children:a.toLocaleTimeString("es-MX",{hour:"2-digit",minute:"2-digit"})})]})})]})}),$e?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx("div",{onClick:()=>C("dashboard"),className:"cursor-pointer transition-transform hover:scale-[1.02] active:scale-95",children:l.jsxs(St,{className:`p-4 h-full border-l-4 ${B?"border-l-amber-500 ring-2 ring-amber-100 bg-amber-50/50":"border-l-emerald-500 bg-white shadow-sm"} ${w==="SALES_AUDIT"&&S==="dashboard"?"ring-2 ring-indigo-500":""}`,children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Por Autorizar"}),B?l.jsx(Vn,{size:14,className:"text-amber-500 animate-pulse"}):l.jsx(Xs,{size:14,className:"text-emerald-500"})]}),l.jsxs("div",{className:"flex flex-row items-baseline mt-1",children:[R.length>0&&l.jsx("div",{className:`text-2xl font-black ${B?"text-amber-600/60":"text-emerald-600/60"}`,children:R.length}),l.jsx("div",{className:`ml-auto text-2xl font-black ${B?"text-orange-600":"text-emerald-600"}`,children:xe(W)})]})]})}),l.jsx("div",{onClick:()=>C("history"),className:"cursor-pointer transition-transform hover:scale-[1.02] active:scale-95",children:l.jsxs(St,{className:`p-4 h-full border-l-4 border-l-emerald-500 bg-white shadow-sm ${w==="SALES_AUDIT"&&S==="history"?"ring-2 ring-indigo-500":""}`,children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:["Ventas ",fe]}),l.jsx(fn,{size:14,className:"text-emerald-500"})]}),l.jsxs("div",{className:"flex flex-row items-baseline mt-1",children:[D.length>0&&l.jsx("div",{className:"text-2xl font-black text-emerald-600/50",children:D.length}),l.jsx("div",{className:"ml-auto text-2xl font-black text-emerald-600",children:xe(te)})]})]})}),l.jsx("div",{onClick:U,className:"cursor-pointer transition-transform hover:scale-[1.02] active:scale-95",children:l.jsxs(St,{className:`p-4 h-full border-l-4 border-l-emerald-500 ${w==="RECEIVABLES"?"bg-slate-50 ring-2 ring-indigo-500":"bg-white shadow-sm"}`,children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Cuentas x Cobrar"}),l.jsx(rv,{size:14,className:"text-indigo-400"})]}),l.jsxs("div",{className:"flex flex-row items-baseline mt-1",children:[we.length>0&&l.jsx("div",{className:"text-2xl font-black text-indigo-600/50",children:we.length}),l.jsx("div",{className:"ml-auto text-2xl font-black text-indigo-600",children:xe(Ee)})]})]})}),l.jsx("div",{onClick:z,className:"cursor-pointer transition-transform hover:scale-[1.02] active:scale-95",children:l.jsxs(St,{className:`p-4 h-full border-l-4 border-l-red-500 ${w==="PAYABLES"?"bg-slate-50 ring-2 ring-indigo-500 shadow-md":"bg-white shadow-sm"}`,children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Cuentas x Pagar"}),l.jsx(Qi,{size:14,className:"text-red-500"})]}),l.jsxs("div",{className:"flex flex-row items-baseline mt-1 justify-between w-full",children:[be>0?l.jsx("div",{className:"text-2xl font-black text-red-600/50 animate-pulse",children:be}):l.jsx("div",{}),l.jsx("div",{className:"text-xl font-black text-red-600 text-right",children:xe(ce)})]}),Te>0?l.jsxs("p",{className:"text-[10px] text-red-600 font-bold mt-1 flex items-center gap-1",children:[l.jsx(Vn,{size:10})," ",Te," firmas pendientes!"]}):l.jsxs("p",{className:"text-[10px] text-slate-400 mt-1 flex items-center gap-1",children:[l.jsx(Xs,{size:10})," Sin solicitudes"]})]})})]}),w==="SALES_AUDIT"&&l.jsx("div",{className:"animate-in slide-in-from-top-4 duration-300",children:l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-xl overflow-hidden relative",children:[l.jsx("button",{onClick:()=>_("NONE"),className:"absolute top-2 right-2 p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-full z-20",children:l.jsx(kr,{size:20})}),l.jsxs("div",{className:"p-6",children:[l.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[S==="dashboard"?l.jsx(Vn,{className:"text-amber-500"}):l.jsx(Xs,{className:"text-emerald-500"}),ie()]}),Le.length===0?l.jsx("div",{className:"text-center py-12 bg-slate-50 rounded border border-dashed border-slate-300",children:l.jsx("p",{className:"text-slate-400",children:"No hay registros para mostrar en esta seccin."})}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold text-xs uppercase border-b border-slate-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4",children:"Proyecto"}),l.jsx("th",{className:"px-6 py-4 text-center",children:"Estatus"}),l.jsx("th",{className:"px-6 py-4 text-right",children:"Monto"}),l.jsx("th",{className:"px-6 py-4 text-center",children:"Accin"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:Le.map(oe=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-6 py-4 font-bold",children:oe.project_name}),l.jsx("td",{className:"px-6 py-4 text-center",children:X(oe.status)}),l.jsx("td",{className:"px-6 py-4 text-right",children:xe(oe.total_price)}),l.jsx("td",{className:"px-6 py-4 text-center",children:l.jsx(ot,{size:"sm",variant:"ghost",onClick:()=>I(oe.id),children:"Ver"})})]},oe.id))})]})})]})]})}),w==="PAYABLES"&&u&&l.jsxs("div",{className:"animate-in slide-in-from-top-4 duration-300 relative mt-6 pt-6 border-t border-slate-200",children:[l.jsx("button",{onClick:()=>_("NONE"),className:"absolute -top-3 -right-2 p-2 bg-white shadow-md rounded-full text-slate-400 hover:text-red-500 z-10",children:l.jsx(kr,{size:20})}),Te>0&&l.jsxs("div",{className:"mb-6 bg-gradient-to-r from-indigo-600 to-violet-700 rounded-xl p-6 text-white shadow-lg flex items-center justify-between animate-pulse-slow",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xl font-black flex items-center gap-2",children:[l.jsx(As,{})," Firmas Requeridas"]}),l.jsxs("p",{className:"opacity-90",children:["Tienes ",Te," solicitudes de pago."]})]}),l.jsx(ot,{className:"bg-white !text-indigo-700 hover:!bg-indigo-700 hover:!text-white transition-colors font-bold border-none shadow-sm",onClick:()=>L(!0),children:"Revisar Solicitudes"})]}),l.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-medium mb-4",children:[l.jsx(Qi,{size:18})," ",l.jsx("span",{children:"Flujo de Efectivo: Seleccione una tarjeta para auditar"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsx(St,{onClick:()=>g("THIS_FRIDAY"),className:`p-6 cursor-pointer border transition-all group relative overflow-hidden ${x==="THIS_FRIDAY"?"bg-gradient-to-br from-red-600 to-red-700 text-white shadow-xl scale-105 border-transparent":"bg-white border-slate-200 hover:border-red-400 hover:shadow-md"}`,children:l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsxs("span",{className:`text-xs font-bold uppercase tracking-wider ${x==="THIS_FRIDAY"?"text-red-100":"text-red-600"}`,children:[l.jsx(Vn,{className:"inline mr-1 mb-1",size:14})," Pago Inmediato"]})}),l.jsx("p",{className:`text-sm mb-2 ${x==="THIS_FRIDAY"?"text-red-100":"text-slate-400"}`,children:"Vencido + Este Viernes"}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsx("div",{className:`text-xl font-bold leading-none ${x==="THIS_FRIDAY"?"text-red-200":"text-slate-300"}`,children:u.overdue_count||0}),l.jsx("div",{className:`text-xl font-black text-right ${x==="THIS_FRIDAY"?"text-white":"text-slate-800"}`,children:xe(u.overdue_amount)})]})]})}),l.jsx(St,{onClick:()=>g("NEXT_15_DAYS"),className:`p-6 cursor-pointer border transition-all group relative overflow-hidden ${x==="NEXT_15_DAYS"?"bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-xl scale-105 border-transparent":"bg-white border-slate-200 hover:border-orange-400 hover:shadow-md"}`,children:l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsxs("span",{className:`text-xs font-bold uppercase tracking-wider ${x==="NEXT_15_DAYS"?"text-orange-100":"text-orange-600"}`,children:[l.jsx(kn,{className:"inline mr-1 mb-1",size:14})," Proyeccin Corta"]})}),l.jsx("p",{className:`text-sm mb-2 ${x==="NEXT_15_DAYS"?"text-orange-100":"text-slate-400"}`,children:"Siguientes 15 Das"}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsx("div",{className:`text-xl font-bold leading-none ${x==="NEXT_15_DAYS"?"text-orange-200":"text-slate-300"}`,children:u.next_period_count||0}),l.jsx("div",{className:`text-xl font-black text-right ${x==="NEXT_15_DAYS"?"text-white":"text-slate-800"}`,children:xe(u.next_period_amount)})]})]})}),l.jsx(St,{onClick:()=>g("FUTURE"),className:`p-6 cursor-pointer border transition-all group relative overflow-hidden ${x==="FUTURE"?"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white shadow-xl scale-105 border-transparent":"bg-white border-slate-200 hover:border-emerald-400 hover:shadow-md"}`,children:l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsxs("span",{className:`text-xs font-bold uppercase tracking-wider ${x==="FUTURE"?"text-emerald-100":"text-emerald-600"}`,children:[l.jsx(Xs,{className:"inline mr-1 mb-1",size:14})," Largo Plazo"]})}),l.jsx("p",{className:`text-sm mb-2 ${x==="FUTURE"?"text-emerald-100":"text-slate-400"}`,children:"Vencimientos Futuros"}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsx("div",{className:`text-xl font-bold leading-none ${x==="FUTURE"?"text-emerald-200":"text-slate-300"}`,children:u.future_count||0}),l.jsx("div",{className:`text-xl font-black text-right ${x==="FUTURE"?"text-white":"text-slate-800"}`,children:xe(u.future_amount)})]})]})})]}),x&&l.jsxs("div",{className:"animate-fadeInUp bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden mt-8",children:[l.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-200 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-700 flex items-center gap-2",children:[l.jsx(q1,{size:18,className:"text-slate-400"})," Auditora:",l.jsx("span",{className:`uppercase ml-1 font-black px-2 py-0.5 rounded text-sm ${x==="THIS_FRIDAY"?"bg-red-100 text-red-700":x==="NEXT_15_DAYS"?"bg-orange-100 text-orange-700":"bg-emerald-100 text-emerald-700"}`,children:x==="THIS_FRIDAY"?"Pago Inmediato":x==="NEXT_15_DAYS"?"Proyeccin 15 Das":"Futuros"})]}),l.jsxs(la,{variant:"secondary",children:[G.length," Documentos"]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"text-xs text-slate-500 uppercase bg-slate-50 border-b border-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4",children:"Proveedor"}),l.jsx("th",{className:"px-6 py-4",children:"Factura"}),l.jsx("th",{className:"px-6 py-4",children:"Vencimiento"}),l.jsx("th",{className:"px-6 py-4 text-right",children:"Saldo"}),l.jsx("th",{className:"px-6 py-4 text-center",children:"Accin"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:p?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"text-center py-12 text-slate-400",children:"Cargando datos..."})}):G.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"text-center py-12 text-slate-400 italic",children:"No hay documentos pendientes."})}):G.map(oe=>l.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4 font-bold text-slate-700",children:oe.provider_name}),l.jsx("td",{className:"px-6 py-4 font-mono text-slate-500",children:oe.invoice_number}),l.jsx("td",{className:"px-6 py-4 text-slate-600",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(kn,{size:14,className:"text-slate-400"}),pe(oe.due_date)]})}),l.jsx("td",{className:"px-6 py-4 text-right font-black text-slate-800",children:xe(oe.outstanding_balance)}),l.jsx("td",{className:"px-6 py-4 text-center",children:l.jsxs(ot,{size:"sm",className:"bg-indigo-600 hover:bg-indigo-700 text-white",onClick:()=>v(oe),children:[l.jsx(Cl,{size:16,className:"mr-1"})," Autorizar"]})})]},oe.id))})]})})]})]})]}):l.jsxs("div",{children:[l.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[l.jsx(Ec,{size:18,className:"text-slate-400"})," Accesos Directos"]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:ke.shortcuts.map((oe,A)=>l.jsxs("button",{onClick:()=>e(oe.path),className:"group bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300 text-left",children:[l.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center mb-4 ${oe.color} group-hover:scale-110 transition-transform`,children:l.jsx(oe.icon,{size:24})}),l.jsx("h3",{className:"font-bold text-slate-800 text-lg group-hover:text-indigo-600 transition-colors",children:oe.label}),l.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["Ir a ",oe.label.toLowerCase()]})]},A))})]}),N&&l.jsx(D4,{orderId:N,onClose:()=>I(null),onOrderUpdated:()=>{I(null),c()}}),y&&l.jsx(bv,{invoice:y,onClose:()=>v(null),onSubmit:J}),M&&l.jsx(O4,{onClose:()=>L(!1),onUpdate:()=>{c(),_r.getPayableDashboardStats().then(d)}})]})};function P4(){On();const[e,t]=b.useState(""),[r,n]=b.useState(""),[s,a]=b.useState(!1),[i,o]=b.useState(null),c=async u=>{var d,h;u.preventDefault(),o(null),a(!0);try{const f=`username=${encodeURIComponent(e)}&password=${encodeURIComponent(r)}`,{data:p}=await Oe.post("/login/access-token",f,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});console.log("Login Exitoso:",p),localStorage.setItem("token",p.access_token);const m=p.role||"ADMIN";localStorage.setItem("user_role",m),p.user_id?localStorage.setItem("user_id",String(p.user_id)):localStorage.setItem("user_id","1"),localStorage.setItem("user_name",p.full_name||e.split("@")[0]),window.location.href="/"}catch(f){if(console.error("Error Login:",f),e.includes("demo")||e.includes("ventas")){localStorage.setItem("token","fake-token"),localStorage.setItem("user_role",e.includes("ventas")?"SALES":"ADMIN"),localStorage.setItem("user_id","1"),localStorage.setItem("user_name","Usuario Simulado"),window.location.href="/";return}const p=((h=(d=f.response)==null?void 0:d.data)==null?void 0:h.detail)||"No se pudo conectar. Verifica tu contrasea.";o(p)}finally{a(!1)}};return l.jsxs("div",{className:"min-h-screen w-full flex bg-white font-sans text-slate-900",children:[l.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-slate-900 relative items-center justify-center overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/90 to-slate-900/90 z-10"}),l.jsx("img",{src:"https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?q=80&w=2070&auto=format&fit=crop",alt:"Fbrica",className:"absolute inset-0 w-full h-full object-cover grayscale opacity-50"}),l.jsxs("div",{className:"relative z-20 text-white p-12 max-w-xl text-center lg:text-left",children:[l.jsx("div",{className:"mb-6 inline-flex p-3 bg-white/10 rounded-xl backdrop-blur-sm border border-white/20",children:l.jsx(BE,{size:32,className:"text-indigo-400"})}),l.jsxs("div",{className:"flex flex-col items-start gap-1 mb-6",children:[l.jsxs("div",{className:"flex items-baseline gap-2",children:[l.jsx("span",{className:"font-serif italic text-6xl text-white font-medium tracking-wide",children:"Valentina"}),l.jsx("span",{className:"text-lg text-slate-400 font-sans tracking-normal font-normal",children:"Software"})]}),l.jsx("p",{className:"text-sm text-slate-400 font-mono mt-1 tracking-tight uppercase pl-1",children:"Sistema de Produccin v3.0"})]})]})]}),l.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8 bg-slate-50",children:l.jsxs("div",{className:"w-full max-w-md space-y-8 bg-white p-10 rounded-2xl shadow-xl border border-slate-100",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Iniciar Sesin"}),l.jsx("p",{className:"mt-2 text-slate-500 text-sm",children:"Ingresa tus credenciales operativas"})]}),i&&l.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg text-sm flex items-start gap-3 border border-red-100 animate-in fade-in slide-in-from-top-2",children:[l.jsx(Nl,{size:18,className:"shrink-0 mt-0.5"}),l.jsx("span",{children:i})]}),l.jsxs("form",{className:"space-y-6",onSubmit:c,children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase mb-1 block",children:"Correo Electrnico"}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute left-3 top-3 text-slate-400",children:l.jsx(iu,{size:18})}),l.jsx("input",{type:"text",required:!0,className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all font-medium text-slate-700 text-sm",placeholder:"usuario@sgp.com",value:e,onChange:u=>t(u.target.value)})]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"flex justify-between items-center mb-1",children:l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Contrasea"})}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute left-3 top-3 text-slate-400",children:l.jsx(aa,{size:18})}),l.jsx("input",{type:"password",required:!0,className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all font-medium text-slate-700 text-sm",placeholder:"",value:r,onChange:u=>n(u.target.value)})]})]})]}),l.jsx("button",{type:"submit",disabled:s,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg shadow-lg shadow-indigo-200 flex items-center justify-center gap-2 transition-all transform active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed",children:s?l.jsx(Qf,{className:"animate-spin",size:20}):l.jsxs(l.Fragment,{children:["Ingresar ",l.jsx(wc,{size:20})]})})]}),l.jsxs("div",{className:"pt-6 border-t border-slate-100 text-center",children:[l.jsx("p",{className:"text-[10px] text-slate-400 uppercase tracking-widest mb-2",children:"Ambiente de Pruebas"}),l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:l.jsx("span",{className:"text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-500",children:"admin@valentina.com"})})]})]})})]})}function L4(){const[e,t]=b.useState([]),[r,n]=b.useState(!1),[s,a]=b.useState(null),i=b.useCallback(async()=>{n(!0);try{const d=await Oe.get("/auth/users/");t(d.data),a(null)}catch(d){console.error(d),a("Error al cargar usuarios.")}finally{n(!1)}},[]),o=async d=>{var h,f,p;try{return await Oe.post("/auth/users/",d),await i(),{success:!0}}catch(m){return console.error("Error creating user:",(h=m.response)==null?void 0:h.data),{success:!1,error:((p=(f=m.response)==null?void 0:f.data)==null?void 0:p.detail)||"Error al crear usuario"}}},c=async(d,h)=>{var f,p;try{return await Oe.put(`/auth/users/${d}`,h),await i(),{success:!0}}catch(m){return console.error("Error updating user:",m),{success:!1,error:((p=(f=m.response)==null?void 0:f.data)==null?void 0:p.detail)||"Error al actualizar"}}},u=async d=>{var h,f;try{return await Oe.delete(`/auth/users/${d}`),await i(),{success:!0}}catch(p){return console.error("Error deleting user:",p),{success:!1,error:((f=(h=p.response)==null?void 0:h.data)==null?void 0:f.detail)||"Error al eliminar"}}};return b.useEffect(()=>{i()},[i]),{users:e,loading:r,error:s,fetchUsers:i,createUser:o,updateUser:c,deleteUser:u}}const yx={DIRECTOR:"DIRECCIN",ADMIN:"ADMINISTRACIN",SALES:"VENTAS",DESIGN:"DISEO",WAREHOUSE:"ALMACN",PRODUCTION:"PRODUCCIN"};function M4(){const{users:e,loading:t,createUser:r,updateUser:n,deleteUser:s,fetchUsers:a}=L4(),[i,o]=b.useState(!1),[c,u]=b.useState(!1),[d,h]=b.useState(null),f={full_name:"",email:"",password:"",role:"SALES",is_active:!0,commission_rate:0},[p,m]=b.useState(f),x=S=>{switch(S){case"DIRECTOR":return"bg-slate-900 text-white border-slate-700";case"ADMIN":return"bg-indigo-100 text-indigo-700 border-indigo-200";case"SALES":return"bg-emerald-100 text-emerald-700 border-emerald-200";case"DESIGN":return"bg-pink-100 text-pink-700 border-pink-200";case"WAREHOUSE":return"bg-orange-100 text-orange-800 border-orange-200";case"PRODUCTION":return"bg-blue-100 text-blue-700 border-blue-200";default:return"bg-slate-100 text-slate-700 border-slate-200"}},g=S=>{switch(S){case"DIRECTOR":return l.jsx(Ec,{size:12});case"ADMIN":return l.jsx(Xf,{size:12});case"SALES":return l.jsx(ks,{size:12});case"DESIGN":return l.jsx(Jf,{size:12});case"WAREHOUSE":return l.jsx(Cs,{size:12});case"PRODUCTION":return l.jsx(Y1,{size:12});default:return l.jsx(Go,{size:12})}},y=S=>{m({full_name:S.full_name,email:S.email,password:"",role:S.role,is_active:S.is_active,commission_rate:S.commission_rate||0}),h(S.id),u(!0),o(!0)},v=async S=>{confirm(" Ests seguro de eliminar este usuario permanentemente?")&&await s(S)},w=async S=>{if(S.preventDefault(),!p.full_name||!p.email){alert("Nombre y Email son obligatorios");return}let P;const N={...p};if(N.commission_rate=parseFloat(N.commission_rate.toString()),c&&d)N.password||delete N.password,P=await n(d,N);else{if(!p.password){alert("La contrasea es obligatoria para nuevos usuarios");return}P=await r(N)}P.success?_():alert(`Error: ${P.error}`)},_=()=>{m(f),u(!1),h(null),o(!1)};return l.jsxs("div",{className:"space-y-6 p-6 pb-24 animate-in fade-in duration-500",children:[l.jsxs("div",{className:"flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border border-slate-100",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Go,{className:"text-indigo-600"})," Gestin de Usuarios"]}),l.jsx("p",{className:"text-slate-500 text-sm",children:"Control de acceso y roles del personal."})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:a,className:"p-2.5 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Refrescar lista",children:l.jsx(Sc,{size:20})}),l.jsxs("button",{onClick:()=>{_(),o(!0)},className:"flex items-center gap-2 bg-indigo-600 text-white px-5 py-2.5 rounded-lg hover:bg-indigo-700 shadow-md font-medium transition-all",children:[l.jsx(xr,{size:18})," Nuevo Usuario"]})]})]}),i&&l.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[l.jsxs("div",{className:"bg-indigo-50 p-4 border-b border-indigo-100 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-indigo-900 flex items-center gap-2",children:[c?l.jsx(js,{size:18}):l.jsx(xr,{size:18}),c?"Editar Usuario":"Registrar Usuario"]}),l.jsx("button",{onClick:_,className:"text-slate-400 hover:text-red-500 transition-colors",children:l.jsx(kr,{size:20})})]}),l.jsxs("form",{onSubmit:w,className:"p-6 space-y-5",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Nombre Completo"}),l.jsxs("div",{className:"relative mt-1",children:[l.jsx(Go,{size:18,className:"absolute left-3 top-2.5 text-slate-400"}),l.jsx("input",{className:"w-full pl-10 p-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"Ej. Juan Prez",value:p.full_name,onChange:S=>m({...p,full_name:S.target.value}),autoFocus:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Correo Electrnico"}),l.jsxs("div",{className:"relative mt-1",children:[l.jsx(iu,{size:18,className:"absolute left-3 top-2.5 text-slate-400"}),l.jsx("input",{type:"email",className:"w-full pl-10 p-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"usuario@empresa.com",value:p.email,onChange:S=>m({...p,email:S.target.value})})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:p.role==="SALES"?"":"col-span-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Rol"}),l.jsxs("div",{className:"relative mt-1",children:[l.jsx(Ec,{size:18,className:"absolute left-3 top-2.5 text-slate-400"}),l.jsx("select",{className:"w-full pl-10 p-2.5 border border-slate-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 outline-none",value:p.role,onChange:S=>m({...p,role:S.target.value}),children:Object.entries(yx).map(([S,P])=>l.jsx("option",{value:S,children:P},S))})]})]}),p.role==="SALES"&&l.jsxs("div",{className:"animate-in fade-in slide-in-from-left-4 duration-300",children:[l.jsx("label",{className:"text-xs font-bold text-emerald-600 uppercase tracking-wide",children:"Comisin (%)"}),l.jsxs("div",{className:"relative mt-1",children:[l.jsx(Tl,{size:18,className:"absolute left-3 top-2.5 text-emerald-500"}),l.jsx("input",{type:"number",step:"0.1",min:"0",max:"100",className:"w-full pl-10 p-2.5 bg-emerald-50 border border-emerald-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:bg-white transition-all outline-none font-bold text-emerald-700",placeholder:"0.0",value:p.commission_rate,onChange:S=>m({...p,commission_rate:parseFloat(S.target.value)})})]})]})]}),l.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-100",children:[l.jsxs("label",{className:"text-xs font-bold text-orange-800 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(ME,{size:14})," ",c?"Cambiar Contrasea":"Contrasea Inicial"]}),l.jsx("input",{type:"text",className:"w-full mt-2 p-2.5 border border-orange-200 rounded-lg focus:ring-2 focus:ring-orange-200 outline-none bg-white",placeholder:c?"Dejar vaco para mantener":"Mnimo 4 caracteres",value:p.password,onChange:S=>m({...p,password:S.target.value})})]}),l.jsxs("div",{className:"flex gap-3 pt-2",children:[l.jsx("button",{type:"button",onClick:_,className:"flex-1 py-2.5 text-slate-600 font-semibold hover:bg-slate-100 rounded-lg transition-colors",children:"Cancelar"}),l.jsx("button",{type:"submit",className:"flex-1 py-2.5 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 shadow-lg shadow-indigo-200 transition-all",children:c?"Actualizar":"Guardar"})]})]})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:l.jsxs("table",{className:"w-full text-left",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase",children:"ID"}),l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase",children:"Usuario"}),l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase",children:"Rol"}),l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase text-center",children:"Estado"}),l.jsx("th",{className:"px-6 py-4 text-right",children:"Acciones"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:t?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"p-8 text-center text-slate-400",children:"Cargando usuarios..."})}):e.map(S=>l.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[l.jsxs("td",{className:"px-6 py-4 text-slate-400 text-xs font-mono",children:["#",S.id]}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("span",{className:"font-semibold text-slate-900 text-sm flex items-center gap-2",children:[S.full_name,S.role==="SALES"&&l.jsxs("span",{className:"text-[10px] bg-emerald-100 text-emerald-700 px-1.5 py-0.5 rounded border border-emerald-200 font-bold font-mono flex items-center gap-0.5",children:[l.jsx(Tl,{size:8})," ",S.commission_rate,"%"]})]}),l.jsx("span",{className:"text-xs text-slate-500",children:S.email})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded border text-[10px] font-bold uppercase tracking-wide ${x(S.role)}`,children:[g(S.role),yx[S.role]||S.role]})}),l.jsx("td",{className:"px-6 py-4 text-center",children:S.is_active?l.jsxs("span",{className:"inline-flex items-center gap-1 text-green-600 text-[10px] font-bold bg-green-50 px-2 py-0.5 rounded-full border border-green-100",children:[l.jsx(Xs,{size:10})," ACTIVO"]}):l.jsx("span",{className:"text-slate-400 text-[10px] font-medium bg-slate-50 px-2 py-0.5 rounded-full border border-slate-100",children:"INACTIVO"})}),l.jsxs("td",{className:"px-6 py-4 text-right flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>y(S),className:"p-2 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Editar",children:l.jsx(js,{size:16})}),l.jsx("button",{onClick:()=>S.id&&v(S.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar",children:l.jsx(Rn,{size:16})})]})]},S.id))})]})})]})}const Av=()=>{const[e,t]=b.useState([]),[r,n]=b.useState(!1),s="/foundations/materials",a=b.useCallback(async()=>{n(!0);try{const{data:u}=await Oe.get(s);Array.isArray(u)?t(u):(console.warn("API Materiales no devolvi un array:",u),t([]))}catch(u){console.error("Error cargando materiales:",u),t([])}finally{n(!1)}},[]);return b.useEffect(()=>{a()},[a]),{materials:e,loading:r,fetchMaterials:a,createMaterial:async u=>{var d,h;try{return await Oe.post(s,u),await a(),{success:!0}}catch(f){return{success:!1,error:((h=(d=f.response)==null?void 0:d.data)==null?void 0:h.detail)||"Error desconocido"}}},updateMaterial:async(u,d)=>{var h,f;try{return await Oe.put(`${s}/${u}`,d),await a(),{success:!0}}catch(p){return{success:!1,error:((f=(h=p.response)==null?void 0:h.data)==null?void 0:f.detail)||"Error desconocido"}}},deleteMaterial:async u=>{try{return await Oe.delete(`${s}/${u}`),await a(),{success:!0}}catch{return{success:!1,error:"Error al eliminar"}}}}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Cc={};Cc.version="0.18.5";var jv=1252,B4=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],kv=function(e){B4.indexOf(e)!=-1&&(jv=e)};function U4(){kv(1252)}var Al=function(e){kv(e)};function z4(){Al(1200),U4()}var So=function(t){return String.fromCharCode(t)},wx=function(t){return String.fromCharCode(t)},Tc,hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jl(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=hs.charAt(a)+hs.charAt(i)+hs.charAt(o)+hs.charAt(c);return t}function Qn(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=hs.indexOf(e.charAt(u++)),i=hs.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=hs.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=hs.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),es=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function oa(e){return Qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function _x(e){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var un=function(t){return Qe?es(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function xu(e){if(typeof ArrayBuffer>"u")return un(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Hl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function V4(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Wt=Qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:es(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function $4(e){for(var t=[],r=0,n=e.length+250,s=oa(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=oa(65535),n=65530)}return t.push(s.slice(0,r)),Wt(t)}var Ji=/\u0000/g,Eo=/[\u0001-\u0006]/g;function qa(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function hn(e,t){var r=""+e;return r.length>=t?r:_t("0",t-r.length)+r}function ah(e,t){var r=""+e;return r.length>=t?r:_t(" ",t-r.length)+r}function bc(e,t){var r=""+e;return r.length>=t?r:r+_t(" ",t-r.length)}function H4(e,t){var r=""+Math.round(e);return r.length>=t?r:_t("0",t-r.length)+r}function G4(e,t){var r=""+e;return r.length>=t?r:_t("0",t-r.length)+r}var Sx=Math.pow(2,32);function _a(e,t){if(e>Sx||e<-Sx)return H4(e,t);var r=Math.round(e);return G4(r,t)}function Ac(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Ex=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],i0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function W4(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Nx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},X4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jc(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,u=0,d=0,h=Math.floor(s);u<t&&(h=Math.floor(s),o=h*i+a,d=h*u+c,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=a):(d=u,o=i)),!r)return[0,n*o,d];var f=Math.floor(n*o/d);return[f,n*o-f*d,d]}function No(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=eC(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var Rv=new Date(1899,11,31,0,0,0),q4=Rv.getTime(),Y4=new Date(1900,2,1,0,0,0);function Fv(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Y4&&(r+=24*60*60*1e3),(r-(q4+(e.getTimezoneOffset()-Rv.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ih(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function K4(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Q4(e){var t=e<0?12:11,r=ih(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function J4(e){var t=ih(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Z4(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Q4(e):t===10?r=e.toFixed(10).substr(0,12):r=J4(e),ih(K4(r.toUpperCase()))}function Dd(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Z4(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Rs(14,Fv(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function eC(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function tC(e,t,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return i0[r.m-1][1];case 5:return i0[r.m-1][0];default:return i0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Ex[r.q][0];default:return Ex[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?hn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=hn(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?hn(c,u):"";return d}function ps(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Dv=/%/g;function rC(e,t,r){var n=t.replace(Dv,""),s=t.length-n.length;return Hn(e,n,r*Math.pow(10,2*s))+_t("%",s)}function nC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Hn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Ov(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Ov(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Iv=/# (\?+)( ?)\/( ?)(\d+)/;function sC(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?_t(" ",e[1].length+1+e[4].length):ah(i,e[1].length)+e[2]+"/"+e[3]+hn(o,e[4].length))}function aC(e,t,r){return r+(t===0?"":""+t)+_t(" ",e[1].length+2+e[4].length)}var Pv=/^#*0*\.([0#]+)/,Lv=/\).*[0#]/,Mv=/\(###\) ###\\?-####/;function cr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Cx(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Tx(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function iC(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function lC(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Wr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Lv)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wr("n",n,r):"("+Wr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return nC(e,t,r);if(t.indexOf("%")!==-1)return rC(e,t,r);if(t.indexOf("E")!==-1)return Ov(t,r);if(t.charCodeAt(0)===36)return"$"+Wr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+_a(c,t.length);if(t.match(/^[#?]+$/))return s=_a(r,0),s==="0"&&(s=""),s.length>t.length?s:cr(t.substr(0,t.length-s.length))+s;if(a=t.match(Iv))return sC(a,c,u);if(t.match(/^#+0+$/))return u+_a(c,t.length-t.indexOf("0"));if(a=t.match(Pv))return s=Cx(r,a[1].length).replace(/^([^\.]+)$/,"$1."+cr(a[1])).replace(/\.$/,"."+cr(a[1])).replace(/\.(\d*)$/,function(m,x){return"."+x+_t("0",cr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+Cx(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+ps(_a(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wr(e,t,-r):ps(""+(Math.floor(r)+iC(r,a[1].length)))+"."+hn(Tx(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Wr(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qa(Wr(e,t.replace(/[\\-]/g,""),r)),i=0,qa(qa(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(Mv))return s=Wr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=jc(c,Math.pow(10,i)-1,!1),s=""+u,d=Hn("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=bc(o[2],i),d.length<a[4].length&&(d=cr(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=jc(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ah(o[1],i)+a[2]+"/"+a[3]+bc(o[2],i):_t(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=_a(r,0),t.length<=s.length?s:cr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,f=t.length-s.length-h;return cr(t.substr(0,h)+s+t.substr(t.length-f))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=Tx(r,a[1].length),r<0?"-"+Wr(e,t,-r):ps(lC(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?hn(0,3-m.length):"")+m})+"."+hn(i,a[1].length);switch(t){case"###,##0.00":return Wr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=ps(_a(c,0));return p!=="0"?u+p:"";case"###,###.00":return Wr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function oC(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Hn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function cC(e,t,r){var n=t.replace(Dv,""),s=t.length-n.length;return Hn(e,n,r*Math.pow(10,2*s))+_t("%",s)}function Bv(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Bv(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function En(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Lv)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?En("n",n,r):"("+En("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return oC(e,t,r);if(t.indexOf("%")!==-1)return cC(e,t,r);if(t.indexOf("E")!==-1)return Bv(t,r);if(t.charCodeAt(0)===36)return"$"+En(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+hn(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:cr(t.substr(0,t.length-s.length))+s;if(a=t.match(Iv))return aC(a,c,u);if(t.match(/^#+0+$/))return u+hn(c,t.length-t.indexOf("0"));if(a=t.match(Pv))return s=(""+r).replace(/^([^\.]+)$/,"$1."+cr(a[1])).replace(/\.$/,"."+cr(a[1])),s=s.replace(/\.(\d*)$/,function(m,x){return"."+x+_t("0",cr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+ps(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+En(e,t,-r):ps(""+r)+"."+_t("0",a[1].length);if(a=t.match(/^#,#*,#0/))return En(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qa(En(e,t.replace(/[\\-]/g,""),r)),i=0,qa(qa(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(Mv))return s=En(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=jc(c,Math.pow(10,i)-1,!1),s=""+u,d=Hn("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=bc(o[2],i),d.length<a[4].length&&(d=cr(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=jc(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ah(o[1],i)+a[2]+"/"+a[3]+bc(o[2],i):_t(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:cr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,f=t.length-s.length-h;return cr(t.substr(0,h)+s+t.substr(t.length-f))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+En(e,t,-r):ps(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?hn(0,3-m.length):"")+m})+"."+hn(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=ps(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return En(e,t.slice(0,t.lastIndexOf(".")),r)+cr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Hn(e,t,r){return(r|0)===r?En(e,t,r):Wr(e,t,r)}function uC(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Uv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zv(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Ac(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Uv))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function dC(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",u,d,h,f="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Ac(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),m=p==="("||p===")"?p:"t";s[s.length]={t:m,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=No(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=No(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=No(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",f="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",i+=5,f="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",i+=5,f="h"):(x.t="t",++i),u==null&&x.t==="T")return"";s[s.length]=x,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Uv)){if(u==null&&(u=No(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",zv(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var g=0,y=0,v;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=f,c="h",g<1&&(g=1);break;case"s":(v=s[i].v.match(/\.0+$/))&&(y=Math.max(y,v[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[i].v.match(/[Hh]/)&&(g=1),g<2&&s[i].v.match(/[Mm]/)&&(g=2),g<3&&s[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",_;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=tC(s[i].t.charCodeAt(0),s[i].v,u,y),s[i].t="t";break;case"n":case"?":for(_=i+1;s[_]!=null&&((o=s[_].t)==="?"||o==="D"||(o===" "||o==="t")&&s[_+1]!=null&&(s[_+1].t==="?"||s[_+1].t==="t"&&s[_+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[_].v==="/"||s[_].v===" "&&s[_+1]!=null&&s[_+1].t=="?"));)s[i].v+=s[_].v,s[_]={v:"",t:";"},++_;w+=s[i].v,i=_-1;break;case"G":s[i].t="t",s[i].v=Dd(t,r);break}var S="",P,N;if(w.length>0){w.charCodeAt(0)==40?(P=t<0&&w.charCodeAt(0)===45?-t:t,N=Hn("n",w,P)):(P=t<0&&n>1?-t:t,N=Hn("n",w,P),P<0&&s[0]&&s[0].t=="t"&&(N=N.substr(1),s[0].v="-"+s[0].v)),_=N.length-1;var I=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){I=i;break}var M=s.length;if(I===s.length&&N.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(_>=s[i].v.length-1?(_-=s[i].v.length,s[i].v=N.substr(_+1,s[i].v.length)):_<0?s[i].v="":(s[i].v=N.substr(0,_+1),_=-1),s[i].t="t",M=i);_>=0&&M<s.length&&(s[M].v=N.substr(0,_+1)+s[M].v)}else if(I!==s.length&&N.indexOf("E")===-1){for(_=N.indexOf(".")-1,i=I;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===I?s[i].v.indexOf(".")-1:s[i].v.length-1,S=s[i].v.substr(d+1);d>=0;--d)_>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(S=N.charAt(_--)+S);s[i].v=S,s[i].t="t",M=i}for(_>=0&&M<s.length&&(s[M].v=N.substr(0,_+1)+s[M].v),_=N.indexOf(".")+1,i=I;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==I)){for(d=s[i].v.indexOf(".")>-1&&i===I?s[i].v.indexOf(".")+1:0,S=s[i].v.substr(0,d);d<s[i].v.length;++d)_<N.length&&(S+=N.charAt(_++));s[i].v=S,s[i].t="t",M=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(P=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Hn(s[i].t,s[i].v,P),s[i].t="t");var L="";for(i=0;i!==s.length;++i)s[i]!=null&&(L+=s[i].v);return L}var bx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ax(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function fC(e,t){var r=uC(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(bx),o=r[1].match(bx);return Ax(t,i)?[n,r[0]]:Ax(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Rs(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Et)[e],n==null&&(n=r.table&&r.table[Nx[e]]||Et[Nx[e]]),n==null&&(n=X4[e]||"General");break}if(Ac(n,0))return Dd(t,r);t instanceof Date&&(t=Fv(t,r.date1904));var s=fC(n,t);if(Ac(s[1]))return Dd(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return dC(s[1],t,r,s[0])}function Vv(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Et[r]==null){t<0&&(t=r);continue}if(Et[r]==e){t=r;break}}t<0&&(t=391)}return Et[t]=e,t}function mu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Vv(e[t],t)}function gu(){Et=W4()}var $v=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function hC(e){var t=typeof e=="number"?Et[e]:e;return t=t.replace($v,"(\\d+)"),new RegExp("^"+t+"$")}function pC(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match($v)||[]).forEach(function(h,f){var p=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var xC=function(){var e={};e.version="1.2.0";function t(){for(var N=0,I=new Array(256),M=0;M!=256;++M)N=M,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,I[M]=N;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function n(N){var I=0,M=0,L=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)X[L]=N[L];for(L=0;L!=256;++L)for(M=N[L],I=256+L;I<4096;I+=256)M=X[I]=M>>>8^N[M&255];var C=[];for(L=1;L!=16;++L)C[L-1]=typeof Int32Array<"u"?X.subarray(L*256,L*256+256):X.slice(L*256,L*256+256);return C}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],d=s[5],h=s[6],f=s[7],p=s[8],m=s[9],x=s[10],g=s[11],y=s[12],v=s[13],w=s[14];function _(N,I){for(var M=I^-1,L=0,X=N.length;L<X;)M=M>>>8^r[(M^N.charCodeAt(L++))&255];return~M}function S(N,I){for(var M=I^-1,L=N.length-15,X=0;X<L;)M=w[N[X++]^M&255]^v[N[X++]^M>>8&255]^y[N[X++]^M>>16&255]^g[N[X++]^M>>>24]^x[N[X++]]^m[N[X++]]^p[N[X++]]^f[N[X++]]^h[N[X++]]^d[N[X++]]^u[N[X++]]^c[N[X++]]^o[N[X++]]^i[N[X++]]^a[N[X++]]^r[N[X++]];for(L+=15;X<L;)M=M>>>8^r[(M^N[X++])&255];return~M}function P(N,I){for(var M=I^-1,L=0,X=N.length,C=0,U=0;L<X;)C=N.charCodeAt(L++),C<128?M=M>>>8^r[(M^C)&255]:C<2048?(M=M>>>8^r[(M^(192|C>>6&31))&255],M=M>>>8^r[(M^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,U=N.charCodeAt(L++)&1023,M=M>>>8^r[(M^(240|C>>8&7))&255],M=M>>>8^r[(M^(128|C>>2&63))&255],M=M>>>8^r[(M^(128|U>>6&15|(C&3)<<4))&255],M=M>>>8^r[(M^(128|U&63))&255]):(M=M>>>8^r[(M^(224|C>>12&15))&255],M=M>>>8^r[(M^(128|C>>6&63))&255],M=M>>>8^r[(M^(128|C&63))&255]);return~M}return e.table=r,e.bstr=_,e.buf=S,e.str=P,e}(),nt=function(){var t={};t.version="1.2.1";function r(E,k){for(var T=E.split("/"),j=k.split("/"),F=0,O=0,K=Math.min(T.length,j.length);F<K;++F){if(O=T[F].length-j[F].length)return O;if(T[F]!=j[F])return T[F]<j[F]?-1:1}return T.length-j.length}function n(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:n(E.slice(0,-1));var k=E.lastIndexOf("/");return k===-1?E:E.slice(0,k+1)}function s(E){if(E.charAt(E.length-1)=="/")return s(E.slice(0,-1));var k=E.lastIndexOf("/");return k===-1?E:E.slice(k+1)}function a(E,k){typeof k=="string"&&(k=new Date(k));var T=k.getHours();T=T<<6|k.getMinutes(),T=T<<5|k.getSeconds()>>>1,E.write_shift(2,T);var j=k.getFullYear()-1980;j=j<<4|k.getMonth()+1,j=j<<5|k.getDate(),E.write_shift(2,j)}function i(E){var k=E.read_shift(2)&65535,T=E.read_shift(2)&65535,j=new Date,F=T&31;T>>>=5;var O=T&15;T>>>=4,j.setMilliseconds(0),j.setFullYear(T+1980),j.setMonth(O-1),j.setDate(F);var K=k&31;k>>>=5;var ae=k&63;return k>>>=6,j.setHours(k),j.setMinutes(ae),j.setSeconds(K<<1),j}function o(E){Ir(E,0);for(var k={},T=0;E.l<=E.length-4;){var j=E.read_shift(2),F=E.read_shift(2),O=E.l+F,K={};switch(j){case 21589:T=E.read_shift(1),T&1&&(K.mtime=E.read_shift(4)),F>5&&(T&2&&(K.atime=E.read_shift(4)),T&4&&(K.ctime=E.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}E.l=O,k[j]=K}return k}var c;function u(){return c||(c={})}function d(E,k){if(E[0]==80&&E[1]==75)return Oh(E,k);if((E[0]|32)==109&&(E[1]|32)==105)return Ly(E,k);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var T=3,j=512,F=0,O=0,K=0,ae=0,Y=0,Q=[],ee=E.slice(0,512);Ir(ee,0);var me=h(ee);switch(T=me[0],T){case 3:j=512;break;case 4:j=4096;break;case 0:if(me[1]==0)return Oh(E,k);default:throw new Error("Major Version: Expected 3 or 4 saw "+T)}j!==512&&(ee=E.slice(0,j),Ir(ee,28));var Ce=E.slice(0,j);f(ee,T);var Fe=ee.read_shift(4,"i");if(T===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);ee.l+=4,K=ee.read_shift(4,"i"),ee.l+=4,ee.chk("00100000","Mini Stream Cutoff Size: "),ae=ee.read_shift(4,"i"),F=ee.read_shift(4,"i"),Y=ee.read_shift(4,"i"),O=ee.read_shift(4,"i");for(var ye=-1,Ae=0;Ae<109&&(ye=ee.read_shift(4,"i"),!(ye<0));++Ae)Q[Ae]=ye;var Ue=p(E,j);g(Y,O,Ue,j,Q);var pt=v(Ue,K,Q,j);pt[K].name="!Directory",F>0&&ae!==U&&(pt[ae].name="!MiniFAT"),pt[Q[0]].name="!FAT",pt.fat_addrs=Q,pt.ssz=j;var xt={},Jt=[],Si=[],Ei=[];w(K,pt,Ue,Jt,F,xt,Si,ae),m(Si,Ei,Jt),Jt.shift();var Ni={FileIndex:Si,FullPaths:Ei};return k&&k.raw&&(Ni.raw={header:Ce,sectors:Ue}),Ni}function h(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(z,"Header Signature: "),E.l+=16;var k=E.read_shift(2,"u");return[E.read_shift(2,"u"),k]}function f(E,k){var T=9;switch(E.l+=2,T=E.read_shift(2)){case 9:if(k!=3)throw new Error("Sector Shift: Expected 9 saw "+T);break;case 12:if(k!=4)throw new Error("Sector Shift: Expected 12 saw "+T);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+T)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function p(E,k){for(var T=Math.ceil(E.length/k)-1,j=[],F=1;F<T;++F)j[F-1]=E.slice(F*k,(F+1)*k);return j[T-1]=E.slice(T*k),j}function m(E,k,T){for(var j=0,F=0,O=0,K=0,ae=0,Y=T.length,Q=[],ee=[];j<Y;++j)Q[j]=ee[j]=j,k[j]=T[j];for(;ae<ee.length;++ae)j=ee[ae],F=E[j].L,O=E[j].R,K=E[j].C,Q[j]===j&&(F!==-1&&Q[F]!==F&&(Q[j]=Q[F]),O!==-1&&Q[O]!==O&&(Q[j]=Q[O])),K!==-1&&(Q[K]=j),F!==-1&&j!=Q[j]&&(Q[F]=Q[j],ee.lastIndexOf(F)<ae&&ee.push(F)),O!==-1&&j!=Q[j]&&(Q[O]=Q[j],ee.lastIndexOf(O)<ae&&ee.push(O));for(j=1;j<Y;++j)Q[j]===j&&(O!==-1&&Q[O]!==O?Q[j]=Q[O]:F!==-1&&Q[F]!==F&&(Q[j]=Q[F]));for(j=1;j<Y;++j)if(E[j].type!==0){if(ae=j,ae!=Q[ae])do ae=Q[ae],k[j]=k[ae]+"/"+k[j];while(ae!==0&&Q[ae]!==-1&&ae!=Q[ae]);Q[j]=-1}for(k[0]+="/",j=1;j<Y;++j)E[j].type!==2&&(k[j]+="/")}function x(E,k,T){for(var j=E.start,F=E.size,O=[],K=j;T&&F>0&&K>=0;)O.push(k.slice(K*C,K*C+C)),F-=C,K=$s(T,K*4);return O.length===0?ne(0):Wt(O).slice(0,E.size)}function g(E,k,T,j,F){var O=U;if(E===U){if(k!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var K=T[E],ae=(j>>>2)-1;if(!K)return;for(var Y=0;Y<ae&&(O=$s(K,Y*4))!==U;++Y)F.push(O);g($s(K,j-4),k-1,T,j,F)}}function y(E,k,T,j,F){var O=[],K=[];F||(F=[]);var ae=j-1,Y=0,Q=0;for(Y=k;Y>=0;){F[Y]=!0,O[O.length]=Y,K.push(E[Y]);var ee=T[Math.floor(Y*4/j)];if(Q=Y*4&ae,j<4+Q)throw new Error("FAT boundary crossed: "+Y+" 4 "+j);if(!E[ee])break;Y=$s(E[ee],Q)}return{nodes:O,data:Px([K])}}function v(E,k,T,j){var F=E.length,O=[],K=[],ae=[],Y=[],Q=j-1,ee=0,me=0,Ce=0,Fe=0;for(ee=0;ee<F;++ee)if(ae=[],Ce=ee+k,Ce>=F&&(Ce-=F),!K[Ce]){Y=[];var ye=[];for(me=Ce;me>=0;){ye[me]=!0,K[me]=!0,ae[ae.length]=me,Y.push(E[me]);var Ae=T[Math.floor(me*4/j)];if(Fe=me*4&Q,j<4+Fe)throw new Error("FAT boundary crossed: "+me+" 4 "+j);if(!E[Ae]||(me=$s(E[Ae],Fe),ye[me]))break}O[Ce]={nodes:ae,data:Px([Y])}}return O}function w(E,k,T,j,F,O,K,ae){for(var Y=0,Q=j.length?2:0,ee=k[E].data,me=0,Ce=0,Fe;me<ee.length;me+=128){var ye=ee.slice(me,me+128);Ir(ye,64),Ce=ye.read_shift(2),Fe=dh(ye,0,Ce-Q),j.push(Fe);var Ae={name:Fe,type:ye.read_shift(1),color:ye.read_shift(1),L:ye.read_shift(4,"i"),R:ye.read_shift(4,"i"),C:ye.read_shift(4,"i"),clsid:ye.read_shift(16),state:ye.read_shift(4,"i"),start:0,size:0},Ue=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);Ue!==0&&(Ae.ct=_(ye,ye.l-8));var pt=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);pt!==0&&(Ae.mt=_(ye,ye.l-8)),Ae.start=ye.read_shift(4,"i"),Ae.size=ye.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=U,Ae.name=""),Ae.type===5?(Y=Ae.start,F>0&&Y!==U&&(k[Y].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",k[Ae.start]===void 0&&(k[Ae.start]=y(T,Ae.start,k.fat_addrs,k.ssz)),k[Ae.start].name=Ae.name,Ae.content=k[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:Y!==U&&Ae.start!==U&&k[Y]&&(Ae.content=x(Ae,k[Y].data,(k[ae]||{}).data))),Ae.content&&Ir(Ae.content,0),O[Fe]=Ae,K.push(Ae)}}function _(E,k){return new Date((Lr(E,k+4)/1e7*Math.pow(2,32)+Lr(E,k)/1e7-11644473600)*1e3)}function S(E,k){return u(),d(c.readFileSync(E),k)}function P(E,k){var T=k&&k.type;switch(T||Qe&&Buffer.isBuffer(E)&&(T="buffer"),T||"base64"){case"file":return S(E,k);case"base64":return d(un(Qn(E)),k);case"binary":return d(un(E),k)}return d(E,k)}function N(E,k){var T=k||{},j=T.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=j+"/",E.FileIndex[0]={name:j,type:5}),T.CLSID&&(E.FileIndex[0].clsid=T.CLSID),I(E)}function I(E){var k="Sh33tJ5";if(!nt.find(E,"/"+k)){var T=ne(4);T[0]=55,T[1]=T[3]=50,T[2]=54,E.FileIndex.push({name:k,type:2,content:T,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+k),M(E)}}function M(E,k){N(E);for(var T=!1,j=!1,F=E.FullPaths.length-1;F>=0;--F){var O=E.FileIndex[F];switch(O.type){case 0:j?T=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(O.R*O.L*O.C)&&(T=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(T=!0);break;default:T=!0;break}}if(!(!T&&!k)){var K=new Date(1987,1,19),ae=0,Y=Object.create?Object.create(null):{},Q=[];for(F=0;F<E.FullPaths.length;++F)Y[E.FullPaths[F]]=!0,E.FileIndex[F].type!==0&&Q.push([E.FullPaths[F],E.FileIndex[F]]);for(F=0;F<Q.length;++F){var ee=n(Q[F][0]);j=Y[ee],j||(Q.push([ee,{name:s(ee).replace("/",""),type:1,clsid:G,ct:K,mt:K,content:null}]),Y[ee]=!0)}for(Q.sort(function(Fe,ye){return r(Fe[0],ye[0])}),E.FullPaths=[],E.FileIndex=[],F=0;F<Q.length;++F)E.FullPaths[F]=Q[F][0],E.FileIndex[F]=Q[F][1];for(F=0;F<Q.length;++F){var me=E.FileIndex[F],Ce=E.FullPaths[F];if(me.name=s(Ce).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||G,F===0)me.C=Q.length>1?1:-1,me.size=0,me.type=5;else if(Ce.slice(-1)=="/"){for(ae=F+1;ae<Q.length&&n(E.FullPaths[ae])!=Ce;++ae);for(me.C=ae>=Q.length?-1:ae,ae=F+1;ae<Q.length&&n(E.FullPaths[ae])!=n(Ce);++ae);me.R=ae>=Q.length?-1:ae,me.type=1}else n(E.FullPaths[F+1]||"")==n(Ce)&&(me.R=F+1),me.type=2}}}function L(E,k){var T=k||{};if(T.fileType=="mad")return My(E,T);switch(M(E),T.fileType){case"zip":return Ry(E,T)}var j=function(Fe){for(var ye=0,Ae=0,Ue=0;Ue<Fe.FileIndex.length;++Ue){var pt=Fe.FileIndex[Ue];if(pt.content){var xt=pt.content.length;xt>0&&(xt<4096?ye+=xt+63>>6:Ae+=xt+511>>9)}}for(var Jt=Fe.FullPaths.length+3>>2,Si=ye+7>>3,Ei=ye+127>>7,Ni=Si+Ae+Jt+Ei,Us=Ni+127>>7,ju=Us<=109?0:Math.ceil((Us-109)/127);Ni+Us+ju+127>>7>Us;)ju=++Us<=109?0:Math.ceil((Us-109)/127);var In=[1,ju,Us,Ei,Jt,Ae,ye,0];return Fe.FileIndex[0].size=ye<<6,In[7]=(Fe.FileIndex[0].start=In[0]+In[1]+In[2]+In[3]+In[4]+In[5])+(In[6]+7>>3),In}(E),F=ne(j[7]<<9),O=0,K=0;{for(O=0;O<8;++O)F.write_shift(1,V[O]);for(O=0;O<8;++O)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),O=0;O<3;++O)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,j[2]),F.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:U),F.write_shift(4,j[3]),F.write_shift(-4,j[1]?j[0]-1:U),F.write_shift(4,j[1]),O=0;O<109;++O)F.write_shift(-4,O<j[2]?j[1]+O:-1)}if(j[1])for(K=0;K<j[1];++K){for(;O<236+K*127;++O)F.write_shift(-4,O<j[2]?j[1]+O:-1);F.write_shift(-4,K===j[1]-1?U:K+1)}var ae=function(Fe){for(K+=Fe;O<K-1;++O)F.write_shift(-4,O+1);Fe&&(++O,F.write_shift(-4,U))};for(K=O=0,K+=j[1];O<K;++O)F.write_shift(-4,J.DIFSECT);for(K+=j[2];O<K;++O)F.write_shift(-4,J.FATSECT);ae(j[3]),ae(j[4]);for(var Y=0,Q=0,ee=E.FileIndex[0];Y<E.FileIndex.length;++Y)ee=E.FileIndex[Y],ee.content&&(Q=ee.content.length,!(Q<4096)&&(ee.start=K,ae(Q+511>>9)));for(ae(j[6]+7>>3);F.l&511;)F.write_shift(-4,J.ENDOFCHAIN);for(K=O=0,Y=0;Y<E.FileIndex.length;++Y)ee=E.FileIndex[Y],ee.content&&(Q=ee.content.length,!(!Q||Q>=4096)&&(ee.start=K,ae(Q+63>>6)));for(;F.l&511;)F.write_shift(-4,J.ENDOFCHAIN);for(O=0;O<j[4]<<2;++O){var me=E.FullPaths[O];if(!me||me.length===0){for(Y=0;Y<17;++Y)F.write_shift(4,0);for(Y=0;Y<3;++Y)F.write_shift(4,-1);for(Y=0;Y<12;++Y)F.write_shift(4,0);continue}ee=E.FileIndex[O],O===0&&(ee.start=ee.size?ee.start-1:U);var Ce=O===0&&T.root||ee.name;if(Q=2*(Ce.length+1),F.write_shift(64,Ce,"utf16le"),F.write_shift(2,Q),F.write_shift(1,ee.type),F.write_shift(1,ee.color),F.write_shift(-4,ee.L),F.write_shift(-4,ee.R),F.write_shift(-4,ee.C),ee.clsid)F.write_shift(16,ee.clsid,"hex");else for(Y=0;Y<4;++Y)F.write_shift(4,0);F.write_shift(4,ee.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,ee.start),F.write_shift(4,ee.size),F.write_shift(4,0)}for(O=1;O<E.FileIndex.length;++O)if(ee=E.FileIndex[O],ee.size>=4096)if(F.l=ee.start+1<<9,Qe&&Buffer.isBuffer(ee.content))ee.content.copy(F,F.l,0,ee.size),F.l+=ee.size+511&-512;else{for(Y=0;Y<ee.size;++Y)F.write_shift(1,ee.content[Y]);for(;Y&511;++Y)F.write_shift(1,0)}for(O=1;O<E.FileIndex.length;++O)if(ee=E.FileIndex[O],ee.size>0&&ee.size<4096)if(Qe&&Buffer.isBuffer(ee.content))ee.content.copy(F,F.l,0,ee.size),F.l+=ee.size+63&-64;else{for(Y=0;Y<ee.size;++Y)F.write_shift(1,ee.content[Y]);for(;Y&63;++Y)F.write_shift(1,0)}if(Qe)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function X(E,k){var T=E.FullPaths.map(function(Y){return Y.toUpperCase()}),j=T.map(function(Y){var Q=Y.split("/");return Q[Q.length-(Y.slice(-1)=="/"?2:1)]}),F=!1;k.charCodeAt(0)===47?(F=!0,k=T[0].slice(0,-1)+k):F=k.indexOf("/")!==-1;var O=k.toUpperCase(),K=F===!0?T.indexOf(O):j.indexOf(O);if(K!==-1)return E.FileIndex[K];var ae=!O.match(Eo);for(O=O.replace(Ji,""),ae&&(O=O.replace(Eo,"!")),K=0;K<T.length;++K)if((ae?T[K].replace(Eo,"!"):T[K]).replace(Ji,"")==O||(ae?j[K].replace(Eo,"!"):j[K]).replace(Ji,"")==O)return E.FileIndex[K];return null}var C=64,U=-2,z="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],G="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:G,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(E,k,T){u();var j=L(E,T);c.writeFileSync(k,j)}function se(E){for(var k=new Array(E.length),T=0;T<E.length;++T)k[T]=String.fromCharCode(E[T]);return k.join("")}function ue(E,k){var T=L(E,k);switch(k&&k.type||"buffer"){case"file":return u(),c.writeFileSync(k.filename,T),T;case"binary":return typeof T=="string"?T:se(T);case"base64":return jl(typeof T=="string"?T:se(T));case"buffer":if(Qe)return Buffer.isBuffer(T)?T:es(T);case"array":return typeof T=="string"?un(T):T}return T}var fe;function R(E){try{var k=E.InflateRaw,T=new k;if(T._processChunk(new Uint8Array([3,0]),T._finishFlushFlag),T.bytesRead)fe=E;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function W(E,k){if(!fe)return eo(E,k);var T=fe.InflateRaw,j=new T,F=j._processChunk(E.slice(E.l),j._finishFlushFlag);return E.l+=j.bytesRead,F}function B(E){return fe?fe.deflateRawSync(E):Pt(E)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(E){var k=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(k>>16|k>>8|k)&255}for(var xe=typeof Uint8Array<"u",pe=xe?new Uint8Array(256):[],Le=0;Le<256;++Le)pe[Le]=Ee(Le);function ie(E,k){var T=pe[E&255];return k<=8?T>>>8-k:(T=T<<8|pe[E>>8&255],k<=16?T>>>16-k:(T=T<<8|pe[E>>16&255],T>>>24-k))}function je(E,k){var T=k&7,j=k>>>3;return(E[j]|(T<=6?0:E[j+1]<<8))>>>T&3}function ke(E,k){var T=k&7,j=k>>>3;return(E[j]|(T<=5?0:E[j+1]<<8))>>>T&7}function Xe(E,k){var T=k&7,j=k>>>3;return(E[j]|(T<=4?0:E[j+1]<<8))>>>T&15}function $e(E,k){var T=k&7,j=k>>>3;return(E[j]|(T<=3?0:E[j+1]<<8))>>>T&31}function Te(E,k){var T=k&7,j=k>>>3;return(E[j]|(T<=1?0:E[j+1]<<8))>>>T&127}function ce(E,k,T){var j=k&7,F=k>>>3,O=(1<<T)-1,K=E[F]>>>j;return T<8-j||(K|=E[F+1]<<8-j,T<16-j)||(K|=E[F+2]<<16-j,T<24-j)||(K|=E[F+3]<<24-j),K&O}function be(E,k,T){var j=k&7,F=k>>>3;return j<=5?E[F]|=(T&7)<<j:(E[F]|=T<<j&255,E[F+1]=(T&7)>>8-j),k+3}function oe(E,k,T){var j=k&7,F=k>>>3;return T=(T&1)<<j,E[F]|=T,k+1}function A(E,k,T){var j=k&7,F=k>>>3;return T<<=j,E[F]|=T&255,T>>>=8,E[F+1]=T,k+8}function H(E,k,T){var j=k&7,F=k>>>3;return T<<=j,E[F]|=T&255,T>>>=8,E[F+1]=T&255,E[F+2]=T>>>8,k+16}function Z(E,k){var T=E.length,j=2*T>k?2*T:k+5,F=0;if(T>=k)return E;if(Qe){var O=_x(j);if(E.copy)E.copy(O);else for(;F<E.length;++F)O[F]=E[F];return O}else if(xe){var K=new Uint8Array(j);if(K.set)K.set(E);else for(;F<T;++F)K[F]=E[F];return K}return E.length=j,E}function de(E){for(var k=new Array(E),T=0;T<E;++T)k[T]=0;return k}function ve(E,k,T){var j=1,F=0,O=0,K=0,ae=0,Y=E.length,Q=xe?new Uint16Array(32):de(32);for(O=0;O<32;++O)Q[O]=0;for(O=Y;O<T;++O)E[O]=0;Y=E.length;var ee=xe?new Uint16Array(Y):de(Y);for(O=0;O<Y;++O)Q[F=E[O]]++,j<F&&(j=F),ee[O]=0;for(Q[0]=0,O=1;O<=j;++O)Q[O+16]=ae=ae+Q[O-1]<<1;for(O=0;O<Y;++O)ae=E[O],ae!=0&&(ee[O]=Q[ae+16]++);var me=0;for(O=0;O<Y;++O)if(me=E[O],me!=0)for(ae=ie(ee[O],j)>>j-me,K=(1<<j+4-me)-1;K>=0;--K)k[ae|K<<me]=me&15|O<<4;return j}var he=xe?new Uint16Array(512):de(512),Ie=xe?new Uint16Array(32):de(32);if(!xe){for(var He=0;He<512;++He)he[He]=0;for(He=0;He<32;++He)Ie[He]=0}(function(){for(var E=[],k=0;k<32;k++)E.push(5);ve(E,Ie,32);var T=[];for(k=0;k<=143;k++)T.push(8);for(;k<=255;k++)T.push(9);for(;k<=279;k++)T.push(7);for(;k<=287;k++)T.push(8);ve(T,he,288)})();var Ke=function(){for(var k=xe?new Uint8Array(32768):[],T=0,j=0;T<we.length-1;++T)for(;j<we[T+1];++j)k[j]=T;for(;j<32768;++j)k[j]=29;var F=xe?new Uint8Array(259):[];for(T=0,j=0;T<te.length-1;++T)for(;j<te[T+1];++j)F[j]=T;function O(ae,Y){for(var Q=0;Q<ae.length;){var ee=Math.min(65535,ae.length-Q),me=Q+ee==ae.length;for(Y.write_shift(1,+me),Y.write_shift(2,ee),Y.write_shift(2,~ee&65535);ee-- >0;)Y[Y.l++]=ae[Q++]}return Y.l}function K(ae,Y){for(var Q=0,ee=0,me=xe?new Uint16Array(32768):[];ee<ae.length;){var Ce=Math.min(65535,ae.length-ee);if(Ce<10){for(Q=be(Y,Q,+(ee+Ce==ae.length)),Q&7&&(Q+=8-(Q&7)),Y.l=Q/8|0,Y.write_shift(2,Ce),Y.write_shift(2,~Ce&65535);Ce-- >0;)Y[Y.l++]=ae[ee++];Q=Y.l*8;continue}Q=be(Y,Q,+(ee+Ce==ae.length)+2);for(var Fe=0;Ce-- >0;){var ye=ae[ee];Fe=(Fe<<5^ye)&32767;var Ae=-1,Ue=0;if((Ae=me[Fe])&&(Ae|=ee&-32768,Ae>ee&&(Ae-=32768),Ae<ee))for(;ae[Ae+Ue]==ae[ee+Ue]&&Ue<250;)++Ue;if(Ue>2){ye=F[Ue],ye<=22?Q=A(Y,Q,pe[ye+1]>>1)-1:(A(Y,Q,3),Q+=5,A(Y,Q,pe[ye-23]>>5),Q+=3);var pt=ye<8?0:ye-4>>2;pt>0&&(H(Y,Q,Ue-te[ye]),Q+=pt),ye=k[ee-Ae],Q=A(Y,Q,pe[ye]>>3),Q-=3;var xt=ye<4?0:ye-2>>1;xt>0&&(H(Y,Q,ee-Ae-we[ye]),Q+=xt);for(var Jt=0;Jt<Ue;++Jt)me[Fe]=ee&32767,Fe=(Fe<<5^ae[ee])&32767,++ee;Ce-=Ue-1}else ye<=143?ye=ye+48:Q=oe(Y,Q,1),Q=A(Y,Q,pe[ye]),me[Fe]=ee&32767,++ee}Q=A(Y,Q,0)-1}return Y.l=(Q+7)/8|0,Y.l}return function(Y,Q){return Y.length<8?O(Y,Q):K(Y,Q)}}();function Pt(E){var k=ne(50+Math.floor(E.length*1.1)),T=Ke(E,k);return k.slice(0,T)}var wn=xe?new Uint16Array(32768):de(32768),rn=xe?new Uint16Array(32768):de(32768),Jl=xe?new Uint16Array(128):de(128),va=1,ya=1;function bu(E,k){var T=$e(E,k)+257;k+=5;var j=$e(E,k)+1;k+=5;var F=Xe(E,k)+4;k+=4;for(var O=0,K=xe?new Uint8Array(19):de(19),ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,Q=xe?new Uint8Array(8):de(8),ee=xe?new Uint8Array(8):de(8),me=K.length,Ce=0;Ce<F;++Ce)K[D[Ce]]=O=ke(E,k),Y<O&&(Y=O),Q[O]++,k+=3;var Fe=0;for(Q[0]=0,Ce=1;Ce<=Y;++Ce)ee[Ce]=Fe=Fe+Q[Ce-1]<<1;for(Ce=0;Ce<me;++Ce)(Fe=K[Ce])!=0&&(ae[Ce]=ee[Fe]++);var ye=0;for(Ce=0;Ce<me;++Ce)if(ye=K[Ce],ye!=0){Fe=pe[ae[Ce]]>>8-ye;for(var Ae=(1<<7-ye)-1;Ae>=0;--Ae)Jl[Fe|Ae<<ye]=ye&7|Ce<<3}var Ue=[];for(Y=1;Ue.length<T+j;)switch(Fe=Jl[Te(E,k)],k+=Fe&7,Fe>>>=3){case 16:for(O=3+je(E,k),k+=2,Fe=Ue[Ue.length-1];O-- >0;)Ue.push(Fe);break;case 17:for(O=3+ke(E,k),k+=3;O-- >0;)Ue.push(0);break;case 18:for(O=11+Te(E,k),k+=7;O-- >0;)Ue.push(0);break;default:Ue.push(Fe),Y<Fe&&(Y=Fe);break}var pt=Ue.slice(0,T),xt=Ue.slice(T);for(Ce=T;Ce<286;++Ce)pt[Ce]=0;for(Ce=j;Ce<30;++Ce)xt[Ce]=0;return va=ve(pt,wn,286),ya=ve(xt,rn,30),k}function Zl(E,k){if(E[0]==3&&!(E[1]&3))return[oa(k),2];for(var T=0,j=0,F=_x(k||1<<18),O=0,K=F.length>>>0,ae=0,Y=0;!(j&1);){if(j=ke(E,T),T+=3,j>>>1)j>>1==1?(ae=9,Y=5):(T=bu(E,T),ae=va,Y=ya);else{T&7&&(T+=8-(T&7));var Q=E[T>>>3]|E[(T>>>3)+1]<<8;if(T+=32,Q>0)for(!k&&K<O+Q&&(F=Z(F,O+Q),K=F.length);Q-- >0;)F[O++]=E[T>>>3],T+=8;continue}for(;;){!k&&K<O+32767&&(F=Z(F,O+32767),K=F.length);var ee=ce(E,T,ae),me=j>>>1==1?he[ee]:wn[ee];if(T+=me&15,me>>>=4,!(me>>>8&255))F[O++]=me;else{if(me==256)break;me-=257;var Ce=me<8?0:me-4>>2;Ce>5&&(Ce=0);var Fe=O+te[me];Ce>0&&(Fe+=ce(E,T,Ce),T+=Ce),ee=ce(E,T,Y),me=j>>>1==1?Ie[ee]:rn[ee],T+=me&15,me>>>=4;var ye=me<4?0:me-2>>1,Ae=we[me];for(ye>0&&(Ae+=ce(E,T,ye),T+=ye),!k&&K<Fe&&(F=Z(F,Fe+100),K=F.length);O<Fe;)F[O]=F[O-Ae],++O}}}return k?[F,T+7>>>3]:[F.slice(0,O),T+7>>>3]}function eo(E,k){var T=E.slice(E.l||0),j=Zl(T,k);return E.l+=j[1],j[0]}function _i(E,k){if(E)typeof console<"u"&&console.error(k);else throw new Error(k)}function Oh(E,k){var T=E;Ir(T,0);var j=[],F=[],O={FileIndex:j,FullPaths:F};N(O,{root:k.root});for(var K=T.length-4;(T[K]!=80||T[K+1]!=75||T[K+2]!=5||T[K+3]!=6)&&K>=0;)--K;T.l=K+4,T.l+=4;var ae=T.read_shift(2);T.l+=6;var Y=T.read_shift(4);for(T.l=Y,K=0;K<ae;++K){T.l+=20;var Q=T.read_shift(4),ee=T.read_shift(4),me=T.read_shift(2),Ce=T.read_shift(2),Fe=T.read_shift(2);T.l+=8;var ye=T.read_shift(4),Ae=o(T.slice(T.l+me,T.l+me+Ce));T.l+=me+Ce+Fe;var Ue=T.l;T.l=ye+4,ky(T,Q,ee,O,Ae),T.l=Ue}return O}function ky(E,k,T,j,F){E.l+=2;var O=E.read_shift(2),K=E.read_shift(2),ae=i(E);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var Y=E.read_shift(4),Q=E.read_shift(4),ee=E.read_shift(4),me=E.read_shift(2),Ce=E.read_shift(2),Fe="",ye=0;ye<me;++ye)Fe+=String.fromCharCode(E[E.l++]);if(Ce){var Ae=o(E.slice(E.l,E.l+Ce));(Ae[21589]||{}).mt&&(ae=Ae[21589].mt),((F||{})[21589]||{}).mt&&(ae=F[21589].mt)}E.l+=Ce;var Ue=E.slice(E.l,E.l+Q);switch(K){case 8:Ue=W(E,ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var pt=!1;O&8&&(Y=E.read_shift(4),Y==134695760&&(Y=E.read_shift(4),pt=!0),Q=E.read_shift(4),ee=E.read_shift(4)),Q!=k&&_i(pt,"Bad compressed size: "+k+" != "+Q),ee!=T&&_i(pt,"Bad uncompressed size: "+T+" != "+ee),Au(j,Fe,Ue,{unsafe:!0,mt:ae})}function Ry(E,k){var T=k||{},j=[],F=[],O=ne(1),K=T.compression?8:0,ae=0,Y=0,Q=0,ee=0,me=0,Ce=E.FullPaths[0],Fe=Ce,ye=E.FileIndex[0],Ae=[],Ue=0;for(Y=1;Y<E.FullPaths.length;++Y)if(Fe=E.FullPaths[Y].slice(Ce.length),ye=E.FileIndex[Y],!(!ye.size||!ye.content||Fe=="Sh33tJ5")){var pt=ee,xt=ne(Fe.length);for(Q=0;Q<Fe.length;++Q)xt.write_shift(1,Fe.charCodeAt(Q)&127);xt=xt.slice(0,xt.l),Ae[me]=xC.buf(ye.content,0);var Jt=ye.content;K==8&&(Jt=B(Jt)),O=ne(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,ae),O.write_shift(2,K),ye.mt?a(O,ye.mt):O.write_shift(4,0),O.write_shift(-4,Ae[me]),O.write_shift(4,Jt.length),O.write_shift(4,ye.content.length),O.write_shift(2,xt.length),O.write_shift(2,0),ee+=O.length,j.push(O),ee+=xt.length,j.push(xt),ee+=Jt.length,j.push(Jt),O=ne(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,ae),O.write_shift(2,K),O.write_shift(4,0),O.write_shift(-4,Ae[me]),O.write_shift(4,Jt.length),O.write_shift(4,ye.content.length),O.write_shift(2,xt.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,pt),Ue+=O.l,F.push(O),Ue+=xt.length,F.push(xt),++me}return O=ne(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,me),O.write_shift(2,me),O.write_shift(4,Ue),O.write_shift(4,ee),O.write_shift(2,0),Wt([Wt(j),Wt(F),O])}var to={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Fy(E,k){if(E.ctype)return E.ctype;var T=E.name||"",j=T.match(/\.([^\.]+)$/);return j&&to[j[1]]||k&&(j=(T=k).match(/[\.\\]([^\.\\])+$/),j&&to[j[1]])?to[j[1]]:"application/octet-stream"}function Dy(E){for(var k=jl(E),T=[],j=0;j<k.length;j+=76)T.push(k.slice(j,j+76));return T.join(`\r
`)+`\r
`}function Oy(E){var k=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var ee=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(ee.length==1?"0"+ee:ee)});k=k.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),k.charAt(0)==`
`&&(k="=0D"+k.slice(1)),k=k.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var T=[],j=k.split(`\r
`),F=0;F<j.length;++F){var O=j[F];if(O.length==0){T.push("");continue}for(var K=0;K<O.length;){var ae=76,Y=O.slice(K,K+ae);Y.charAt(ae-1)=="="?ae--:Y.charAt(ae-2)=="="?ae-=2:Y.charAt(ae-3)=="="&&(ae-=3),Y=O.slice(K,K+ae),K+=ae,K<O.length&&(Y+="="),T.push(Y)}}return T.join(`\r
`)}function Iy(E){for(var k=[],T=0;T<E.length;++T){for(var j=E[T];T<=E.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+E[++T];k.push(j)}for(var F=0;F<k.length;++F)k[F]=k[F].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return un(k.join(`\r
`))}function Py(E,k,T){for(var j="",F="",O="",K,ae=0;ae<10;++ae){var Y=k[ae];if(!Y||Y.match(/^\s*$/))break;var Q=Y.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":j=Q[2].trim();break;case"content-type":O=Q[2].trim();break;case"content-transfer-encoding":F=Q[2].trim();break}}switch(++ae,F.toLowerCase()){case"base64":K=un(Qn(k.slice(ae).join("")));break;case"quoted-printable":K=Iy(k.slice(ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var ee=Au(E,j.slice(T.length),K,{unsafe:!0});O&&(ee.ctype=O)}function Ly(E,k){if(se(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var T=k&&k.root||"",j=(Qe&&Buffer.isBuffer(E)?E.toString("binary"):se(E)).split(`\r
`),F=0,O="";for(F=0;F<j.length;++F)if(O=j[F],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),T||(T=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,T.length)!=T))for(;T.length>0&&(T=T.slice(0,T.length-1),T=T.slice(0,T.lastIndexOf("/")+1),O.slice(0,T.length)!=T););var K=(j[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var ae="--"+(K[1]||""),Y=[],Q=[],ee={FileIndex:Y,FullPaths:Q};N(ee);var me,Ce=0;for(F=0;F<j.length;++F){var Fe=j[F];Fe!==ae&&Fe!==ae+"--"||(Ce++&&Py(ee,j.slice(me,F),T),me=F)}return ee}function My(E,k){var T=k||{},j=T.boundary||"SheetJS";j="------="+j;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],O=E.FullPaths[0],K=O,ae=E.FileIndex[0],Y=1;Y<E.FullPaths.length;++Y)if(K=E.FullPaths[Y].slice(O.length),ae=E.FileIndex[Y],!(!ae.size||!ae.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var Q=ae.content,ee=Qe&&Buffer.isBuffer(Q)?Q.toString("binary"):se(Q),me=0,Ce=Math.min(1024,ee.length),Fe=0,ye=0;ye<=Ce;++ye)(Fe=ee.charCodeAt(ye))>=32&&Fe<128&&++me;var Ae=me>=Ce*4/5;F.push(j),F.push("Content-Location: "+(T.root||"file:///C:/SheetJS/")+K),F.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),F.push("Content-Type: "+Fy(ae,K)),F.push(""),F.push(Ae?Oy(ee):Dy(ee))}return F.push(j+`--\r
`),F.join(`\r
`)}function By(E){var k={};return N(k,E),k}function Au(E,k,T,j){var F=j&&j.unsafe;F||N(E);var O=!F&&nt.find(E,k);if(!O){var K=E.FullPaths[0];k.slice(0,K.length)==K?K=k:(K.slice(-1)!="/"&&(K+="/"),K=(K+k).replace("//","/")),O={name:s(k),type:2},E.FileIndex.push(O),E.FullPaths.push(K),F||nt.utils.cfb_gc(E)}return O.content=T,O.size=T?T.length:0,j&&(j.CLSID&&(O.clsid=j.CLSID),j.mt&&(O.mt=j.mt),j.ct&&(O.ct=j.ct)),O}function Uy(E,k){N(E);var T=nt.find(E,k);if(T){for(var j=0;j<E.FileIndex.length;++j)if(E.FileIndex[j]==T)return E.FileIndex.splice(j,1),E.FullPaths.splice(j,1),!0}return!1}function zy(E,k,T){N(E);var j=nt.find(E,k);if(j){for(var F=0;F<E.FileIndex.length;++F)if(E.FileIndex[F]==j)return E.FileIndex[F].name=s(T),E.FullPaths[F]=T,!0}return!1}function Vy(E){M(E,!0)}return t.find=X,t.read=P,t.parse=d,t.write=ue,t.writeFile=q,t.utils={cfb_new:By,cfb_add:Au,cfb_del:Uy,cfb_mov:zy,cfb_gc:Vy,ReadShift:el,CheckField:l2,prep_blob:Ir,bconcat:Wt,use_zlib:R,_deflateRaw:Pt,_inflateRaw:eo,consts:J},t}();function mC(e){return typeof e=="string"?xu(e):Array.isArray(e)?V4(e):e}function Gl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=xu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Rl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([mC(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Hl(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Qt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function jx(e,t){for(var r=[],n=Qt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function lh(e){for(var t=[],r=Qt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function vu(e){for(var t=[],r=Qt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function gC(e){for(var t=[],r=Qt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var kc=new Date(1899,11,30,0,0,0);function Rr(e,t){var r=e.getTime(),n=kc.getTime()+(e.getTimezoneOffset()-kc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Hv=new Date,vC=kc.getTime()+(Hv.getTimezoneOffset()-kc.getTimezoneOffset())*6e4,kx=Hv.getTimezoneOffset();function Gv(e){var t=new Date;return t.setTime(e*24*60*60*1e3+vC),t.getTimezoneOffset()!==kx&&t.setTime(t.getTime()+(t.getTimezoneOffset()-kx)*6e4),t}var Rx=new Date("2017-02-19T19:06:09.000Z"),Wv=isNaN(Rx.getFullYear())?new Date("2/19/17"):Rx,yC=Wv.getFullYear()==2017;function pr(e,t){var r=new Date(e);if(yC)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Wv.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function yu(e,t){if(Qe&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Fr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Fr(e[r]));return t}function _t(e,t){for(var r="";r.length<t;)r+=e;return r}function Gn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var wC=["january","february","march","april","may","june","july","august","september","october","november","december"];function kl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&wC.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ve(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Qe?n=es(r):n=$4(r),nt.utils.cfb_add(e,t,n)}nt.utils.cfb_add(e,t,r)}else e.file(t,r)}function oh(){return nt.utils.cfb_new()}var Ft=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_C={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ch=lh(_C),uh=/[&<>'"]/g,SC=/[\u0000-\u0008\u000b-\u001f]/g;function et(e){var t=e+"";return t.replace(uh,function(r){return ch[r]}).replace(SC,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Fx(e){return et(e).replace(/ /g,"_x0020_")}var Xv=/[\u0000-\u001f]/g;function EC(e){var t=e+"";return t.replace(uh,function(r){return ch[r]}).replace(/\n/g,"<br/>").replace(Xv,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function NC(e){var t=e+"";return t.replace(uh,function(r){return ch[r]}).replace(Xv,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function CC(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function TC(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function l0(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Dx(e){var t=oa(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Ox(e){return es(e,"binary").toString("utf8")}var Co="foo bar baz",Zi=Qe&&(Ox(Co)==l0(Co)&&Ox||Dx(Co)==l0(Co)&&Dx)||l0,Rl=Qe?function(e){return es(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},bC=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),qv=/(^\s|\s$|\n)/;function Xt(e,t){return"<"+e+(t.match(qv)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Fl(e){return Qt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function _e(e,t,r){return"<"+e+(r!=null?Fl(r):"")+(t!=null?(t.match(qv)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Od(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function AC(e,t){switch(typeof e){case"string":var r=_e("vt:lpwstr",et(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return _e((e|0)==e?"vt:i4":"vt:r8",et(String(e)));case"boolean":return _e("vt:bool",e?"true":"false")}if(e instanceof Date)return _e("vt:filetime",Od(e));throw new Error("Unable to serialize "+e)}var Bt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},gi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function jC(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function kC(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var Ix=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},Px=Qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:es(t)})):Ix(e)}:Ix,Lx=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(zi(e,s)));return n.join("").replace(Ji,"")},dh=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ji,""):Lx(e,t,r)}:Lx,Mx=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},Yv=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Mx(e,t,r)}:Mx,Bx=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Ca(e,s)));return n.join("")},Wl=Qe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Bx(t,r,n)}:Bx,Kv=function(e,t){var r=Lr(e,t);return r>0?Wl(e,t+4,t+4+r-1):""},Qv=Kv,Jv=function(e,t){var r=Lr(e,t);return r>0?Wl(e,t+4,t+4+r-1):""},Zv=Jv,e2=function(e,t){var r=2*Lr(e,t);return r>0?Wl(e,t+4,t+4+r-1):""},t2=e2,r2=function(t,r){var n=Lr(t,r);return n>0?dh(t,r+4,r+4+n):""},n2=r2,s2=function(e,t){var r=Lr(e,t);return r>0?Wl(e,t+4,t+4+r):""},a2=s2,i2=function(e,t){return jC(e,t)},Rc=i2,fh=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Qe&&(Qv=function(t,r){if(!Buffer.isBuffer(t))return Kv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Zv=function(t,r){if(!Buffer.isBuffer(t))return Jv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},t2=function(t,r){if(!Buffer.isBuffer(t))return e2(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},n2=function(t,r){if(!Buffer.isBuffer(t))return r2(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},a2=function(t,r){if(!Buffer.isBuffer(t))return s2(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Rc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):i2(t,r)},fh=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ca=function(e,t){return e[t]},zi=function(e,t){return e[t+1]*256+e[t]},RC=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Lr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},$s=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},FC=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function el(e,t){var r="",n,s,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(zi(this,u)),u+=2;e*=2;break;case"utf8":r=Wl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=dh(this,this.l,this.l+e);break;case"wstr":return el.call(this,e,"dbcs");case"lpstr-ansi":r=Qv(this,this.l),e=4+Lr(this,this.l);break;case"lpstr-cp":r=Zv(this,this.l),e=4+Lr(this,this.l);break;case"lpwstr":r=t2(this,this.l),e=4+2*Lr(this,this.l);break;case"lpp4":e=4+Lr(this,this.l),r=n2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Lr(this,this.l),r=a2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Ca(this,this.l+e++))!==0;)a.push(So(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=zi(this,this.l+e))!==0;)a.push(So(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ca(this,u),this.l=u+1,o=el.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(So(zi(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Ca(this,u),this.l=u+1,o=el.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(So(Ca(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Ca(this,this.l),this.l++,n;case 2:return n=(t==="i"?RC:zi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?$s:FC)(this,this.l),this.l+=4,n):(s=Lr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Rc(this,this.l):s=Rc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Yv(this,this.l,e);break}}return this.l+=e,r}var DC=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},OC=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},IC=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function PC(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)IC(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,DC(this,t,this.l);break;case 8:if(n=8,r==="f"){kC(this,t,this.l);break}case 16:break;case-4:n=4,OC(this,t,this.l);break}return this.l+=n,this}function l2(e,t){var r=Yv(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ir(e,t){e.l=t,e.read_shift=el,e.chk=l2,e.write_shift=PC}function Fn(e,t){e.l+=t}function ne(e){var t=oa(e);return Ir(t,0),t}function jr(){var e=[],t=Qe?256:2048,r=function(u){var d=ne(u);return Ir(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),Wt(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function le(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=jk[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&fh(r)&&e.push(r)}}function tl(e,t,r){var n=Fr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ux(e,t,r){var n=Fr(e);return n.s=tl(n.s,t.s,r),n.e=tl(n.e,t.s,r),n}function rl(e,t){if(e.cRel&&e.c<0)for(e=Fr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Fr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=rt(e);return!e.cRel&&e.cRel!=null&&(r=BC(r)),!e.rRel&&e.rRel!=null&&(r=LC(r)),r}function o0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ar(e.s.c)+":"+(e.e.cRel?"":"$")+ar(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Yt(e.s.r)+":"+(e.e.rRel?"":"$")+Yt(e.e.r):rl(e.s,t.biff)+":"+rl(e.e,t.biff)}function hh(e){return parseInt(MC(e),10)-1}function Yt(e){return""+(e+1)}function LC(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function MC(e){return e.replace(/\$(\d+)$/,"$1")}function ph(e){for(var t=UC(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ar(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function BC(e){return e.replace(/^([A-Z])/,"$$$1")}function UC(e){return e.replace(/^\$([A-Z])/,"$1")}function zC(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ut(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function rt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Vr(e){var t=e.indexOf(":");return t==-1?{s:Ut(e),e:Ut(e)}:{s:Ut(e.slice(0,t)),e:Ut(e.slice(t+1))}}function kt(e,t){return typeof t>"u"||typeof t=="number"?kt(e.s,e.e):(typeof e!="string"&&(e=rt(e)),typeof t!="string"&&(t=rt(t)),e==t?e:e+":"+t)}function ft(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function zx(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Rs(e.z,r?Rr(t):t)}catch{}try{return e.w=Rs((e.XF||{}).numFmtId||(r?14:0),r?Rr(t):t)}catch{return""+t}}function Jn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Xl[e.v]||e.v:t==null?zx(e,e.v):zx(e,t))}function ha(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function o2(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Ut(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=ft(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var p={v:t[h][f]},m=i+h,x=o+f;if(u.s.r>m&&(u.s.r=m),u.s.c>x&&(u.s.c=x),u.e.r<m&&(u.e.r=m),u.e.c<x&&(u.e.c=x),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))p=t[h][f];else if(Array.isArray(p.v)&&(p.f=t[h][f][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Et[14],n.cellDates?(p.t="d",p.w=Rs(p.z,Rr(p.v))):(p.t="n",p.v=Rr(p.v),p.w=Rs(p.z,p.v))):p.t="s";if(s)a[m]||(a[m]=[]),a[m][x]&&a[m][x].z&&(p.z=a[m][x].z),a[m][x]=p;else{var g=rt({c:x,r:m});a[g]&&a[g].z&&(p.z=a[g].z),a[g]=p}}}return u.s.c<1e7&&(a["!ref"]=kt(u)),a}function vi(e,t){return o2(null,e,t)}function VC(e){return e.read_shift(4,"i")}function mn(e,t){return t||(t=ne(4)),t.write_shift(4,e),t}function ir(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function zt(e,t){var r=!1;return t==null&&(r=!0,t=ne(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function $C(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function HC(e,t){return t||(t=ne(4)),t.write_shift(2,0),t.write_shift(2,0),t}function xh(e,t){var r=e.l,n=e.read_shift(1),s=ir(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push($C(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function GC(e,t){var r=!1;return t==null&&(r=!0,t=ne(15+4*e.t.length)),t.write_shift(1,0),zt(e.t,t),r?t.slice(0,t.l):t}var WC=xh;function XC(e,t){var r=!1;return t==null&&(r=!0,t=ne(23+4*e.t.length)),t.write_shift(1,1),zt(e.t,t),t.write_shift(4,1),HC({},t),r?t.slice(0,t.l):t}function tn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function pa(e,t){return t==null&&(t=ne(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function xa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ma(e,t){return t==null&&(t=ne(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var qC=ir,c2=zt;function mh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Fc(e,t){var r=!1;return t==null&&(r=!0,t=ne(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var YC=ir,Id=mh,gh=Fc;function u2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?Rc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):$s(t,0)>>2;return r?s/100:s}function d2(e,t){t==null&&(t=ne(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function f2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function KC(e,t){return t||(t=ne(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ga=f2,yi=KC;function wi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ca(e,t){return(t||ne(8)).write_shift(8,e,"f")}function QC(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=iT[s];u&&(t.rgb=Jx(u));break;case 2:t.rgb=Jx([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Dc(e,t){if(t||(t=ne(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function JC(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function ZC(e,t){t||(t=ne(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var h2=2,Dr=3,To=11,Oc=19,bo=64,eT=65,tT=71,rT=4108,nT=4126,Gt=80,Vx={1:{n:"CodePage",t:h2},2:{n:"Category",t:Gt},3:{n:"PresentationFormat",t:Gt},4:{n:"ByteCount",t:Dr},5:{n:"LineCount",t:Dr},6:{n:"ParagraphCount",t:Dr},7:{n:"SlideCount",t:Dr},8:{n:"NoteCount",t:Dr},9:{n:"HiddenCount",t:Dr},10:{n:"MultimediaClipCount",t:Dr},11:{n:"ScaleCrop",t:To},12:{n:"HeadingPairs",t:rT},13:{n:"TitlesOfParts",t:nT},14:{n:"Manager",t:Gt},15:{n:"Company",t:Gt},16:{n:"LinksUpToDate",t:To},17:{n:"CharacterCount",t:Dr},19:{n:"SharedDoc",t:To},22:{n:"HyperlinksChanged",t:To},23:{n:"AppVersion",t:Dr,p:"version"},24:{n:"DigSig",t:eT},26:{n:"ContentType",t:Gt},27:{n:"ContentStatus",t:Gt},28:{n:"Language",t:Gt},29:{n:"Version",t:Gt},255:{},2147483648:{n:"Locale",t:Oc},2147483651:{n:"Behavior",t:Oc},1919054434:{}},$x={1:{n:"CodePage",t:h2},2:{n:"Title",t:Gt},3:{n:"Subject",t:Gt},4:{n:"Author",t:Gt},5:{n:"Keywords",t:Gt},6:{n:"Comments",t:Gt},7:{n:"Template",t:Gt},8:{n:"LastAuthor",t:Gt},9:{n:"RevNumber",t:Gt},10:{n:"EditTime",t:bo},11:{n:"LastPrinted",t:bo},12:{n:"CreatedDate",t:bo},13:{n:"ModifiedDate",t:bo},14:{n:"PageCount",t:Dr},15:{n:"WordCount",t:Dr},16:{n:"CharCount",t:Dr},17:{n:"Thumbnail",t:tT},18:{n:"Application",t:Gt},19:{n:"DocSecurity",t:Dr},255:{},2147483648:{n:"Locale",t:Oc},2147483651:{n:"Behavior",t:Oc},1919054434:{}};function sT(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var aT=sT([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),iT=Fr(aT),Xl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ao={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function p2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function x2(e,t){var r=gC(lT),n=[],s;n[n.length]=Ft,n[n.length]=_e("Types",null,{xmlns:Bt.CT,"xmlns:xsd":Bt.xsd,"xmlns:xsi":Bt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return _e("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=_e("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Ao[c][t.bookType]||Ao[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=_e("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ao[c][t.bookType]||Ao[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=_e("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ye={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function m2(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ya(e){var t=[Ft,_e("Relationships",null,{xmlns:Bt.RELS})];return Qt(e["!id"]).forEach(function(r){t[t.length]=_e("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ze(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Ye.HLINK,Ye.XPATH,Ye.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function oT(e){var t=[Ft];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Hx(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function cT(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function uT(e){var t=[Ft];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Hx(e[r][0],e[r][1])),t.push(cT("",e[r][0]));return t.push(Hx("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function g2(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Cc.version+"</meta:generator></office:meta></office:document-meta>"}var Zs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function c0(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=et(t),n[n.length]=r?_e(e,t,r):Xt(e,t))}function v2(e,t){var r=t||{},n=[Ft,_e("cp:coreProperties",null,{"xmlns:cp":Bt.CORE_PROPS,"xmlns:dc":Bt.dc,"xmlns:dcterms":Bt.dcterms,"xmlns:dcmitype":Bt.dcmitype,"xmlns:xsi":Bt.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&c0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Od(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&c0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Od(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Zs.length;++a){var i=Zs[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&c0(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ka=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],y2=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function w2(e){var t=[],r=_e;return e||(e={}),e.Application="SheetJS",t[t.length]=Ft,t[t.length]=_e("Properties",null,{xmlns:Bt.EXT_PROPS,"xmlns:vt":Bt.vt}),Ka.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=et(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+et(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function _2(e){var t=[Ft,_e("Properties",null,{xmlns:Bt.CUST_PROPS,"xmlns:vt":Bt.vt})];if(!e)return t.join("");var r=1;return Qt(e).forEach(function(s){++r,t[t.length]=_e("property",AC(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:et(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Gx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function dT(e,t){var r=[];return Qt(Gx).map(function(n){for(var s=0;s<Zs.length;++s)if(Zs[s][1]==n)return Zs[s];for(s=0;s<Ka.length;++s)if(Ka[s][1]==n)return Ka[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Xt(Gx[n[1]]||n[1],s))}}),_e("DocumentProperties",r.join(""),{xmlns:Pr.o})}function fT(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Qt(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Zs.length;++i)if(a==Zs[i][1])return;for(i=0;i<Ka.length;++i)if(a==Ka[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(_e(Fx(a),o,{"dt:dt":c}))}}),t&&Qt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(_e(Fx(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Pr.o+'">'+s.join("")+"</"+n+">"}function hT(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=ne(8);return i.write_shift(4,n),i.write_shift(4,s),i}function Wx(e,t){var r=ne(4),n=ne(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ne(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=hT(t);break;case 31:case 80:for(n=ne(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Wt([r,n])}var S2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function pT(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Xx(e,t,r){var n=ne(8),s=[],a=[],i=8,o=0,c=ne(8),u=ne(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!t){u=ne(8),u.write_shift(4,0),s.unshift(u);var d=[ne(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(c=ne(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Wt(d),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(S2.indexOf(e[o][0])>-1||y2.indexOf(e[o][0])>-1)&&e[o][1]!=null){var f=e[o][1],p=0;if(t){p=+t[e[o][0]];var m=r[p];if(m.p=="version"&&typeof f=="string"){var x=f.split(".");f=(+x[0]<<16)+(+x[1]||0)}c=Wx(m.t,f)}else{var g=pT(f);g==-1&&(g=31,f=String(f)),c=Wx(g,f)}a.push(c),u=ne(8),u.write_shift(4,t?p:2+o),s.push(u),i+=8+c.length}var y=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,y),y+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Wt([n].concat(s).concat(a))}function qx(e,t,r,n,s,a){var i=ne(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,nt.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=Xx(e,r,n);if(o.push(c),s){var u=Xx(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return Wt(o)}function xT(e,t){t||(t=ne(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function mT(e,t){return e.read_shift(t)===1}function ur(e,t){return t||(t=ne(2)),t.write_shift(2,+!!e),t}function E2(e){return e.read_shift(2,"u")}function Xr(e,t){return t||(t=ne(2)),t.write_shift(2,e),t}function N2(e,t,r){return r||(r=ne(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function C2(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function gT(e){var t=e.t||"",r=ne(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ne(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Wt(s)}function vT(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function yT(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):vT(e,n,r)}function wT(e,t,r){if(r.biff>5)return yT(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function T2(e,t,r){return r||(r=ne(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Yx(e,t){t||(t=ne(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function _T(e){var t=ne(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),Yx(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&Yx(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ua(e,t,r,n){return n||(n=ne(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function ST(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function ET(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function b2(e,t){return t||(t=ne(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function vh(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ne(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function NT(e,t){var r=!t||t.biff==8,n=ne(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function CT(e,t){var r=!t||t.biff>=8?2:1,n=ne(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function TT(e,t){var r=ne(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=gT(e[s]);var a=Wt([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function bT(){var e=ne(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function AT(e){var t=ne(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function jT(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=ne(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function kT(e,t,r,n){var s=ne(10);return ua(e,t,n,s),s.write_shift(4,r),s}function RT(e,t,r,n,s){var a=!s||s.biff==8,i=ne(8+ +a+(1+a)*r.length);return ua(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function FT(e,t,r,n){var s=r&&r.biff==5;n||(n=ne(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function DT(e,t){var r=t.biff==8||!t.biff?4:2,n=ne(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Kx(e,t,r,n){var s=r&&r.biff==5;n||(n=ne(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function OT(e){var t=ne(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function IT(e,t,r,n,s,a){var i=ne(8);return ua(e,t,n,i),N2(r,a,i),i}function PT(e,t,r,n){var s=ne(14);return ua(e,t,n,s),ca(r,s),s}function LT(e,t,r){if(r.biff<8)return MT(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(ST(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function MT(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=C2(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function BT(e){var t=ne(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)b2(e[r],t);return t}function UT(e){var t=ne(24),r=Ut(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Wt([t,_T(e[1])])}function zT(e){var t=e[1].Tooltip,r=ne(10+2*(t.length+1));r.write_shift(2,2048);var n=Ut(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function VT(e){return e||(e=ne(4)),e.write_shift(2,1),e.write_shift(2,1),e}function $T(e,t,r){if(!r.cellStyles)return Fn(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function HT(e,t){var r=ne(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function GT(e){for(var t=ne(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function WT(e,t,r){var n=ne(15);return Yl(n,e,t),n.write_shift(8,r,"f"),n}function XT(e,t,r){var n=ne(9);return Yl(n,e,t),n.write_shift(2,r),n}var qT=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=lh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=oa(1);switch(c.type){case"base64":d=un(Qn(o));break;case"binary":d=un(o);break;case"buffer":case"array":d=o;break}Ir(d,0);var h=d.read_shift(1),f=!!(h&136),p=!1,m=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,f=!0;break;case 49:p=!0,f=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,g=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(g=d.read_shift(2));var y=d.read_shift(2),v=c.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var w=[],_={},S=Math.min(d.length,h==2?521:g-10-(p?264:0)),P=m?32:11;d.l<S&&d[d.l]!=13;)switch(_={},_.name=Tc.utils.decode(v,d.slice(d.l,d.l+P)).replace(/[\u0000\r\n].*$/g,""),d.l+=P,_.type=String.fromCharCode(d.read_shift(1)),h!=2&&!m&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),h==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&w.push(_),h!=2&&(d.l+=m?13:14),_.type){case"B":(!p||_.len!=8)&&c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var N=0,I=0;for(u[0]=[],I=0;I!=w.length;++I)u[0][I]=w[I].name;for(;x-- >0;){if(d[d.l]===42){d.l+=y;continue}for(++d.l,u[++N]=[],I=0,I=0;I!=w.length;++I){var M=d.slice(d.l,d.l+w[I].len);d.l+=w[I].len,Ir(M,0);var L=Tc.utils.decode(v,M);switch(w[I].type){case"C":L.trim().length&&(u[N][I]=L.replace(/\s+$/,""));break;case"D":L.length===8?u[N][I]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):u[N][I]=L;break;case"F":u[N][I]=parseFloat(L.trim());break;case"+":case"I":u[N][I]=m?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":u[N][I]=!0;break;case"N":case"F":u[N][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[N][I]="##MEMO##"+(m?parseInt(L.trim(),10):M.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(u[N][I]=+L||0);break;case"@":u[N][I]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":u[N][I]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":u[N][I]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[N][I]=-M.read_shift(-8,"f");break;case"B":if(p&&w[I].len==8){u[N][I]=M.read_shift(8,"f");break}case"G":case"P":M.l+=w[I].len;break;case"0":if(w[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[I].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=vi(r(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function s(o,c){try{return ha(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&Al(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=jr(),h=Bc(o,{header:1,raw:!0,cellDates:!0}),f=h[0],p=h.slice(1),m=o["!cols"]||[],x=0,g=0,y=0,v=1;for(x=0;x<f.length;++x){if(((m[x]||{}).DBF||{}).name){f[x]=m[x].DBF.name,++y;continue}if(f[x]!=null){if(++y,typeof f[x]=="number"&&(f[x]=f[x].toString(10)),typeof f[x]!="string")throw new Error("DBF Invalid column name "+f[x]+" |"+typeof f[x]+"|");if(f.indexOf(f[x])!==x){for(g=0;g<1024;++g)if(f.indexOf(f[x]+"_"+g)==-1){f[x]+="_"+g;break}}}}var w=ft(o["!ref"]),_=[],S=[],P=[];for(x=0;x<=w.e.c-w.s.c;++x){var N="",I="",M=0,L=[];for(g=0;g<p.length;++g)p[g][x]!=null&&L.push(p[g][x]);if(L.length==0||f[x]==null){_[x]="?";continue}for(g=0;g<L.length;++g){switch(typeof L[g]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=L[g]instanceof Date?"D":"C";break;default:I="C"}M=Math.max(M,String(L[g]).length),N=N&&N!=I?"C":I}M>250&&(M=250),I=((m[x]||{}).DBF||{}).type,I=="C"&&m[x].DBF.len>M&&(M=m[x].DBF.len),N=="B"&&I=="N"&&(N="N",P[x]=m[x].DBF.dec,M=m[x].DBF.len),S[x]=N=="C"||I=="N"?M:a[N]||0,v+=S[x],_[x]=N}var X=d.next(32);for(X.write_shift(4,318902576),X.write_shift(4,p.length),X.write_shift(2,296+32*y),X.write_shift(2,v),x=0;x<4;++x)X.write_shift(4,0);for(X.write_shift(4,0|(+t[jv]||3)<<8),x=0,g=0;x<f.length;++x)if(f[x]!=null){var C=d.next(32),U=(f[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,U,"sbcs"),C.write_shift(1,_[x]=="?"?"C":_[x],"sbcs"),C.write_shift(4,g),C.write_shift(1,S[x]||a[_[x]]||0),C.write_shift(1,P[x]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),g+=S[x]||a[_[x]]||0}var z=d.next(264);for(z.write_shift(4,13),x=0;x<65;++x)z.write_shift(4,0);for(x=0;x<p.length;++x){var V=d.next(v);for(V.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(_[g]){case"L":V.write_shift(1,p[x][g]==null?63:p[x][g]?84:70);break;case"B":V.write_shift(8,p[x][g]||0,"f");break;case"N":var G="0";for(typeof p[x][g]=="number"&&(G=p[x][g].toFixed(P[g]||0)),y=0;y<S[g]-G.length;++y)V.write_shift(1,32);V.write_shift(1,G,"sbcs");break;case"D":p[x][g]?(V.write_shift(4,("0000"+p[x][g].getFullYear()).slice(-4),"sbcs"),V.write_shift(2,("00"+(p[x][g].getMonth()+1)).slice(-2),"sbcs"),V.write_shift(2,("00"+p[x][g].getDate()).slice(-2),"sbcs")):V.write_shift(8,"00000000","sbcs");break;case"C":var J=String(p[x][g]!=null?p[x][g]:"").slice(0,S[g]);for(V.write_shift(1,J,"sbcs"),y=0;y<S[g]-J.length;++y)V.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),YT=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Qt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,p){var m=e[p];return typeof m=="number"?wx(m):m},n=function(f,p,m){var x=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return x==59?f:wx(x)};e["|"]=254;function s(f,p){switch(p.type){case"base64":return a(Qn(f),p);case"binary":return a(f,p);case"buffer":return a(Qe&&Buffer.isBuffer(f)?f.toString("binary"):Hl(f),p);case"array":return a(yu(f),p)}throw new Error("Unrecognized type "+p.type)}function a(f,p){var m=f.split(/[\n\r]+/),x=-1,g=-1,y=0,v=0,w=[],_=[],S=null,P={},N=[],I=[],M=[],L=0,X;for(+p.codepage>=0&&Al(+p.codepage);y!==m.length;++y){L=0;var C=m[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),U=C.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),z=U[0],V;if(C.length>0)switch(z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&_.push(C.slice(3).replace(/;;/g,";"));break;case"C":var G=!1,J=!1,q=!1,se=!1,ue=-1,fe=-1;for(v=1;v<U.length;++v)switch(U[v].charAt(0)){case"A":break;case"X":g=parseInt(U[v].slice(1))-1,J=!0;break;case"Y":for(x=parseInt(U[v].slice(1))-1,J||(g=0),X=w.length;X<=x;++X)w[X]=[];break;case"K":V=U[v].slice(1),V.charAt(0)==='"'?V=V.slice(1,V.length-1):V==="TRUE"?V=!0:V==="FALSE"?V=!1:isNaN(Gn(V))?isNaN(kl(V).getDate())||(V=pr(V)):(V=Gn(V),S!==null&&zv(S)&&(V=Gv(V))),G=!0;break;case"E":se=!0;var R=Xb(U[v].slice(1),{r:x,c:g});w[x][g]=[w[x][g],R];break;case"S":q=!0,w[x][g]=[w[x][g],"S5S"];break;case"G":break;case"R":ue=parseInt(U[v].slice(1))-1;break;case"C":fe=parseInt(U[v].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}if(G&&(w[x][g]&&w[x][g].length==2?w[x][g][0]=V:w[x][g]=V,S=null),q){if(se)throw new Error("SYLK shared formula cannot have own formula");var W=ue>-1&&w[ue][fe];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");w[x][g][1]=qb(W[1],{r:x-ue,c:g-fe})}break;case"F":var B=0;for(v=1;v<U.length;++v)switch(U[v].charAt(0)){case"X":g=parseInt(U[v].slice(1))-1,++B;break;case"Y":for(x=parseInt(U[v].slice(1))-1,X=w.length;X<=x;++X)w[X]=[];break;case"M":L=parseInt(U[v].slice(1))/20;break;case"F":break;case"G":break;case"P":S=_[parseInt(U[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=U[v].slice(1).split(" "),X=parseInt(M[0],10);X<=parseInt(M[1],10);++X)L=parseInt(M[2],10),I[X-1]=L===0?{hidden:!0}:{wch:L},yh(I[X-1]);break;case"C":g=parseInt(U[v].slice(1))-1,I[g]||(I[g]={});break;case"R":x=parseInt(U[v].slice(1))-1,N[x]||(N[x]={}),L>0?(N[x].hpt=L,N[x].hpx=F2(L)):L===0&&(N[x].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}B<1&&(S=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}}return N.length>0&&(P["!rows"]=N),I.length>0&&(P["!cols"]=I),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,P]}function i(f,p){var m=s(f,p),x=m[0],g=m[1],y=vi(x,p);return Qt(g).forEach(function(v){y[v]=g[v]}),y}function o(f,p){return ha(i(f,p),p)}function c(f,p,m,x){var g="C;Y"+(m+1)+";X"+(x+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+_h(f.f,{r:m,c:x}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(f,p){p.forEach(function(m,x){var g="F;W"+(x+1)+" "+(x+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Ic(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Pc(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function d(f,p){p.forEach(function(m,x){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*Lc(m.hpx)+";"),g.length>2&&f.push(g+"R"+(x+1))})}function h(f,p){var m=["ID;PWXL;N;E"],x=[],g=ft(f["!ref"]),y,v=Array.isArray(f),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),f["!cols"]&&u(m,f["!cols"]),f["!rows"]&&d(m,f["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var _=g.s.r;_<=g.e.r;++_)for(var S=g.s.c;S<=g.e.c;++S){var P=rt({r:_,c:S});y=v?(f[_]||[])[S]:f[P],!(!y||y.v==null&&(!y.f||y.F))&&x.push(c(y,f,_,S))}return m.join(w)+w+x.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),KT=function(){function e(a,i){switch(i.type){case"base64":return t(Qn(a),i);case"binary":return t(a,i);case"buffer":return t(Qe&&Buffer.isBuffer(a)?a.toString("binary"):Hl(a),i);case"array":return t(yu(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,u=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++c]=[],u=0;continue}if(!(c<0)){var f=o[d].trim().split(","),p=f[0],m=f[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+p){case-1:if(x==="BOT"){h[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[c][u]=!0:x==="FALSE"?h[c][u]=!1:isNaN(Gn(m))?isNaN(kl(m).getDate())?h[c][u]=m:h[c][u]=pr(m):h[c][u]=Gn(m),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return vi(e(a,i),i)}function n(a,i){return ha(r(a,i),i)}var s=function(){var a=function(c,u,d,h,f){c.push(u),c.push(d+","+h),c.push('"'+f.replace(/"/g,'""')+'"')},i=function(c,u,d,h){c.push(u+","+d),c.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var u=[],d=ft(c["!ref"]),h,f=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var x=rt({r:p,c:m});if(h=f?(c[p]||[])[m]:c[x],!h){i(u,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?i(u,1,0,"="+h.f):i(u,1,0,""):i(u,0,g,"V");break;case"b":i(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Rs(h.z||Et[14],Rr(pr(h.v)))),i(u,0,h.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,v=u.join(y);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),A2=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var p=h.split(`
`),m=-1,x=-1,g=0,y=[];g!==p.length;++g){var v=p[g].trim().split(":");if(v[0]==="cell"){var w=Ut(v[1]);if(y.length<=w.r)for(m=y.length;m<=w.r;++m)y[m]||(y[m]=[]);switch(m=w.r,x=w.c,v[2]){case"t":y[m][x]=e(v[3]);break;case"v":y[m][x]=+v[3];break;case"vtf":var _=v[v.length-1];case"vtc":switch(v[3]){case"nl":y[m][x]=!!+v[4];break;default:y[m][x]=+v[4];break}v[2]=="vtf"&&(y[m][x]=[y[m][x],_])}}}return f&&f.sheetRows&&(y=y.slice(0,f.sheetRows)),y}function n(h,f){return vi(r(h,f),f)}function s(h,f){return ha(n(h,f),f)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var f=[],p=[],m,x="",g=Vr(h["!ref"]),y=Array.isArray(h),v=g.s.r;v<=g.e.r;++v)for(var w=g.s.c;w<=g.e.c;++w)if(x=rt({r:v,c:w}),m=y?(h[v]||[])[w]:h[x],!(!m||m.v==null||m.t==="z")){switch(p=["cell",x,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var _=Rr(pr(m.v));p[2]="vtc",p[3]="nd",p[4]=""+_,p[5]=m.w||Rs(m.z||Et[14],_);break;case"e":continue}f.push(p.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(h){return[a,i,o,i,u(h),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),QT=function(){function e(d,h,f,p,m){m.raw?h[f][p]=d:d===""||(d==="TRUE"?h[f][p]=!0:d==="FALSE"?h[f][p]=!1:isNaN(Gn(d))?isNaN(kl(d).getDate())?h[f][p]=d:h[f][p]=pr(d):h[f][p]=Gn(d))}function t(d,h){var f=h||{},p=[];if(!d||d.length===0)return p;for(var m=d.split(/[\r\n]/),x=m.length-1;x>=0&&m[x].length===0;)--x;for(var g=10,y=0,v=0;v<=x;++v)y=m[v].indexOf(" "),y==-1?y=m[v].length:y++,g=Math.max(g,y);for(v=0;v<=x;++v){p[v]=[];var w=0;for(e(m[v].slice(0,g).trim(),p,v,w,f),w=1;w<=(m[v].length-g)/10+1;++w)e(m[v].slice(g+(w-1)*10,g+w*10).trim(),p,v,w,f)}return f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var h={},f=!1,p=0,m=0;p<d.length;++p)(m=d.charCodeAt(p))==34?f=!f:!f&&m in r&&(h[m]=(h[m]||0)+1);m=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&m.push([h[p],p]);if(!m.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&m.push([h[p],p])}return m.sort(function(x,g){return x[0]-g[0]||n[x[1]]-n[g[1]]}),r[m.pop()[1]]||44}function a(d,h){var f=h||{},p="",m=f.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):f&&f.FS?p=f.FS:p=s(d.slice(0,1024));var g=0,y=0,v=0,w=0,_=0,S=p.charCodeAt(0),P=!1,N=0,I=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var M=f.dateNF!=null?hC(f.dateNF):null;function L(){var X=d.slice(w,_),C={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)C.t="z";else if(f.raw)C.t="s",C.v=X;else if(X.trim().length===0)C.t="s",C.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(C.t="s",C.v=X.slice(2,-1).replace(/""/g,'"')):Yb(X)?(C.t="n",C.f=X.slice(1)):(C.t="s",C.v=X);else if(X=="TRUE")C.t="b",C.v=!0;else if(X=="FALSE")C.t="b",C.v=!1;else if(!isNaN(v=Gn(X)))C.t="n",f.cellText!==!1&&(C.w=X),C.v=v;else if(!isNaN(kl(X).getDate())||M&&X.match(M)){C.z=f.dateNF||Et[14];var U=0;M&&X.match(M)&&(X=pC(X,f.dateNF,X.match(M)||[]),U=1),f.cellDates?(C.t="d",C.v=pr(X,U)):(C.t="n",C.v=Rr(pr(X,U))),f.cellText!==!1&&(C.w=Rs(C.z,C.v instanceof Date?Rr(C.v):C.v)),f.cellNF||delete C.z}else C.t="s",C.v=X;if(C.t=="z"||(f.dense?(m[g]||(m[g]=[]),m[g][y]=C):m[rt({c:y,r:g})]=C),w=_+1,I=d.charCodeAt(w),x.e.c<y&&(x.e.c=y),x.e.r<g&&(x.e.r=g),N==S)++y;else if(y=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;_<d.length;++_)switch(N=d.charCodeAt(_)){case 34:I===34&&(P=!P);break;case S:case 10:case 13:if(!P&&L())break e;break}return _-w>0&&L(),m["!ref"]=kt(x),m}function i(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,h):vi(t(d,h),h)}function o(d,h){var f="",p=h.type=="string"?[0,0,0,0]:cR(d,h);switch(h.type){case"base64":f=Qn(d);break;case"binary":f=d;break;case"buffer":h.codepage==65001?f=d.toString("utf8"):h.codepage&&typeof Tc<"u"||(f=Qe&&Buffer.isBuffer(d)?d.toString("binary"):Hl(d));break;case"array":f=yu(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?f=Zi(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=Zi(f):h.type=="binary"&&typeof Tc<"u",f.slice(0,19)=="socialcalc:version:"?A2.to_sheet(h.type=="string"?f:Zi(f),h):i(f,h)}function c(d,h){return ha(o(d,h),h)}function u(d){for(var h=[],f=ft(d["!ref"]),p,m=Array.isArray(d),x=f.s.r;x<=f.e.r;++x){for(var g=[],y=f.s.c;y<=f.e.c;++y){var v=rt({r:x,c:y});if(p=m?(d[x]||[])[y]:d[v],!p||p.v==null){g.push("          ");continue}for(var w=(p.w||(Jn(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(y===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}(),Qx=function(){function e(R,W,B){if(R){Ir(R,R.l||0);for(var D=B.Enum||ue;R.l<R.length;){var te=R.read_shift(2),we=D[te]||D[65535],Ee=R.read_shift(2),xe=R.l+Ee,pe=we.f&&we.f(R,Ee,B);if(R.l=xe,W(pe,we,te))return}}}function t(R,W){switch(W.type){case"base64":return r(un(Qn(R)),W);case"binary":return r(un(R),W);case"buffer":case"array":return r(R,W)}throw"Unsupported type "+W.type}function r(R,W){if(!R)return R;var B=W||{},D=B.dense?[]:{},te="Sheet1",we="",Ee=0,xe={},pe=[],Le=[],ie={s:{r:0,c:0},e:{r:0,c:0}},je=B.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)B.Enum=ue,e(R,function(Te,ce,be){switch(be){case 0:B.vers=Te,Te>=4096&&(B.qpro=!0);break;case 6:ie=Te;break;case 204:Te&&(we=Te);break;case 222:we=Te;break;case 15:case 51:B.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:be==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=B.dateNF||Et[14],B.cellDates&&(Te[1].t="d",Te[1].v=Gv(Te[1].v))),B.qpro&&Te[3]>Ee&&(D["!ref"]=kt(ie),xe[te]=D,pe.push(te),D=B.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},Ee=Te[3],te=we||"Sheet"+(Ee+1),we="");var oe=B.dense?(D[Te[0].r]||[])[Te[0].c]:D[rt(Te[0])];if(oe){oe.t=Te[1].t,oe.v=Te[1].v,Te[1].z!=null&&(oe.z=Te[1].z),Te[1].f!=null&&(oe.f=Te[1].f);break}B.dense?(D[Te[0].r]||(D[Te[0].r]=[]),D[Te[0].r][Te[0].c]=Te[1]):D[rt(Te[0])]=Te[1];break}},B);else if(R[2]==26||R[2]==14)B.Enum=fe,R[2]==14&&(B.qpro=!0,R.l=0),e(R,function(Te,ce,be){switch(be){case 204:te=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>Ee&&(D["!ref"]=kt(ie),xe[te]=D,pe.push(te),D=B.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},Ee=Te[3],te="Sheet"+(Ee+1)),je>0&&Te[0].r>=je)break;B.dense?(D[Te[0].r]||(D[Te[0].r]=[]),D[Te[0].r][Te[0].c]=Te[1]):D[rt(Te[0])]=Te[1],ie.e.c<Te[0].c&&(ie.e.c=Te[0].c),ie.e.r<Te[0].r&&(ie.e.r=Te[0].r);break;case 27:Te[14e3]&&(Le[Te[14e3][0]]=Te[14e3][1]);break;case 1537:Le[Te[0]]=Te[1],Te[0]==Ee&&(te=Te[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(D["!ref"]=kt(ie),xe[we||te]=D,pe.push(we||te),!Le.length)return{SheetNames:pe,Sheets:xe};for(var ke={},Xe=[],$e=0;$e<Le.length;++$e)xe[pe[$e]]?(Xe.push(Le[$e]||pe[$e]),ke[Le[$e]]=xe[Le[$e]]||xe[pe[$e]]):(Xe.push(Le[$e]),ke[Le[$e]]={"!ref":"A1"});return{SheetNames:Xe,Sheets:ke}}function n(R,W){var B=W||{};if(+B.codepage>=0&&Al(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var D=jr(),te=ft(R["!ref"]),we=Array.isArray(R),Ee=[];Se(D,0,a(1030)),Se(D,6,c(te));for(var xe=Math.min(te.e.r,8191),pe=te.s.r;pe<=xe;++pe)for(var Le=Yt(pe),ie=te.s.c;ie<=te.e.c;++ie){pe===te.s.r&&(Ee[ie]=ar(ie));var je=Ee[ie]+Le,ke=we?(R[pe]||[])[ie]:R[je];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?Se(D,13,p(pe,ie,ke.v)):Se(D,14,x(pe,ie,ke.v));else{var Xe=Jn(ke);Se(D,15,h(pe,ie,Xe.slice(0,239)))}}return Se(D,1),D.end()}function s(R,W){var B=W||{};if(+B.codepage>=0&&Al(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var D=jr();Se(D,0,i(R));for(var te=0,we=0;te<R.SheetNames.length;++te)(R.Sheets[R.SheetNames[te]]||{})["!ref"]&&Se(D,27,se(R.SheetNames[te],we++));var Ee=0;for(te=0;te<R.SheetNames.length;++te){var xe=R.Sheets[R.SheetNames[te]];if(!(!xe||!xe["!ref"])){for(var pe=ft(xe["!ref"]),Le=Array.isArray(xe),ie=[],je=Math.min(pe.e.r,8191),ke=pe.s.r;ke<=je;++ke)for(var Xe=Yt(ke),$e=pe.s.c;$e<=pe.e.c;++$e){ke===pe.s.r&&(ie[$e]=ar($e));var Te=ie[$e]+Xe,ce=Le?(xe[ke]||[])[$e]:xe[Te];if(!(!ce||ce.t=="z"))if(ce.t=="n")Se(D,23,L(ke,$e,Ee,ce.v));else{var be=Jn(ce);Se(D,22,N(ke,$e,Ee,be.slice(0,239)))}}++Ee}}return Se(D,1),D.end()}function a(R){var W=ne(2);return W.write_shift(2,R),W}function i(R){var W=ne(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var B=0,D=0,te=0,we=0;we<R.SheetNames.length;++we){var Ee=R.SheetNames[we],xe=R.Sheets[Ee];if(!(!xe||!xe["!ref"])){++te;var pe=Vr(xe["!ref"]);B<pe.e.r&&(B=pe.e.r),D<pe.e.c&&(D=pe.e.c)}}return B>8191&&(B=8191),W.write_shift(2,B),W.write_shift(1,te),W.write_shift(1,D),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function o(R,W,B){var D={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&B.qpro?(D.s.c=R.read_shift(1),R.l++,D.s.r=R.read_shift(2),D.e.c=R.read_shift(1),R.l++,D.e.r=R.read_shift(2),D):(D.s.c=R.read_shift(2),D.s.r=R.read_shift(2),W==12&&B.qpro&&(R.l+=2),D.e.c=R.read_shift(2),D.e.r=R.read_shift(2),W==12&&B.qpro&&(R.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function c(R){var W=ne(8);return W.write_shift(2,R.s.c),W.write_shift(2,R.s.r),W.write_shift(2,R.e.c),W.write_shift(2,R.e.r),W}function u(R,W,B){var D=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(D[0].c=R.read_shift(1),D[3]=R.read_shift(1),D[0].r=R.read_shift(2),R.l+=2):(D[2]=R.read_shift(1),D[0].c=R.read_shift(2),D[0].r=R.read_shift(2)),D}function d(R,W,B){var D=R.l+W,te=u(R,W,B);if(te[1].t="s",B.vers==20768){R.l++;var we=R.read_shift(1);return te[1].v=R.read_shift(we,"utf8"),te}return B.qpro&&R.l++,te[1].v=R.read_shift(D-R.l,"cstr"),te}function h(R,W,B){var D=ne(7+B.length);D.write_shift(1,255),D.write_shift(2,W),D.write_shift(2,R),D.write_shift(1,39);for(var te=0;te<D.length;++te){var we=B.charCodeAt(te);D.write_shift(1,we>=128?95:we)}return D.write_shift(1,0),D}function f(R,W,B){var D=u(R,W,B);return D[1].v=R.read_shift(2,"i"),D}function p(R,W,B){var D=ne(7);return D.write_shift(1,255),D.write_shift(2,W),D.write_shift(2,R),D.write_shift(2,B,"i"),D}function m(R,W,B){var D=u(R,W,B);return D[1].v=R.read_shift(8,"f"),D}function x(R,W,B){var D=ne(13);return D.write_shift(1,255),D.write_shift(2,W),D.write_shift(2,R),D.write_shift(8,B,"f"),D}function g(R,W,B){var D=R.l+W,te=u(R,W,B);if(te[1].v=R.read_shift(8,"f"),B.qpro)R.l=D;else{var we=R.read_shift(2);_(R.slice(R.l,R.l+we),te),R.l+=we}return te}function y(R,W,B){var D=W&32768;return W&=-32769,W=(D?R:0)+(W>=8192?W-16384:W),(D?"":"$")+(B?ar(W):Yt(W))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(R,W){Ir(R,0);for(var B=[],D=0,te="",we="",Ee="",xe="";R.l<R.length;){var pe=R[R.l++];switch(pe){case 0:B.push(R.read_shift(8,"f"));break;case 1:we=y(W[0].c,R.read_shift(2),!0),te=y(W[0].r,R.read_shift(2),!1),B.push(we+te);break;case 2:{var Le=y(W[0].c,R.read_shift(2),!0),ie=y(W[0].r,R.read_shift(2),!1);we=y(W[0].c,R.read_shift(2),!0),te=y(W[0].r,R.read_shift(2),!1),B.push(Le+ie+":"+we+te)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(R.read_shift(2));break;case 6:{for(var je="";pe=R[R.l++];)je+=String.fromCharCode(pe);B.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:xe=B.pop(),Ee=B.pop(),B.push(["AND","OR"][pe-20]+"("+Ee+","+xe+")");break;default:if(pe<32&&w[pe])xe=B.pop(),Ee=B.pop(),B.push(Ee+w[pe]+xe);else if(v[pe]){if(D=v[pe][1],D==69&&(D=R[R.l++]),D>B.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+B.join("|")+"|");return}var ke=B.slice(-D);B.length-=D,B.push(v[pe][0]+"("+ke.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}B.length==1?W[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function S(R){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=R.read_shift(2),W[3]=R[R.l++],W[0].c=R[R.l++],W}function P(R,W){var B=S(R);return B[1].t="s",B[1].v=R.read_shift(W-4,"cstr"),B}function N(R,W,B,D){var te=ne(6+D.length);te.write_shift(2,R),te.write_shift(1,B),te.write_shift(1,W),te.write_shift(1,39);for(var we=0;we<D.length;++we){var Ee=D.charCodeAt(we);te.write_shift(1,Ee>=128?95:Ee)}return te.write_shift(1,0),te}function I(R,W){var B=S(R);B[1].v=R.read_shift(2);var D=B[1].v>>1;if(B[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return B[1].v=D,B}function M(R,W){var B=S(R),D=R.read_shift(4),te=R.read_shift(4),we=R.read_shift(2);if(we==65535)return D===0&&te===3221225472?(B[1].t="e",B[1].v=15):D===0&&te===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var Ee=we&32768;return we=(we&32767)-16446,B[1].v=(1-Ee*2)*(te*Math.pow(2,we+32)+D*Math.pow(2,we)),B}function L(R,W,B,D){var te=ne(14);if(te.write_shift(2,R),te.write_shift(1,B),te.write_shift(1,W),D==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var we=0,Ee=0,xe=0,pe=0;return D<0&&(we=1,D=-D),Ee=Math.log2(D)|0,D/=Math.pow(2,Ee-31),pe=D>>>0,pe&2147483648||(D/=2,++Ee,pe=D>>>0),D-=pe,pe|=2147483648,pe>>>=0,D*=Math.pow(2,32),xe=D>>>0,te.write_shift(4,xe),te.write_shift(4,pe),Ee+=16383+(we?32768:0),te.write_shift(2,Ee),te}function X(R,W){var B=M(R);return R.l+=W-14,B}function C(R,W){var B=S(R),D=R.read_shift(4);return B[1].v=D>>6,B}function U(R,W){var B=S(R),D=R.read_shift(8,"f");return B[1].v=D,B}function z(R,W){var B=U(R);return R.l+=W-10,B}function V(R,W){return R[R.l+W-1]==0?R.read_shift(W,"cstr"):""}function G(R,W){var B=R[R.l++];B>W-1&&(B=W-1);for(var D="";D.length<B;)D+=String.fromCharCode(R[R.l++]);return D}function J(R,W,B){if(!(!B.qpro||W<21)){var D=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var te=R.read_shift(W-21,"cstr");return[D,te]}}function q(R,W){for(var B={},D=R.l+W;R.l<D;){var te=R.read_shift(2);if(te==14e3){for(B[te]=[0,""],B[te][0]=R.read_shift(2);R[R.l];)B[te][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return B}function se(R,W){var B=ne(5+R.length);B.write_shift(2,14e3),B.write_shift(2,W);for(var D=0;D<R.length;++D){var te=R.charCodeAt(D);B[B.l++]=te>127?95:te}return B[B.l++]=0,B}var ue={0:{n:"BOF",f:E2},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:V},222:{n:"SHEETNAMELP",f:G},65535:{n:""}},fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:V},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),JT=/^\s|\s$|[\t\n\r]/;function j2(e,t){if(!t.bookSST)return"";var r=[Ft];r[r.length]=_e("sst",null,{xmlns:gi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(JT)&&(a+=' xml:space="preserve"'),a+=">"+et(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ZT(e){return[e.read_shift(4),e.read_shift(4)]}function eb(e,t){return t||(t=ne(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var tb=GC;function rb(e){var t=jr();le(t,159,eb(e));for(var r=0;r<e.length;++r)le(t,19,tb(e[r]));return le(t,160),t.end()}function nb(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function k2(e){var t=0,r,n=nb(e),s=n.length+1,a,i,o,c,u;for(r=oa(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var sb=function(){function e(s,a){switch(a.type){case"base64":return t(Qn(s),a);case"binary":return t(s,a);case"buffer":return t(Qe&&Buffer.isBuffer(s)?s.toString("binary"):Hl(s),a);case"array":return t(yu(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var f=/\\\w+\b/g,p=0,m,x=-1;m=f.exec(d);){switch(m[0]){case"\\cell":var g=d.slice(p,f.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var y={v:g,t:"s"};Array.isArray(o)?o[h][x]=y:o[rt({r:h,c:x})]=y}break}p=f.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=kt(u),o}function r(s,a){return ha(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=ft(s["!ref"]),o,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var h=rt({r:u,c:d});o=c?(s[u]||[])[d]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Jn(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Jx(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var ab=6,Wn=ab;function Ic(e){return Math.floor((e+Math.round(128/Wn)/256)*Wn)}function Pc(e){return Math.floor((e-5)/Wn*100+.5)/100}function Pd(e){return Math.round((e*Wn+5)/Wn*256)/256}function yh(e){e.width?(e.wpx=Ic(e.width),e.wch=Pc(e.wpx),e.MDW=Wn):e.wpx?(e.wch=Pc(e.wpx),e.width=Pd(e.wch),e.MDW=Wn):typeof e.wch=="number"&&(e.width=Pd(e.wch),e.wpx=Ic(e.width),e.MDW=Wn),e.customWidth&&delete e.customWidth}var ib=96,R2=ib;function Lc(e){return e*96/R2}function F2(e){return e*R2/96}function lb(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=_e("numFmt",null,{numFmtId:n,formatCode:et(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=_e("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function ob(e){var t=[];return t[t.length]=_e("cellXfs",null),e.forEach(function(r){t[t.length]=_e("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=_e("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function D2(e,t){var r=[Ft,_e("styleSheet",null,{xmlns:gi[0],"xmlns:vt":Bt.vt})],n;return e.SSF&&(n=lb(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=ob(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function cb(e,t){var r=e.read_shift(2),n=ir(e);return[r,n]}function ub(e,t,r){r||(r=ne(6+4*t.length)),r.write_shift(2,e),zt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function db(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=JC(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=QC(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ir(e),n}function fb(e,t){t||(t=ne(25+4*32)),t.write_shift(2,e.sz*20),ZC(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Dc(e.color,t);var n=0;return n=2,t.write_shift(1,n),zt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var hb=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],u0,pb=Fn;function Zx(e,t){t||(t=ne(4*3+8*7+16*1)),u0||(u0=lh(hb));var r=u0[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Dc({auto:1},t),Dc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function xb(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function O2(e,t,r){r||(r=ne(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Oi(e,t){return t||(t=ne(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var mb=Fn;function gb(e,t){return t||(t=ne(51)),t.write_shift(1,0),Oi(null,t),Oi(null,t),Oi(null,t),Oi(null,t),Oi(null,t),t.length>t.l?t.slice(0,t.l):t}function vb(e,t){return t||(t=ne(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Fc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function yb(e,t,r){var n=ne(2052);return n.write_shift(4,e),Fc(t,n),Fc(r,n),n.length>n.l?n.slice(0,n.l):n}function wb(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(le(e,615,mn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&le(e,44,ub(s,t[s]))}),le(e,616))}}function _b(e){var t=1;le(e,611,mn(t)),le(e,43,fb({sz:12,color:{theme:1},name:"Calibri",family:2})),le(e,612)}function Sb(e){var t=2;le(e,603,mn(t)),le(e,45,Zx({patternType:"none"})),le(e,45,Zx({patternType:"gray125"})),le(e,604)}function Eb(e){var t=1;le(e,613,mn(t)),le(e,46,gb()),le(e,614)}function Nb(e){var t=1;le(e,626,mn(t)),le(e,47,O2({numFmtId:0},65535)),le(e,627)}function Cb(e,t){le(e,617,mn(t.length)),t.forEach(function(r){le(e,47,O2(r,0))}),le(e,618)}function Tb(e){var t=1;le(e,619,mn(t)),le(e,48,vb({xfId:0,name:"Normal"})),le(e,620)}function bb(e){var t=0;le(e,505,mn(t)),le(e,506)}function Ab(e){var t=0;le(e,508,yb(t,"TableStyleMedium9","PivotStyleMedium4")),le(e,509)}function jb(e,t){var r=jr();return le(r,278),wb(r,e.SSF),_b(r),Sb(r),Eb(r),Nb(r),Cb(r,t.cellXfs),Tb(r),bb(r),Ab(r),le(r,279),r.end()}function I2(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ft];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function kb(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ir(e)}}function Rb(e){var t=ne(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),zt(e.name,t),t.slice(0,t.l)}function Fb(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Db(e){var t=ne(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Ob(e,t){var r=ne(8+2*t.length);return r.write_shift(4,e),zt(t,r),r.slice(0,r.l)}function Ib(e){return e.l+=4,e.read_shift(4)!=0}function Pb(e,t){var r=ne(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Lb(){var e=jr();return le(e,332),le(e,334,mn(1)),le(e,335,Rb({name:"XLDAPR",version:12e4,flags:3496657072})),le(e,336),le(e,339,Ob(1,"XLDAPR")),le(e,52),le(e,35,mn(514)),le(e,4096,mn(0)),le(e,4097,Xr(1)),le(e,36),le(e,53),le(e,340),le(e,337,Pb(1)),le(e,51,Db([[1,0]])),le(e,338),le(e,333),e.end()}function P2(){var e=[Ft];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Mb(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=rt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ba=1024;function L2(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[_e("xml",null,{"xmlns:v":Pr.v,"xmlns:o":Pr.o,"xmlns:x":Pr.x,"xmlns:mv":Pr.mv}).replace(/\/>/,">"),_e("o:shapelayout",_e("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),_e("v:shapetype",[_e("v:stroke",null,{joinstyle:"miter"}),_e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ba<e*1e3;)Ba+=1e3;return t.forEach(function(a){var i=Ut(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?_e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=_e("v:fill",c,o),d={on:"t",obscured:"t"};++Ba,s=s.concat(["<v:shape"+Fl({id:"_x0000_s"+Ba,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,_e("v:shadow",null,d),_e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Xt("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Xt("x:AutoFill","False"),Xt("x:Row",String(i.r)),Xt("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function M2(e){var t=[Ft,_e("comments",null,{xmlns:gi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=et(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(et(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Xt("t",et(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(Xt("t",et(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Bb(e,t,r){var n=[Ft,_e("ThreadedComments",null,{xmlns:Bt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(_e("threadedComment",Xt("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Ub(e){var t=[Ft,_e("personList",null,{xmlns:Bt.TCMNT,"xmlns:x":gi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(_e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function zb(e){var t={};t.iauthor=e.read_shift(4);var r=ga(e);return t.rfx=r.s,t.ref=rt(r.s),e.l+=16,t}function Vb(e,t){return t==null&&(t=ne(36)),t.write_shift(4,e[1].iauthor),yi(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var $b=ir;function Hb(e){return zt(e.slice(0,54))}function Gb(e){var t=jr(),r=[];return le(t,628),le(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),le(t,632,Hb(s.a)))})}),le(t,631),le(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Ut(n[0]),e:Ut(n[0])};le(t,635,Vb([a,s])),s.t&&s.t.length>0&&le(t,637,XC(s)),le(t,636),delete s.iauthor})}),le(t,634),le(t,629),t.end()}function Wb(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&nt.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var B2=["xlsb","xlsm","xlam","biff8","xla"],Xb=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,s+(o?"":"$")+ar(d)+(c?"":"$")+Yt(u)}return function(s,a){return t=a,s.replace(e,r)}}(),wh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_h=function(){return function(t,r){return t.replace(wh,function(n,s,a,i,o,c){var u=ph(i)-(a?0:r.c),d=hh(c)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",f=u==0?"":a?u+1:"["+u+"]";return s+"R"+h+"C"+f})}}();function qb(e,t){return e.replace(wh,function(r,n,s,a,i,o){return n+(s=="$"?s+a:ar(ph(a)+t.c))+(i=="$"?i+o:Yt(hh(o)+t.r))})}function Yb(e){return e.length!=1}function At(e){e.l+=1}function Fs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function U2(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return z2(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Fs(e),o=Fs(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function z2(e){var t=Fs(e),r=Fs(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Kb(e,t,r){if(r.biff<8)return z2(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Fs(e),i=Fs(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function V2(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Qb(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Fs(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Qb(e){var t=Fs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Jb(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Zb(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return eA(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function eA(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function tA(e,t,r){var n=(e[e.l++]&96)>>5,s=U2(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function rA(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=U2(e,a,r);return[n,s,i]}function nA(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function sA(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function aA(e,t,r){var n=(e[e.l++]&96)>>5,s=Kb(e,t-1,r);return[n,s]}function iA(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function em(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function lA(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function oA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function cA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function uA(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function dA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function $2(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function fA(e){return e.read_shift(2),$2(e)}function hA(e){return e.read_shift(2),$2(e)}function pA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=V2(e,0,r);return[n,s]}function xA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Zb(e,0,r);return[n,s]}function mA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=V2(e,0,r);return[n,s,a]}function gA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[g3[s],W2[s],n]}function vA(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:yA(e);return[s,(a[0]===0?W2:m3)[a[1]]]}function yA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function wA(e,t,r){e.l+=r&&r.biff==2?3:4}function _A(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function SA(e){return e.l++,Xl[e.read_shift(1)]}function EA(e){return e.l++,e.read_shift(2)}function NA(e){return e.l++,e.read_shift(1)!==0}function CA(e){return e.l++,wi(e)}function TA(e,t,r){return e.l++,C2(e,t-1,r)}function bA(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=mT(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Xl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=wi(e);break;case 2:r[1]=wT(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function AA(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?ga:ET)(e));return s}function jA(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=bA(e,r.biff);return i}function kA(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function RA(e,t,r){if(r.biff==5)return FA(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function FA(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function DA(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function OA(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function IA(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function PA(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var LA=Fn,MA=Fn,BA=Fn;function ql(e,t,r){return e.l+=2,[Jb(e)]}function Sh(e){return e.l+=6,[]}var UA=ql,zA=Sh,VA=Sh,$A=ql;function H2(e){return e.l+=2,[E2(e),e.read_shift(2)&1]}var HA=ql,GA=H2,WA=Sh,XA=ql,qA=ql,YA=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function KA(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=YA[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function QA(e){return e.l+=2,[e.read_shift(4)]}function JA(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function ZA(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function e3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function t3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function r3(e){return e.l+=4,[0,0]}var tm={1:{n:"PtgExp",f:_A},2:{n:"PtgTbl",f:BA},3:{n:"PtgAdd",f:At},4:{n:"PtgSub",f:At},5:{n:"PtgMul",f:At},6:{n:"PtgDiv",f:At},7:{n:"PtgPower",f:At},8:{n:"PtgConcat",f:At},9:{n:"PtgLt",f:At},10:{n:"PtgLe",f:At},11:{n:"PtgEq",f:At},12:{n:"PtgGe",f:At},13:{n:"PtgGt",f:At},14:{n:"PtgNe",f:At},15:{n:"PtgIsect",f:At},16:{n:"PtgUnion",f:At},17:{n:"PtgRange",f:At},18:{n:"PtgUplus",f:At},19:{n:"PtgUminus",f:At},20:{n:"PtgPercent",f:At},21:{n:"PtgParen",f:At},22:{n:"PtgMissArg",f:At},23:{n:"PtgStr",f:TA},26:{n:"PtgSheet",f:JA},27:{n:"PtgEndSheet",f:ZA},28:{n:"PtgErr",f:SA},29:{n:"PtgBool",f:NA},30:{n:"PtgInt",f:EA},31:{n:"PtgNum",f:CA},32:{n:"PtgArray",f:iA},33:{n:"PtgFunc",f:gA},34:{n:"PtgFuncVar",f:vA},35:{n:"PtgName",f:kA},36:{n:"PtgRef",f:pA},37:{n:"PtgArea",f:tA},38:{n:"PtgMemArea",f:DA},39:{n:"PtgMemErr",f:LA},40:{n:"PtgMemNoMem",f:MA},41:{n:"PtgMemFunc",f:OA},42:{n:"PtgRefErr",f:IA},43:{n:"PtgAreaErr",f:nA},44:{n:"PtgRefN",f:xA},45:{n:"PtgAreaN",f:aA},46:{n:"PtgMemAreaN",f:e3},47:{n:"PtgMemNoMemN",f:t3},57:{n:"PtgNameX",f:RA},58:{n:"PtgRef3d",f:mA},59:{n:"PtgArea3d",f:rA},60:{n:"PtgRefErr3d",f:PA},61:{n:"PtgAreaErr3d",f:sA},255:{}},n3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},s3={1:{n:"PtgElfLel",f:H2},2:{n:"PtgElfRw",f:XA},3:{n:"PtgElfCol",f:UA},6:{n:"PtgElfRwV",f:qA},7:{n:"PtgElfColV",f:$A},10:{n:"PtgElfRadical",f:HA},11:{n:"PtgElfRadicalS",f:WA},13:{n:"PtgElfColS",f:zA},15:{n:"PtgElfColSV",f:VA},16:{n:"PtgElfRadicalLel",f:GA},25:{n:"PtgList",f:KA},29:{n:"PtgSxName",f:QA},255:{}},a3={0:{n:"PtgAttrNoop",f:r3},1:{n:"PtgAttrSemi",f:dA},2:{n:"PtgAttrIf",f:cA},4:{n:"PtgAttrChoose",f:lA},8:{n:"PtgAttrGoto",f:oA},16:{n:"PtgAttrSum",f:wA},32:{n:"PtgAttrBaxcel",f:em},33:{n:"PtgAttrBaxcel",f:em},64:{n:"PtgAttrSpace",f:fA},65:{n:"PtgAttrSpaceSemi",f:hA},128:{n:"PtgAttrIfError",f:uA},255:{}};function i3(e,t,r,n){if(n.biff<8)return Fn(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=jA(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=AA(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Fn(e,t)),a}function l3(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=tm[a]||tm[n3[a]],(a===24||a===25)&&(s=(a===24?s3:a3)[e[e.l+1]]),!s||!s.f?Fn(e,t):i.push([s.n,s.f(e,t,r)]);return i}function o3(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var c3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function u3(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function G2(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function rm(e,t,r){var n=G2(e,t,r);return n=="#REF"?n:u3(n,r)}function oi(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,u,d,h=0,f=0,p,m="";if(!e[0]||!e[0][0])return"";for(var x=-1,g="",y=0,v=e[0].length;y<v;++y){var w=e[0][y];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:g=_t(" ",e[0][x][1][1]);break;case 1:g=_t("\r",e[0][x][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+g,x=-1}o.push(u+c3[w[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=tl(w[1][1],i,s),o.push(rl(d,a));break;case"PtgRefN":d=r?tl(w[1][1],r,s):w[1][1],o.push(rl(d,a));break;case"PtgRef3d":h=w[1][1],d=tl(w[1][2],i,s),m=rm(n,h,s),o.push(m+"!"+rl(d,a));break;case"PtgFunc":case"PtgFuncVar":var _=w[1][0],S=w[1][1];_||(_=0),_&=127;var P=_==0?[]:o.slice(-_);o.length-=_,S==="User"&&(S=P.shift()),o.push(S+"("+P.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":p=Ux(w[1][1],r?{s:r}:i,s),o.push(o0(p,s));break;case"PtgArea":p=Ux(w[1][1],i,s),o.push(o0(p,s));break;case"PtgArea3d":h=w[1][1],p=w[1][2],m=rm(n,h,s),o.push(m+"!"+o0(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=w[1][2];var N=(n.names||[])[f-1]||(n[0]||[])[f],I=N?N.Name:"SH33TJSNAME"+String(f);I&&I.slice(0,6)=="_xlfn."&&!s.xlfn&&(I=I.slice(6)),o.push(I);break;case"PtgNameX":var M=w[1][1];f=w[1][2];var L;if(s.biff<=5)M<0&&(M=-M),n[M]&&(L=n[M][f]);else{var X="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][f]&&n[M][f].itab>0&&(X=n.SheetNames[n[M][f].itab-1]+"!"):X=n.SheetNames[f-1]+"!"),n[M]&&n[M][f])X+=n[M][f].Name;else if(n[0]&&n[0][f])X+=n[0][f].Name;else{var C=(G2(n,M,s)||"").split(";;");C[f-1]?X=C[f-1]:X+="SH33TJSERRX"}o.push(X);break}L||(L={Name:"SH33TJSERRY"}),o.push(L.Name);break;case"PtgParen":var U="(",z=")";if(x>=0){switch(g="",e[0][x][1][0]){case 2:U=_t(" ",e[0][x][1][1])+U;break;case 3:U=_t("\r",e[0][x][1][1])+U;break;case 4:z=_t(" ",e[0][x][1][1])+z;break;case 5:z=_t("\r",e[0][x][1][1])+z;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(U+o.pop()+z);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var V={c:r.c,r:r.r};if(n.sharedf[rt(d)]){var G=n.sharedf[rt(d)];o.push(oi(G,i,V,n,s))}else{var J=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(oi(u[1],i,V,n,s)),J=!0;break}J||o.push(w[1])}break;case"PtgArray":o.push("{"+o3(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&q.indexOf(e[0][y][0])==-1){w=e[0][x];var se=!0;switch(w[1][0]){case 4:se=!1;case 0:g=_t(" ",w[1][1]);break;case 5:se=!1;case 1:g=_t("\r",w[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((se?g:"")+o.pop()+(se?"":g)),x=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function d3(e){if(e==null){var t=ne(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ca(e);return ca(0)}function f3(e,t,r,n,s){var a=ua(t,r,s),i=d3(e.v),o=ne(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=ne(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var h=Wt([a,i,o,u]);return h}function wu(e,t,r){var n=e.read_shift(4),s=l3(e,n,r),a=e.read_shift(4),i=a>0?i3(e,a,s,r):null;return[s,i]}var h3=wu,_u=wu,p3=wu,x3=wu,m3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},W2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},g3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function v3(e){var t="of:="+e.replace(wh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function y3(e){return e.replace(/\./,"!")}var nl=typeof Map<"u";function Eh(e,t,r){var n=0,s=e.length;if(r){if(nl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=nl?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(nl?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Su(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Wn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Pc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Pd(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function X2(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Bs(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Vv(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function w3(e,t,r){if(e&&e["!ref"]){var n=ft(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function _3(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+kt(e[r])+'"/>';return t+"</mergeCells>"}function S3(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Rl(et(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+_e("outlinePr",null,u)}!a&&!o||(s[s.length]=_e("sheetPr",o,i))}var E3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],N3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function C3(e){var t={sheet:1};return E3.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),N3.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=k2(e.password).toString(16).toUpperCase()),_e("sheetProtection",null,t)}function T3(e){return X2(e),_e("pageMargins",null,e)}function b3(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=_e("col",null,Su(s,n)));return r[r.length]="</cols>",r.join("")}function A3(e,t,r,n){var s=typeof e.ref=="string"?e.ref:kt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Vr(s);i.s.r==i.e.r&&(i.e.r=Vr(t["!ref"]).e.r,s=kt(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),_e("autoFilter",null,{ref:s})}function j3(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),_e("sheetViews",_e("sheetView",null,s),{})}function k3(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Xl[e.v];break;case"d":n&&n.cellDates?s=pr(e.v,-1).toISOString():(e=Fr(e),e.t="n",s=""+(e.v=Rr(pr(e.v)))),typeof e.z>"u"&&(e.z=Et[14]);break;default:s=e.v;break}var o=Xt("v",et(s)),c={r:t},u=Bs(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Xt("v",""+Eh(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=_e("f",et(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),_e("c",o,c)}function R3(e,t,r,n){var s=[],a=[],i=ft(e["!ref"]),o="",c,u="",d=[],h=0,f=0,p=e["!rows"],m=Array.isArray(e),x={r:u},g,y=-1;for(f=i.s.c;f<=i.e.c;++f)d[f]=ar(f);for(h=i.s.r;h<=i.e.r;++h){for(a=[],u=Yt(h),f=i.s.c;f<=i.e.c;++f){c=d[f]+u;var v=m?(e[h]||[])[f]:e[c];v!==void 0&&(o=k3(v,c,e,t))!=null&&a.push(o)}(a.length>0||p&&p[h])&&(x={r:u},p&&p[h]&&(g=p[h],g.hidden&&(x.hidden=1),y=-1,g.hpx?y=Lc(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(x.ht=y,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),s[s.length]=_e("row",a.join(""),x))}if(p)for(;h<p.length;++h)p&&p[h]&&(x={r:h+1},g=p[h],g.hidden&&(x.hidden=1),y=-1,g.hpx?y=Lc(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(x.ht=y,x.customHeight=1),g.level&&(x.outlineLevel=g.level),s[s.length]=_e("row","",x));return s.join("")}function q2(e,t,r,n){var s=[Ft,_e("worksheet",null,{xmlns:gi[0],"xmlns:r":Bt.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=ft(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=kt(d)}n||(n={}),c["!comments"]=[];var h=[];S3(c,r,e,t,s),s[s.length]=_e("dimension",null,{ref:u}),s[s.length]=j3(c,t,e,r),t.sheetFormat&&(s[s.length]=_e("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=b3(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=R3(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=C3(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=A3(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=_3(c["!merges"]));var f=-1,p,m=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(p={ref:x[0]},x[1].Target.charAt(0)!="#"&&(m=Ze(n,-1,et(x[1].Target).replace(/#.*$/,""),Ye.HLINK),p["r:id"]="rId"+m),(f=x[1].Target.indexOf("#"))>-1&&(p.location=et(x[1].Target.slice(f+1))),x[1].Tooltip&&(p.tooltip=et(x[1].Tooltip)),s[s.length]=_e("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=T3(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Xt("ignoredErrors",_e("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(m=Ze(n,-1,"../drawings/drawing"+(e+1)+".xml",Ye.DRAW),s[s.length]=_e("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=h),c["!comments"].length>0&&(m=Ze(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ye.VML),s[s.length]=_e("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function F3(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function D3(e,t,r){var n=ne(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=Lc(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var h=-1,f=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[rt(u)];m&&(h<0&&(h=p),f=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,f))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function O3(e,t,r,n){var s=D3(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&le(e,0,s)}var I3=ga,P3=yi;function L3(){}function M3(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=qC(e),r}function B3(e,t,r){r==null&&(r=ne(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Dc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),c2(e,r),r.slice(0,r.l)}function U3(e){var t=tn(e);return[t]}function z3(e,t,r){return r==null&&(r=ne(8)),pa(t,r)}function V3(e){var t=xa(e);return[t]}function $3(e,t,r){return r==null&&(r=ne(4)),ma(t,r)}function H3(e){var t=tn(e),r=e.read_shift(1);return[t,r,"b"]}function G3(e,t,r){return r==null&&(r=ne(9)),pa(t,r),r.write_shift(1,e.v?1:0),r}function W3(e){var t=xa(e),r=e.read_shift(1);return[t,r,"b"]}function X3(e,t,r){return r==null&&(r=ne(5)),ma(t,r),r.write_shift(1,e.v?1:0),r}function q3(e){var t=tn(e),r=e.read_shift(1);return[t,r,"e"]}function Y3(e,t,r){return r==null&&(r=ne(9)),pa(t,r),r.write_shift(1,e.v),r}function K3(e){var t=xa(e),r=e.read_shift(1);return[t,r,"e"]}function Q3(e,t,r){return r==null&&(r=ne(8)),ma(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function J3(e){var t=tn(e),r=e.read_shift(4);return[t,r,"s"]}function Z3(e,t,r){return r==null&&(r=ne(12)),pa(t,r),r.write_shift(4,t.v),r}function ej(e){var t=xa(e),r=e.read_shift(4);return[t,r,"s"]}function tj(e,t,r){return r==null&&(r=ne(8)),ma(t,r),r.write_shift(4,t.v),r}function rj(e){var t=tn(e),r=wi(e);return[t,r,"n"]}function nj(e,t,r){return r==null&&(r=ne(16)),pa(t,r),ca(e.v,r),r}function sj(e){var t=xa(e),r=wi(e);return[t,r,"n"]}function aj(e,t,r){return r==null&&(r=ne(12)),ma(t,r),ca(e.v,r),r}function ij(e){var t=tn(e),r=u2(e);return[t,r,"n"]}function lj(e,t,r){return r==null&&(r=ne(12)),pa(t,r),d2(e.v,r),r}function oj(e){var t=xa(e),r=u2(e);return[t,r,"n"]}function cj(e,t,r){return r==null&&(r=ne(8)),ma(t,r),d2(e.v,r),r}function uj(e){var t=tn(e),r=xh(e);return[t,r,"is"]}function dj(e){var t=tn(e),r=ir(e);return[t,r,"str"]}function fj(e,t,r){return r==null&&(r=ne(12+4*e.v.length)),pa(t,r),zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hj(e){var t=xa(e),r=ir(e);return[t,r,"str"]}function pj(e,t,r){return r==null&&(r=ne(8+4*e.v.length)),ma(t,r),zt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function xj(e,t,r){var n=e.l+t,s=tn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=_u(e,n-e.l,r);i[3]=oi(o,null,s,r.supbooks,r)}else e.l=n;return i}function mj(e,t,r){var n=e.l+t,s=tn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=_u(e,n-e.l,r);i[3]=oi(o,null,s,r.supbooks,r)}else e.l=n;return i}function gj(e,t,r){var n=e.l+t,s=tn(e);s.r=r["!row"];var a=wi(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=_u(e,n-e.l,r);i[3]=oi(o,null,s,r.supbooks,r)}else e.l=n;return i}function vj(e,t,r){var n=e.l+t,s=tn(e);s.r=r["!row"];var a=ir(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=_u(e,n-e.l,r);i[3]=oi(o,null,s,r.supbooks,r)}else e.l=n;return i}var yj=ga,wj=yi;function _j(e,t){return t==null&&(t=ne(4)),t.write_shift(4,e),t}function Sj(e,t){var r=e.l+t,n=ga(e),s=mh(e),a=ir(e),i=ir(e),o=ir(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function Ej(e,t){var r=ne(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));yi({s:Ut(e[0]),e:Ut(e[0])},r),gh("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return zt(s||"",r),zt(e[1].Tooltip||"",r),zt("",r),r.slice(0,r.l)}function Nj(){}function Cj(e,t,r){var n=e.l+t,s=f2(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=h3(e,n-e.l,r);i[1]=o}else e.l=n;return i}function Tj(e,t,r){var n=e.l+t,s=ga(e),a=[s];if(r.cellFormula){var i=x3(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function bj(e,t,r){r==null&&(r=ne(18));var n=Su(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var Y2=["left","right","top","bottom","header","footer"];function Aj(e){var t={};return Y2.forEach(function(r){t[r]=wi(e)}),t}function jj(e,t){return t==null&&(t=ne(6*8)),X2(e),Y2.forEach(function(r){ca(e[r],t)}),t}function kj(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Rj(e,t,r){r==null&&(r=ne(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Fj(e){var t=ne(24);return t.write_shift(4,4),t.write_shift(4,1),yi(e,t),t}function Dj(e,t){return t==null&&(t=ne(16*4+2)),t.write_shift(2,e.password?k2(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Oj(){}function Ij(){}function Pj(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Fr(t),t.z=t.z||Et[14],t.v=Rr(pr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Bs(s.cellXfs,t,s),t.l&&a["!links"].push([rt(c),t.l]),t.c&&a["!comments"].push([rt(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=Eh(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?le(e,18,tj(t,c)):le(e,7,Z3(t,c))):(c.t="str",i?le(e,17,pj(t,c)):le(e,6,fj(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?le(e,13,cj(t,c)):le(e,2,lj(t,c)):i?le(e,16,aj(t,c)):le(e,5,nj(t,c)),!0;case"b":return c.t="b",i?le(e,15,X3(t,c)):le(e,4,G3(t,c)),!0;case"e":return c.t="e",i?le(e,14,Q3(t,c)):le(e,3,Y3(t,c)),!0}return i?le(e,12,$3(t,c)):le(e,1,z3(t,c)),!0}function Lj(e,t,r,n){var s=ft(t["!ref"]||"A1"),a,i="",o=[];le(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=Yt(d),O3(e,t,s,d);var h=!1;if(d<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){d===s.s.r&&(o[f]=ar(f)),a=o[f]+i;var p=c?(t[d]||[])[f]:t[a];if(!p){h=!1;continue}h=Pj(e,p,d,f,n,t,h)}}le(e,146)}function Mj(e,t){!t||!t["!merges"]||(le(e,177,_j(t["!merges"].length)),t["!merges"].forEach(function(r){le(e,176,wj(r))}),le(e,178))}function Bj(e,t){!t||!t["!cols"]||(le(e,390),t["!cols"].forEach(function(r,n){r&&le(e,60,bj(n,r))}),le(e,391))}function Uj(e,t){!t||!t["!ref"]||(le(e,648),le(e,649,Fj(ft(t["!ref"]))),le(e,650))}function zj(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Ze(r,-1,n[1].Target.replace(/#.*$/,""),Ye.HLINK);le(e,494,Ej(n,s))}}),delete t["!links"]}function Vj(e,t,r,n){if(t["!comments"].length>0){var s=Ze(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ye.VML);le(e,551,gh("rId"+s)),t["!legacy"]=s}}function $j(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:kt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Vr(a);o.s.r==o.e.r&&(o.e.r=Vr(t["!ref"]).e.r,a=kt(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),le(e,161,yi(ft(a))),le(e,162)}}function Hj(e,t,r){le(e,133),le(e,137,Rj(t,r)),le(e,138),le(e,134)}function Gj(e,t){t["!protect"]&&le(e,535,Dj(t["!protect"]))}function Wj(e,t,r,n){var s=jr(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=ft(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],le(s,129),(r.vbaraw||i["!outline"])&&le(s,147,B3(o,i["!outline"])),le(s,148,P3(c)),Hj(s,i,r.Workbook),Bj(s,i),Lj(s,i,e,t),Gj(s,i),$j(s,i,r,e),Mj(s,i),zj(s,i,n),i["!margins"]&&le(s,476,jj(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Uj(s,i),Vj(s,i,e,n),le(s,130),s.end()}function Xj(e,t){e.l+=10;var r=ir(e);return{name:r}}var qj=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Yj(e){return!e.Workbook||!e.Workbook.WBProps?"false":TC(e.Workbook.WBProps.date1904)?"true":"false"}var Kj="][*?/\\".split("");function K2(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Kj.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Qj(e,t,r){e.forEach(function(n,s){K2(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Jj(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Qj(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)w3(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function Q2(e){var t=[Ft];t[t.length]=_e("workbook",null,{xmlns:gi[0],"xmlns:r":Bt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(qj.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=_e("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:et(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=_e("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=_e("definedName",et(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Zj(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Id(e),r.name=ir(e),r}function ek(e,t){return t||(t=ne(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),gh(e.strRelID,t),zt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function tk(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ir(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rk(e,t){t||(t=ne(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),c2(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function nk(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=YC(e),i=p3(e,0,r),o=mh(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function sk(e,t){le(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};le(e,156,ek(s))}le(e,144)}function ak(e,t){t||(t=ne(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return zt("SheetJS",t),zt(Cc.version,t),zt(Cc.version,t),zt("7262",t),t.length>t.l?t.slice(0,t.l):t}function ik(e,t){t||(t=ne(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function lk(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(le(e,135),le(e,158,ik(s)),le(e,136))}}function ok(e,t){var r=jr();return le(r,131),le(r,128,ak()),le(r,153,rk(e.Workbook&&e.Workbook.WBProps||null)),lk(r,e),sk(r,e),le(r,132),r.end()}function ck(e,t,r){return(t.slice(-4)===".bin"?ok:Q2)(e)}function uk(e,t,r,n,s){return(t.slice(-4)===".bin"?Wj:q2)(e,r,n,s)}function dk(e,t,r){return(t.slice(-4)===".bin"?jb:D2)(e,r)}function fk(e,t,r){return(t.slice(-4)===".bin"?rb:j2)(e,r)}function hk(e,t,r){return(t.slice(-4)===".bin"?Gb:M2)(e)}function pk(e){return(e.slice(-4)===".bin"?Lb:P2)()}function xk(e,t){var r=[];return e.Props&&r.push(dT(e.Props,t)),e.Custprops&&r.push(fT(e.Props,e.Custprops)),r.join("")}function mk(){return""}function gk(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(_e("NumberFormat",null,{"ss:Format":et(Et[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(_e("Style",a.join(""),i))}),_e("Styles",r.join(""))}function J2(e){return _e("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+_h(e.Ref,{r:0,c:0})})}function vk(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(J2(s)))}return _e("Names",r.join(""))}function yk(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(J2(o)))}return a.join("")}function wk(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(_e("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(_e("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(_e("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(_e("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Xt("ProtectContents","True")),e["!protect"].objects&&s.push(Xt("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Xt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Xt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Xt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":_e("WorksheetOptions",s.join(""),{xmlns:Pr.x})}function _k(e){return e.map(function(t){var r=CC(t.t||""),n=_e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return _e("Comment",n,{"ss:Author":t.a})}).join("")}function Sk(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+et(_h(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Ut(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=et(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=et(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=Xl[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Et[14]);break;case"s":h="String",f=NC(e.v||"");break}var p=Bs(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var m=e.v!=null?f:"",x=e.t=="z"?"":'<Data ss:Type="'+h+'">'+m+"</Data>";return(e.c||[]).length>0&&(x+=_k(e.c)),_e("Cell",x,o)}function Ek(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=F2(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Nk(e,t,r,n){if(!e["!ref"])return"";var s=ft(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,y){yh(g);var v=!!g.width,w=Su(y,g),_={"ss:Index":y+1};v&&(_["ss:Width"]=Ic(w.width)),g.hidden&&(_["ss:Hidden"]="1"),o.push(_e("Column",null,_))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[Ek(u,(e["!rows"]||[])[u])],h=s.s.c;h<=s.e.c;++h){var f=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>h)&&!(a[i].s.r>u)&&!(a[i].e.c<h)&&!(a[i].e.r<u)){(a[i].s.c!=h||a[i].s.r!=u)&&(f=!0);break}if(!f){var p={r:u,c:h},m=rt(p),x=c?(e[u]||[])[h]:e[m];d.push(Sk(x,m,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function Ck(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?yk(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?Nk(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(wk(a,t,e,r)),n.join("")}function Tk(e,t){t||(t={}),e.SSF||(e.SSF=Fr(Et)),e.SSF&&(gu(),mu(e.SSF),t.revssf=vu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Bs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(xk(e,t)),r.push(mk()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(_e("Worksheet",Ck(n,t,e),{"ss:Name":et(e.SheetNames[n])}));return r[2]=gk(e,t),r[3]=vk(e),Ft+_e("Workbook",r.join(""),{xmlns:Pr.ss,"xmlns:o":Pr.o,"xmlns:x":Pr.x,"xmlns:ss":Pr.ss,"xmlns:dt":Pr.dt,"xmlns:html":Pr.html})}var d0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bk(e,t){var r=[],n=[],s=[],a=0,i,o=jx(Vx,"n"),c=jx($x,"n");if(e.Props)for(i=Qt(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Qt(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)S2.indexOf(s[a][0])>-1||y2.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&nt.utils.cfb_add(t,"/SummaryInformation",qx(n,d0.SI,c,$x)),(r.length||u.length)&&nt.utils.cfb_add(t,"/DocumentSummaryInformation",qx(r,d0.DSI,o,Vx,u.length?u:null,d0.UDI))}function Ak(e,t){var r=t||{},n=nt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return nt.utils.cfb_add(n,s,Z2(e,r)),r.biff==8&&(e.Props||e.Custprops)&&bk(e,n),r.biff==8&&e.vbaraw&&Wb(n,nt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var jk={0:{f:F3},1:{f:U3},2:{f:ij},3:{f:q3},4:{f:H3},5:{f:rj},6:{f:dj},7:{f:J3},8:{f:vj},9:{f:gj},10:{f:xj},11:{f:mj},12:{f:V3},13:{f:oj},14:{f:K3},15:{f:W3},16:{f:sj},17:{f:hj},18:{f:ej},19:{f:xh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nk},40:{},42:{},43:{f:db},44:{f:cb},45:{f:pb},46:{f:mb},47:{f:xb},48:{},49:{f:VC},50:{},51:{f:Fb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$T},62:{f:uj},63:{f:Mb},64:{f:Oj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Fn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:M3},148:{f:I3,p:16},151:{f:Nj},152:{},153:{f:tk},154:{},155:{},156:{f:Zj},157:{},158:{},159:{T:1,f:ZT},160:{T:-1},161:{T:1,f:ga},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:kb},336:{T:-1},337:{f:Ib,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Id},357:{},358:{},359:{},360:{T:1},361:{},362:{f:LT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Cj},427:{f:Tj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Aj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:L3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Sj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Id},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$b},633:{T:1},634:{T:-1},635:{T:1,f:zb},636:{T:-1},637:{f:WC},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Xj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ij},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Se(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&fh(r)&&e.push(r)}}function kk(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Se(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Yl(e,t,r){return e||(e=ne(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Rk(e,t,r,n){var s=ne(9);return Yl(s,e,t),N2(r,n||"b",s),s}function Fk(e,t,r){var n=ne(8+2*r.length);return Yl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Dk(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Rr(pr(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Se(e,2,XT(r,n,s)):Se(e,3,WT(r,n,s));return;case"b":case"e":Se(e,5,Rk(r,n,t.v,t.t));return;case"s":case"str":Se(e,4,Fk(r,n,(t.v||"").slice(0,255)));return}Se(e,1,Yl(null,r,n))}function Ok(e,t,r,n){var s=Array.isArray(t),a=ft(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=kt(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Yt(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=ar(d)),i=c[d]+o;var h=s?(t[u]||[])[d]:t[i];h&&Dk(e,h,u,d)}}}function Ik(e,t){for(var r=t||{},n=jr(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Se(n,r.biff==4?1033:r.biff==3?521:9,vh(e,16,r)),Ok(n,e.Sheets[e.SheetNames[s]],s,r),Se(n,10),n.end()}function Pk(e,t,r){Se(e,49,jT({sz:12,name:"Arial"},r))}function Lk(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Se(e,1054,FT(s,t[s],r))})}function Mk(e,t){var r=ne(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Se(e,2151,r),r=ne(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),b2(ft(t["!ref"]||"A1"),r),r.write_shift(4,4),Se(e,2152,r)}function Bk(e,t){for(var r=0;r<16;++r)Se(e,224,Kx({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Se(e,224,Kx(n,0,t))})}function Uk(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Se(e,440,UT(n)),n[1].Tooltip&&Se(e,2048,zT(n))}delete t["!links"]}function zk(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Se(e,125,HT(Su(s,n),s))})}}function Vk(e,t,r,n,s){var a=16+Bs(s.cellXfs,t,s);if(t.v==null&&!t.bf){Se(e,513,ua(r,n,a));return}if(t.bf)Se(e,6,f3(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Rr(pr(t.v)):t.v;Se(e,515,PT(r,n,i,a));break;case"b":case"e":Se(e,517,IT(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=Eh(s.Strings,t.v,s.revStrings);Se(e,253,kT(r,n,o,a))}else Se(e,516,RT(r,n,(t.v||"").slice(0,255),a,s));break;default:Se(e,513,ua(r,n,a))}}function $k(e,t,r){var n=jr(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,h="",f=[],p=ft(a["!ref"]||"A1"),m=u?65536:16384;if(p.e.c>255||p.e.r>=m){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,m-1)}Se(n,2057,vh(r,16,t)),Se(n,13,Xr(1)),Se(n,12,Xr(100)),Se(n,15,ur(!0)),Se(n,17,ur(!1)),Se(n,16,ca(.001)),Se(n,95,ur(!0)),Se(n,42,ur(!1)),Se(n,43,ur(!1)),Se(n,130,Xr(1)),Se(n,128,OT()),Se(n,131,ur(!1)),Se(n,132,ur(!1)),u&&zk(n,a["!cols"]),Se(n,512,DT(p,t)),u&&(a["!links"]=[]);for(var x=p.s.r;x<=p.e.r;++x){h=Yt(x);for(var g=p.s.c;g<=p.e.c;++g){x===p.s.r&&(f[g]=ar(g)),d=f[g]+h;var y=c?(a[x]||[])[g]:a[d];y&&(Vk(n,y,x,g,t),u&&y.l&&a["!links"].push([d,y.l]))}}var v=o.CodeName||o.name||s;return u&&Se(n,574,AT((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&Se(n,229,BT(a["!merges"])),u&&Uk(n,a),Se(n,442,T2(v)),u&&Mk(n,a),Se(n,10),n.end()}function Hk(e,t,r){var n=jr(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(Se(n,2057,vh(e,5,r)),r.bookType=="xla"&&Se(n,135),Se(n,225,o?Xr(1200):null),Se(n,193,xT(2)),c&&Se(n,191),c&&Se(n,192),Se(n,226),Se(n,92,NT("SheetJS",r)),Se(n,66,Xr(o?1200:1252)),o&&Se(n,353,Xr(0)),o&&Se(n,448),Se(n,317,GT(e.SheetNames.length)),o&&e.vbaraw&&Se(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";Se(n,442,T2(u))}Se(n,156,Xr(17)),Se(n,25,ur(!1)),Se(n,18,ur(!1)),Se(n,19,Xr(0)),o&&Se(n,431,ur(!1)),o&&Se(n,444,Xr(0)),Se(n,61,bT()),Se(n,64,ur(!1)),Se(n,141,Xr(0)),Se(n,34,ur(Yj(e)=="true")),Se(n,14,ur(!0)),o&&Se(n,439,ur(!1)),Se(n,218,Xr(0)),Pk(n,e,r),Lk(n,e.SSF,r),Bk(n,r),o&&Se(n,352,ur(!1));var d=n.end(),h=jr();o&&Se(h,140,VT()),o&&r.Strings&&kk(h,252,TT(r.Strings)),Se(h,10);var f=h.end(),p=jr(),m=0,x=0;for(x=0;x<e.SheetNames.length;++x)m+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var g=d.length+m+f.length;for(x=0;x<e.SheetNames.length;++x){var y=a[x]||{};Se(p,133,CT({pos:g,hs:y.Hidden||0,dt:0,name:e.SheetNames[x]},r)),g+=t[x].length}var v=p.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var w=[];return d.length&&w.push(d),v.length&&w.push(v),f.length&&w.push(f),Wt(w)}function Gk(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Fr(Et)),e&&e.SSF&&(gu(),mu(e.SSF),r.revssf=vu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Nh(r),r.cellXfs=[],Bs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=$k(s,r,e);return n.unshift(Hk(e,n,r)),Wt(n)}function Z2(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Vr(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return Gk(e,t);case 4:case 3:case 2:return Ik(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Wk(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=rt({r,c:i}),h=n.dense?(e[r]||[])[i]:e[d],f=h&&h.v!=null&&(h.h||EC(h.w||(Jn(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),p.id=(n.id||"sjs")+"-"+d,a.push(_e("td",f,p))}}var m="<tr>";return m+a.join("")+"</tr>"}var Xk='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',qk="</body></html>";function Yk(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ey(e,t){var r=t||{},n=r.header!=null?r.header:Xk,s=r.footer!=null?r.footer:qk,a=[n],i=Vr(e["!ref"]);r.dense=Array.isArray(e),a.push(Yk(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(Wk(e,i,o,r));return a.push("</table>"+s),a.join("")}function ty(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Ut(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=Vr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var h=[],f=0,p=e["!rows"]||(e["!rows"]=[]),m=0,x=0,g=0,y=0,v=0,w=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&x<c;++m){var _=o[m];if(nm(_)){if(n.display)continue;p[x]={hidden:!0}}var S=_.children;for(g=y=0;g<S.length;++g){var P=S[g];if(!(n.display&&nm(P))){var N=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):bC(P.innerHTML),I=P.getAttribute("data-z")||P.getAttribute("z");for(f=0;f<h.length;++f){var M=h[f];M.s.c==y+a&&M.s.r<x+s&&x+s<=M.e.r&&(y=M.e.c+1-a,f=-1)}w=+P.getAttribute("colspan")||1,((v=+P.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:x+s,c:y+a},e:{r:x+s+(v||1)-1,c:y+a+(w||1)-1}});var L={t:"s",v:N},X=P.getAttribute("data-t")||P.getAttribute("t")||"";N!=null&&(N.length==0?L.t=X||"z":n.raw||N.trim().length==0||X=="s"||(N==="TRUE"?L={t:"b",v:!0}:N==="FALSE"?L={t:"b",v:!1}:isNaN(Gn(N))?isNaN(kl(N).getDate())||(L={t:"d",v:pr(N)},n.cellDates||(L={t:"n",v:Rr(L.v)}),L.z=n.dateNF||Et[14]):L={t:"n",v:Gn(N)})),L.z===void 0&&I!=null&&(L.z=I);var C="",U=P.getElementsByTagName("A");if(U&&U.length)for(var z=0;z<U.length&&!(U[z].hasAttribute("href")&&(C=U[z].getAttribute("href"),C.charAt(0)!="#"));++z);C&&C.charAt(0)!="#"&&(L.l={Target:C}),n.dense?(e[x+s]||(e[x+s]=[]),e[x+s][y+a]=L):e[rt({c:y+a,r:x+s})]=L,u.e.c<y+a&&(u.e.c=y+a),y+=w}}++x}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,x-1+s),e["!ref"]=kt(u),x>=c&&(e["!fullref"]=kt((u.e.r=o.length-m+x-1+s,u))),e}function ry(e,t){var r=t||{},n=r.dense?[]:{};return ty(n,e,t)}function Kk(e,t){return ha(ry(e,t),t)}function nm(e){var t="",r=Qk(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Qk(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Jk=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Fl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ft+t}}(),sm=function(){var e=function(a){return et(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+et(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,h=Vr(a["!ref"]||"A1"),f=a["!merges"]||[],p=0,m=Array.isArray(a);if(a["!cols"])for(d=0;d<=h.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",g=a["!rows"]||[];for(u=0;u<h.s.r;++u)x=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=h.e.r;++u){for(x=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),d=0;d<h.s.c;++d)c.push(t);for(;d<=h.e.c;++d){var y=!1,v={},w="";for(p=0;p!=f.length;++p)if(!(f[p].s.c>d)&&!(f[p].s.r>u)&&!(f[p].e.c<d)&&!(f[p].e.r<u)){(f[p].s.c!=d||f[p].s.r!=u)&&(y=!0),v["table:number-columns-spanned"]=f[p].e.c-f[p].s.c+1,v["table:number-rows-spanned"]=f[p].e.r-f[p].s.r+1;break}if(y){c.push(r);continue}var _=rt({r:u,c:d}),S=m?(a[u]||[])[d]:a[_];if(S&&S.f&&(v["table:formula"]=et(v3(S.f)),S.F&&S.F.slice(0,_.length)==_)){var P=Vr(S.F);v["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,v["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":w=S.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=S.v?"true":"false";break;case"n":w=S.w||String(S.v||0),v["office:value-type"]="float",v["office:value"]=S.v||0;break;case"s":case"str":w=S.v==null?"":S.v,v["office:value-type"]="string";break;case"d":w=S.w||pr(S.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=pr(S.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var N=e(w);if(S.l&&S.l.Target){var I=S.l.Target;I=I.charAt(0)=="#"?"#"+y3(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),N=_e("text:a",N,{"xlink:href":I.replace(/&/g,"&amp;")})}c.push("          "+_e("table:table-cell",_e("text:p",N,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;yh(h),h.ods=o;var f=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var h=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[Ft],u=Fl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Fl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(g2().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=i.SheetNames.length;++h)c.push(n(i.Sheets[i.SheetNames[h]],i,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function ny(e,t){if(t.bookType=="fods")return sm(e,t);var r=oh(),n="",s=[],a=[];return n="mimetype",Ve(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ve(r,n,sm(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Ve(r,n,Jk(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Ve(r,n,Ft+g2()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Ve(r,n,uT(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ve(r,n,oT(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Mc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zk(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):un(Rl(e))}function eR(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ds(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function tR(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function Dl(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Je(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Qa(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Dt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Dl(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Dl(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function $t(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Je(n*8+s.type)),s.type==2&&t.push(Je(s.data.length)),t.push(s.data))})}),Ds(t)}function sn(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Dl(e,n),a=Dt(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:Qa(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=Dt(o.data),u=Qa(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Qa(a[3][0].data)>>>0>0),r.push(i)}return r}function Sa(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Je(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Je(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:Je(i.data.length)}],n[2].push({data:$t(i.meta),type:2})});var a=$t(n);t.push(Je(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Ds(t)}function rR(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Dl(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Ds(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Ds(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function an(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(rR(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ds(t)}function Ea(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=Je(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Ds(t)}function f0(e,t){var r=new Uint8Array(32),n=Mc(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,tR(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function h0(e,t){var r=new Uint8Array(32),n=Mc(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function rs(e){var t=Dt(e);return Dl(t[1][0].data)}function nR(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Qa(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Mc(e[7][0].data),d=0,h=[],f=Mc(e[4][0].data),p=0,m=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),f.setUint16(x*2,65535);continue}u.setUint16(x*2,d,!0),f.setUint16(x*2,p,!0);var g,y;switch(typeof t[x]){case"string":g=f0({t:"s",v:t[x]},r),y=h0({t:"s",v:t[x]},r);break;case"number":g=f0({t:"n",v:t[x]},r),y=h0({t:"n",v:t[x]},r);break;case"boolean":g=f0({t:"b",v:t[x]},r),y=h0({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}h.push(g),d+=g.length,m.push(y),p+=y.length,++c}for(e[2][0].data=Je(c);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),f.setUint16(x*2,65535,!0);return e[6][0].data=Ds(h),e[3][0].data=Ds(m),c}function sR(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Vr(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(kt(n)));var a=Bc(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(W){return W.forEach(function(B){typeof B=="string"&&i.push(B)})});var o={},c=[],u=nt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(W,B){return[W,u.FullPaths[B]]}).forEach(function(W){var B=W[0],D=W[1];if(B.type==2&&B.name.match(/\.iwa/)){var te=B.content,we=an(te),Ee=sn(we);Ee.forEach(function(xe){c.push(xe.id),o[xe.id]={deps:[],location:D,type:Qa(xe.messages[0].meta[1][0].data)}})}}),c.sort(function(W,B){return W-B});var d=c.filter(function(W){return W>1}).map(function(W){return[W,Je(W)]});u.FileIndex.map(function(W,B){return[W,u.FullPaths[B]]}).forEach(function(W){var B=W[0];if(W[1],!!B.name.match(/\.iwa/)){var D=sn(an(B.content));D.forEach(function(te){te.messages.forEach(function(we){d.forEach(function(Ee){te.messages.some(function(xe){return Qa(xe.meta[1][0].data)!=11006&&eR(xe.data,Ee[1])})&&o[Ee[0]].deps.push(te.id)})})})}});for(var h=nt.find(u,o[1].location),f=sn(an(h.content)),p,m=0;m<f.length;++m){var x=f[m];x.id==1&&(p=x)}var g=rs(Dt(p.messages[0].data)[1][0].data);for(h=nt.find(u,o[g].location),f=sn(an(h.content)),m=0;m<f.length;++m)x=f[m],x.id==g&&(p=x);for(g=rs(Dt(p.messages[0].data)[2][0].data),h=nt.find(u,o[g].location),f=sn(an(h.content)),m=0;m<f.length;++m)x=f[m],x.id==g&&(p=x);for(g=rs(Dt(p.messages[0].data)[2][0].data),h=nt.find(u,o[g].location),f=sn(an(h.content)),m=0;m<f.length;++m)x=f[m],x.id==g&&(p=x);var y=Dt(p.messages[0].data);{y[6][0].data=Je(n.e.r+1),y[7][0].data=Je(n.e.c+1);var v=rs(y[46][0].data),w=nt.find(u,o[v].location),_=sn(an(w.content));{for(var S=0;S<_.length&&_[S].id!=v;++S);if(_[S].id!=v)throw"Bad ColumnRowUIDMapArchive";var P=Dt(_[S].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var N=0;N<=n.e.c;++N){var I=[];I[1]=I[2]=[{type:0,data:Je(N+420690)}],P[1].push({type:2,data:$t(I)}),P[2].push({type:0,data:Je(N)}),P[3].push({type:0,data:Je(N)})}P[4]=[],P[5]=[],P[6]=[];for(var M=0;M<=n.e.r;++M)I=[],I[1]=I[2]=[{type:0,data:Je(M+726270)}],P[4].push({type:2,data:$t(I)}),P[5].push({type:0,data:Je(M)}),P[6].push({type:0,data:Je(M)});_[S].messages[0].data=$t(P)}w.content=Ea(Sa(_)),w.size=w.content.length,delete y[46];var L=Dt(y[4][0].data);{L[7][0].data=Je(n.e.r+1);var X=Dt(L[1][0].data),C=rs(X[2][0].data);w=nt.find(u,o[C].location),_=sn(an(w.content));{if(_[0].id!=C)throw"Bad HeaderStorageBucket";var U=Dt(_[0].messages[0].data);for(M=0;M<a.length;++M){var z=Dt(U[2][0].data);z[1][0].data=Je(M),z[4][0].data=Je(a[M].length),U[2][M]={type:U[2][0].type,data:$t(z)}}_[0].messages[0].data=$t(U)}w.content=Ea(Sa(_)),w.size=w.content.length;var V=rs(L[2][0].data);w=nt.find(u,o[V].location),_=sn(an(w.content));{if(_[0].id!=V)throw"Bad HeaderStorageBucket";for(U=Dt(_[0].messages[0].data),N=0;N<=n.e.c;++N)z=Dt(U[2][0].data),z[1][0].data=Je(N),z[4][0].data=Je(n.e.r+1),U[2][N]={type:U[2][0].type,data:$t(z)};_[0].messages[0].data=$t(U)}w.content=Ea(Sa(_)),w.size=w.content.length;var G=rs(L[4][0].data);(function(){for(var W=nt.find(u,o[G].location),B=sn(an(W.content)),D,te=0;te<B.length;++te){var we=B[te];we.id==G&&(D=we)}var Ee=Dt(D.messages[0].data);{Ee[3]=[];var xe=[];i.forEach(function(ie,je){xe[1]=[{type:0,data:Je(je)}],xe[2]=[{type:0,data:Je(1)}],xe[3]=[{type:2,data:Zk(ie)}],Ee[3].push({type:2,data:$t(xe)})})}D.messages[0].data=$t(Ee);var pe=Sa(B),Le=Ea(pe);W.content=Le,W.size=W.content.length})();var J=Dt(L[3][0].data);{var q=J[1][0];delete J[2];var se=Dt(q.data);{var ue=rs(se[2][0].data);(function(){for(var W=nt.find(u,o[ue].location),B=sn(an(W.content)),D,te=0;te<B.length;++te){var we=B[te];we.id==ue&&(D=we)}var Ee=Dt(D.messages[0].data);{delete Ee[6],delete J[7];var xe=new Uint8Array(Ee[5][0].data);Ee[5]=[];for(var pe=0,Le=0;Le<=n.e.r;++Le){var ie=Dt(xe);pe+=nR(ie,a[Le],i),ie[1][0].data=Je(Le),Ee[5].push({data:$t(ie),type:2})}Ee[1]=[{type:0,data:Je(n.e.c+1)}],Ee[2]=[{type:0,data:Je(n.e.r+1)}],Ee[3]=[{type:0,data:Je(pe)}],Ee[4]=[{type:0,data:Je(n.e.r+1)}]}D.messages[0].data=$t(Ee);var je=Sa(B),ke=Ea(je);W.content=ke,W.size=W.content.length})()}q.data=$t(se)}L[3][0].data=$t(J)}y[4][0].data=$t(L)}p.messages[0].data=$t(y);var fe=Sa(f),R=Ea(fe);return h.content=R,h.size=h.content.length,u}function aR(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Nh(e){aR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function iR(e,t){return t.bookType=="ods"?ny(e,t):t.bookType=="numbers"?sR(e,t):t.bookType=="xlsb"?lR(e,t):oR(e,t)}function lR(e,t){Ba=1024,e&&!e.SSF&&(e.SSF=Fr(Et)),e&&e.SSF&&(gu(),mu(e.SSF),t.revssf=vu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,nl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=B2.indexOf(t.bookType)>-1,s=p2();Nh(t=t||{});var a=oh(),i="",o=0;if(t.cellXfs=[],Bs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ve(a,i,v2(e.Props,t)),s.coreprops.push(i),Ze(t.rels,2,i,Ye.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ve(a,i,w2(e.Props)),s.extprops.push(i),Ze(t.rels,3,i,Ye.EXT_PROPS),e.Custprops!==e.Props&&Qt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ve(a,i,_2(e.Custprops)),s.custprops.push(i),Ze(t.rels,4,i,Ye.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ve(a,i,uk(o-1,i,t,e,d)),s.sheets.push(i),Ze(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ye.WS[0])}if(h){var p=h["!comments"],m=!1,x="";p&&p.length>0&&(x="xl/comments"+o+"."+r,Ve(a,x,hk(p,x)),s.comments.push(x),Ze(d,-1,"../comments"+o+"."+r,Ye.CMNT),m=!0),h["!legacy"]&&m&&Ve(a,"xl/drawings/vmlDrawing"+o+".vml",L2(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ve(a,m2(i),Ya(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ve(a,i,fk(t.Strings,i,t)),s.strs.push(i),Ze(t.wbrels,-1,"sharedStrings."+r,Ye.SST)),i="xl/workbook."+r,Ve(a,i,ck(e,i)),s.workbooks.push(i),Ze(t.rels,1,i,Ye.WB),i="xl/theme/theme1.xml",Ve(a,i,I2(e.Themes,t)),s.themes.push(i),Ze(t.wbrels,-1,"theme/theme1.xml",Ye.THEME),i="xl/styles."+r,Ve(a,i,dk(e,i,t)),s.styles.push(i),Ze(t.wbrels,-1,"styles."+r,Ye.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ve(a,i,e.vbaraw),s.vba.push(i),Ze(t.wbrels,-1,"vbaProject.bin",Ye.VBA)),i="xl/metadata."+r,Ve(a,i,pk(i)),s.metadata.push(i),Ze(t.wbrels,-1,"metadata."+r,Ye.XLMETA),Ve(a,"[Content_Types].xml",x2(s,t)),Ve(a,"_rels/.rels",Ya(t.rels)),Ve(a,"xl/_rels/workbook."+r+".rels",Ya(t.wbrels)),delete t.revssf,delete t.ssf,a}function oR(e,t){Ba=1024,e&&!e.SSF&&(e.SSF=Fr(Et)),e&&e.SSF&&(gu(),mu(e.SSF),t.revssf=vu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,nl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=B2.indexOf(t.bookType)>-1,s=p2();Nh(t=t||{});var a=oh(),i="",o=0;if(t.cellXfs=[],Bs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ve(a,i,v2(e.Props,t)),s.coreprops.push(i),Ze(t.rels,2,i,Ye.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ve(a,i,w2(e.Props)),s.extprops.push(i),Ze(t.rels,3,i,Ye.EXT_PROPS),e.Custprops!==e.Props&&Qt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ve(a,i,_2(e.Custprops)),s.custprops.push(i),Ze(t.rels,4,i,Ye.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ve(a,i,q2(o-1,t,e,h)),s.sheets.push(i),Ze(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ye.WS[0])}if(f){var m=f["!comments"],x=!1,g="";if(m&&m.length>0){var y=!1;m.forEach(function(v){v[1].forEach(function(w){w.T==!0&&(y=!0)})}),y&&(g="xl/threadedComments/threadedComment"+o+"."+r,Ve(a,g,Bb(m,d,t)),s.threadedcomments.push(g),Ze(h,-1,"../threadedComments/threadedComment"+o+"."+r,Ye.TCMNT)),g="xl/comments"+o+"."+r,Ve(a,g,M2(m)),s.comments.push(g),Ze(h,-1,"../comments"+o+"."+r,Ye.CMNT),x=!0}f["!legacy"]&&x&&Ve(a,"xl/drawings/vmlDrawing"+o+".vml",L2(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Ve(a,m2(i),Ya(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ve(a,i,j2(t.Strings,t)),s.strs.push(i),Ze(t.wbrels,-1,"sharedStrings."+r,Ye.SST)),i="xl/workbook."+r,Ve(a,i,Q2(e)),s.workbooks.push(i),Ze(t.rels,1,i,Ye.WB),i="xl/theme/theme1.xml",Ve(a,i,I2(e.Themes,t)),s.themes.push(i),Ze(t.wbrels,-1,"theme/theme1.xml",Ye.THEME),i="xl/styles."+r,Ve(a,i,D2(e,t)),s.styles.push(i),Ze(t.wbrels,-1,"styles."+r,Ye.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ve(a,i,e.vbaraw),s.vba.push(i),Ze(t.wbrels,-1,"vbaProject.bin",Ye.VBA)),i="xl/metadata."+r,Ve(a,i,P2()),s.metadata.push(i),Ze(t.wbrels,-1,"metadata."+r,Ye.XLMETA),d.length>1&&(i="xl/persons/person.xml",Ve(a,i,Ub(d)),s.people.push(i),Ze(t.wbrels,-1,"persons/person.xml",Ye.PEOPLE)),Ve(a,"[Content_Types].xml",x2(s,t)),Ve(a,"_rels/.rels",Ya(t.rels)),Ve(a,"xl/_rels/workbook."+r+".rels",Ya(t.wbrels)),delete t.revssf,delete t.ssf,a}function cR(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Qn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sy(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Gl(t.file,nt.write(e,{type:Qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return nt.write(e,t)}function uR(e,t){var r=Fr(t||{}),n=iR(e,r);return dR(n,r)}function dR(e,t){var r={},n=Qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?nt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(xu(s))}return t.password&&typeof encrypt_agile<"u"?sy(encrypt_agile(s,t.password),t):t.type==="file"?Gl(t.file,s):t.type=="string"?Zi(s):s}function fR(e,t){var r=t||{},n=Ak(e,r);return sy(n,r)}function Nn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return jl(Rl(n));case"binary":return Rl(n);case"string":return e;case"file":return Gl(t.file,n,"utf8");case"buffer":return Qe?es(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Nn(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hR(e,t){switch(t.type){case"base64":return jl(e);case"binary":return e;case"string":return e;case"file":return Gl(t.file,e,"binary");case"buffer":return Qe?es(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function jo(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?jl(r):t.type=="string"?Zi(r):r;case"file":return Gl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function ay(e,t){z4(),Jj(e);var r=Fr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=ay(e,r);return r.type="array",xu(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Nn(Tk(e,r),r);case"slk":case"sylk":return Nn(YT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Nn(ey(e.Sheets[e.SheetNames[s]],r),r);case"txt":return hR(iy(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Nn(Ch(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Nn(KT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return jo(qT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Nn(QT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Nn(sb.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Nn(A2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Nn(ny(e,r),r);case"wk1":return jo(Qx.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return jo(Qx.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),jo(Z2(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),fR(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return uR(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function pR(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function xR(e,t,r){var n={};return n.type="file",n.file=t,pR(n),ay(e,n)}function mR(e,t,r,n,s,a,i,o){var c=Yt(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=i?e[r][p]:e[n[p]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;a[p]!=null&&(f[a[p]]=u);continue}var x=m.v;switch(m.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[p]!=null){if(x==null)if(m.t=="e"&&x===null)f[a[p]]=null;else if(u!==void 0)f[a[p]]=u;else if(d&&x===null)f[a[p]]=null;else continue;else f[a[p]]=d&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?x:Jn(m,x,o);x!=null&&(h=!1)}}return{row:f,isempty:h}}function Bc(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=ft(d);break;case"number":c=ft(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var h=Yt(c.s.r),f=[],p=[],m=0,x=0,g=Array.isArray(e),y=c.s.r,v=0,w={};g&&!e[y]&&(e[y]=[]);var _=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(_[v]||{}).hidden)switch(f[v]=ar(v),r=g?e[y][v]:e[f[v]+h],n){case 1:a[v]=v-c.s.c;break;case 2:a[v]=f[v];break;case 3:a[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Jn(r,null,u),x=w[i]||0,!x)w[i]=1;else{do o=i+"_"+x++;while(w[o]);w[i]=x,w[o]=1}a[v]=o}for(y=c.s.r+s;y<=c.e.r;++y)if(!(S[y]||{}).hidden){var P=mR(e,c,y,f,n,a,g,u);(P.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[m++]=P.row)}return p.length=m,p}var am=/"/g;function gR(e,t,r,n,s,a,i,o){for(var c=!0,u=[],d="",h=Yt(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var p=o.dense?(e[r]||[])[f]:e[n[f]+h];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:Jn(p,null,o));for(var m=0,x=0;m!==d.length;++m)if((x=d.charCodeAt(m))===s||x===a||x===34||o.forceQuotes){d='"'+d.replace(am,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(am,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function Ch(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=ft(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",h=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(f[m]||{}).hidden||(h[m]=ar(m));for(var x=0,g=s.s.r;g<=s.e.r;++g)(p[g]||{}).hidden||(d=gR(e,s,g,h,i,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function iy(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ch(e,t);return r}function vR(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=ft(e["!ref"]),a="",i=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=ar(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=Yt(d),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function ly(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Ut(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var h=ft(a["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),i==-1&&(i=h.e.r+1,d.e.r=i+t.length-1+s)}else i==-1&&(i=0,d.e.r=t.length-1+s);var f=n.header||[],p=0;t.forEach(function(x,g){Qt(x).forEach(function(y){(p=f.indexOf(y))==-1&&(f[p=f.length]=y);var v=x[y],w="z",_="",S=rt({c:o+p,r:i+g+s});u=Ol(a,S),v&&typeof v=="object"&&!(v instanceof Date)?a[S]=v:(typeof v=="number"?w="n":typeof v=="boolean"?w="b":typeof v=="string"?w="s":v instanceof Date?(w="d",n.cellDates||(w="n",v=Rr(v)),_=n.dateNF||Et[14]):v===null&&n.nullError&&(w="e",v=0),u?(u.t=w,u.v=v,delete u.w,delete u.R,_&&(u.z=_)):a[S]=u={t:w,v},_&&(u.z=_))})}),d.e.c=Math.max(d.e.c,o+f.length-1);var m=Yt(i);if(s)for(p=0;p<f.length;++p)a[ar(p+o)+m]={t:"s",v:f[p]};return a["!ref"]=kt(d),a}function yR(e,t){return ly(null,e,t)}function Ol(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ut(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ol(e,rt(t)):Ol(e,rt({r:t,c:r||0}))}function wR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function _R(){return{SheetNames:[],Sheets:{}}}function SR(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(K2(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ER(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=wR(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function NR(e,t){return e.z=t,e}function oy(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function CR(e,t,r){return oy(e,"#"+t,r)}function TR(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function bR(e,t,r,n){for(var s=typeof t!="string"?t:ft(t),a=typeof t=="string"?t:kt(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=Ol(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var p0={encode_col:ar,encode_row:Yt,encode_cell:rt,encode_range:kt,decode_col:ph,decode_row:hh,split_cell:zC,decode_cell:Ut,decode_range:Vr,format_cell:Jn,sheet_add_aoa:o2,sheet_add_json:ly,sheet_add_dom:ty,aoa_to_sheet:vi,json_to_sheet:yR,table_to_sheet:ry,table_to_book:Kk,sheet_to_csv:Ch,sheet_to_txt:iy,sheet_to_json:Bc,sheet_to_html:ey,sheet_to_formulae:vR,sheet_to_row_object_array:Bc,sheet_get_cell:Ol,book_new:_R,book_append_sheet:SR,book_set_sheet_visibility:ER,cell_set_number_format:NR,cell_set_hyperlink:oy,cell_set_internal_link:CR,cell_add_comment:TR,sheet_set_array_formula:bR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Kl=({data:e,fileName:t="Reporte",mapping:r,label:n="Exportar Excel"})=>{const s=()=>{if(!e||e.length===0){alert("No hay datos para exportar.");return}const a=r?e.map(r):e,i=p0.json_to_sheet(a),o=p0.book_new();p0.book_append_sheet(o,i,"Datos");const c=new Date().toISOString().split("T")[0],u=`${t}_${c}.xlsx`;xR(o,u)};return l.jsxs(ot,{variant:"secondary",onClick:s,className:"flex items-center gap-2 text-emerald-700 border-emerald-200 hover:bg-emerald-50",title:"Descargar reporte en Excel",children:[l.jsx(RE,{size:16}),l.jsx("span",{className:"hidden md:inline",children:n})]})};/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function xs(e,t){return typeof e=="function"?e(t):e}function $r(e,t){return r=>{t.setState(n=>({...n,[e]:xs(r,n[e])}))}}function Eu(e){return e instanceof Function}function AR(e){return Array.isArray(e)&&e.every(t=>typeof t=="number")}function jR(e,t){const r=[],n=s=>{s.forEach(a=>{r.push(a);const i=t(a);i!=null&&i.length&&n(i)})};return n(e),r}function Me(e,t,r){let n=[],s;return a=>{let i;r.key&&r.debug&&(i=Date.now());const o=e(a);if(!(o.length!==n.length||o.some((d,h)=>n[h]!==d)))return s;n=o;let u;if(r.key&&r.debug&&(u=Date.now()),s=t(...o),r==null||r.onChange==null||r.onChange(s),r.key&&r.debug&&r!=null&&r.debug()){const d=Math.round((Date.now()-i)*100)/100,h=Math.round((Date.now()-u)*100)/100,f=h/16,p=(m,x)=>{for(m=String(m);m.length<x;)m=" "+m;return m};console.info(`%c ${p(h,5)} /${p(d,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*f,120))}deg 100% 31%);`,r==null?void 0:r.key)}return s}}function Be(e,t,r,n){return{debug:()=>{var s;return(s=e==null?void 0:e.debugAll)!=null?s:e[t]},key:!1,onChange:n}}function kR(e,t,r,n){const s=()=>{var i;return(i=a.getValue())!=null?i:e.options.renderFallbackValue},a={id:`${t.id}_${r.id}`,row:t,column:r,getValue:()=>t.getValue(n),renderValue:s,getContext:Me(()=>[e,r,t,a],(i,o,c,u)=>({table:i,column:o,row:c,cell:u,getValue:u.getValue,renderValue:u.renderValue}),Be(e.options,"debugCells"))};return e._features.forEach(i=>{i.createCell==null||i.createCell(a,r,t,e)},{}),a}function RR(e,t,r,n){var s,a;const o={...e._getDefaultColumnDef(),...t},c=o.accessorKey;let u=(s=(a=o.id)!=null?a:c?typeof String.prototype.replaceAll=="function"?c.replaceAll(".","_"):c.replace(/\./g,"_"):void 0)!=null?s:typeof o.header=="string"?o.header:void 0,d;if(o.accessorFn?d=o.accessorFn:c&&(c.includes(".")?d=f=>{let p=f;for(const x of c.split(".")){var m;p=(m=p)==null?void 0:m[x]}return p}:d=f=>f[o.accessorKey]),!u)throw new Error;let h={id:`${String(u)}`,accessorFn:d,parent:n,depth:r,columnDef:o,columns:[],getFlatColumns:Me(()=>[!0],()=>{var f;return[h,...(f=h.columns)==null?void 0:f.flatMap(p=>p.getFlatColumns())]},Be(e.options,"debugColumns")),getLeafColumns:Me(()=>[e._getOrderColumnsFn()],f=>{var p;if((p=h.columns)!=null&&p.length){let m=h.columns.flatMap(x=>x.getLeafColumns());return f(m)}return[h]},Be(e.options,"debugColumns"))};for(const f of e._features)f.createColumn==null||f.createColumn(h,e);return h}const tr="debugHeaders";function im(e,t,r){var n;let a={id:(n=r.id)!=null?n:t.id,column:t,index:r.index,isPlaceholder:!!r.isPlaceholder,placeholderId:r.placeholderId,depth:r.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const i=[],o=c=>{c.subHeaders&&c.subHeaders.length&&c.subHeaders.map(o),i.push(c)};return o(a),i},getContext:()=>({table:e,header:a,column:t})};return e._features.forEach(i=>{i.createHeader==null||i.createHeader(a,e)}),a}const FR={createTable:e=>{e.getHeaderGroups=Me(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,s)=>{var a,i;const o=(a=n==null?void 0:n.map(h=>r.find(f=>f.id===h)).filter(Boolean))!=null?a:[],c=(i=s==null?void 0:s.map(h=>r.find(f=>f.id===h)).filter(Boolean))!=null?i:[],u=r.filter(h=>!(n!=null&&n.includes(h.id))&&!(s!=null&&s.includes(h.id)));return ko(t,[...o,...u,...c],e)},Be(e.options,tr)),e.getCenterHeaderGroups=Me(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,s)=>(r=r.filter(a=>!(n!=null&&n.includes(a.id))&&!(s!=null&&s.includes(a.id))),ko(t,r,e,"center")),Be(e.options,tr)),e.getLeftHeaderGroups=Me(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,r,n)=>{var s;const a=(s=n==null?void 0:n.map(i=>r.find(o=>o.id===i)).filter(Boolean))!=null?s:[];return ko(t,a,e,"left")},Be(e.options,tr)),e.getRightHeaderGroups=Me(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,r,n)=>{var s;const a=(s=n==null?void 0:n.map(i=>r.find(o=>o.id===i)).filter(Boolean))!=null?s:[];return ko(t,a,e,"right")},Be(e.options,tr)),e.getFooterGroups=Me(()=>[e.getHeaderGroups()],t=>[...t].reverse(),Be(e.options,tr)),e.getLeftFooterGroups=Me(()=>[e.getLeftHeaderGroups()],t=>[...t].reverse(),Be(e.options,tr)),e.getCenterFooterGroups=Me(()=>[e.getCenterHeaderGroups()],t=>[...t].reverse(),Be(e.options,tr)),e.getRightFooterGroups=Me(()=>[e.getRightHeaderGroups()],t=>[...t].reverse(),Be(e.options,tr)),e.getFlatHeaders=Me(()=>[e.getHeaderGroups()],t=>t.map(r=>r.headers).flat(),Be(e.options,tr)),e.getLeftFlatHeaders=Me(()=>[e.getLeftHeaderGroups()],t=>t.map(r=>r.headers).flat(),Be(e.options,tr)),e.getCenterFlatHeaders=Me(()=>[e.getCenterHeaderGroups()],t=>t.map(r=>r.headers).flat(),Be(e.options,tr)),e.getRightFlatHeaders=Me(()=>[e.getRightHeaderGroups()],t=>t.map(r=>r.headers).flat(),Be(e.options,tr)),e.getCenterLeafHeaders=Me(()=>[e.getCenterFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),Be(e.options,tr)),e.getLeftLeafHeaders=Me(()=>[e.getLeftFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),Be(e.options,tr)),e.getRightLeafHeaders=Me(()=>[e.getRightFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),Be(e.options,tr)),e.getLeafHeaders=Me(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(t,r,n)=>{var s,a,i,o,c,u;return[...(s=(a=t[0])==null?void 0:a.headers)!=null?s:[],...(i=(o=r[0])==null?void 0:o.headers)!=null?i:[],...(c=(u=n[0])==null?void 0:u.headers)!=null?c:[]].map(d=>d.getLeafHeaders()).flat()},Be(e.options,tr))}};function ko(e,t,r,n){var s,a;let i=0;const o=function(f,p){p===void 0&&(p=1),i=Math.max(i,p),f.filter(m=>m.getIsVisible()).forEach(m=>{var x;(x=m.columns)!=null&&x.length&&o(m.columns,p+1)},0)};o(e);let c=[];const u=(f,p)=>{const m={depth:p,id:[n,`${p}`].filter(Boolean).join("_"),headers:[]},x=[];f.forEach(g=>{const y=[...x].reverse()[0],v=g.column.depth===m.depth;let w,_=!1;if(v&&g.column.parent?w=g.column.parent:(w=g.column,_=!0),y&&(y==null?void 0:y.column)===w)y.subHeaders.push(g);else{const S=im(r,w,{id:[n,p,w.id,g==null?void 0:g.id].filter(Boolean).join("_"),isPlaceholder:_,placeholderId:_?`${x.filter(P=>P.column===w).length}`:void 0,depth:p,index:x.length});S.subHeaders.push(g),x.push(S)}m.headers.push(g),g.headerGroup=m}),c.push(m),p>0&&u(x,p-1)},d=t.map((f,p)=>im(r,f,{depth:i,index:p}));u(d,i-1),c.reverse();const h=f=>f.filter(m=>m.column.getIsVisible()).map(m=>{let x=0,g=0,y=[0];m.subHeaders&&m.subHeaders.length?(y=[],h(m.subHeaders).forEach(w=>{let{colSpan:_,rowSpan:S}=w;x+=_,y.push(S)})):x=1;const v=Math.min(...y);return g=g+v,m.colSpan=x,m.rowSpan=g,{colSpan:x,rowSpan:g}});return h((s=(a=c[0])==null?void 0:a.headers)!=null?s:[]),c}const Th=(e,t,r,n,s,a,i)=>{let o={id:t,index:n,original:r,depth:s,parentId:i,_valuesCache:{},_uniqueValuesCache:{},getValue:c=>{if(o._valuesCache.hasOwnProperty(c))return o._valuesCache[c];const u=e.getColumn(c);if(u!=null&&u.accessorFn)return o._valuesCache[c]=u.accessorFn(o.original,n),o._valuesCache[c]},getUniqueValues:c=>{if(o._uniqueValuesCache.hasOwnProperty(c))return o._uniqueValuesCache[c];const u=e.getColumn(c);if(u!=null&&u.accessorFn)return u.columnDef.getUniqueValues?(o._uniqueValuesCache[c]=u.columnDef.getUniqueValues(o.original,n),o._uniqueValuesCache[c]):(o._uniqueValuesCache[c]=[o.getValue(c)],o._uniqueValuesCache[c])},renderValue:c=>{var u;return(u=o.getValue(c))!=null?u:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>jR(o.subRows,c=>c.subRows),getParentRow:()=>o.parentId?e.getRow(o.parentId,!0):void 0,getParentRows:()=>{let c=[],u=o;for(;;){const d=u.getParentRow();if(!d)break;c.push(d),u=d}return c.reverse()},getAllCells:Me(()=>[e.getAllLeafColumns()],c=>c.map(u=>kR(e,o,u,u.id)),Be(e.options,"debugRows")),_getAllCellsByColumnId:Me(()=>[o.getAllCells()],c=>c.reduce((u,d)=>(u[d.column.id]=d,u),{}),Be(e.options,"debugRows"))};for(let c=0;c<e._features.length;c++){const u=e._features[c];u==null||u.createRow==null||u.createRow(o,e)}return o},DR={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},cy=(e,t,r)=>{var n,s;const a=r==null||(n=r.toString())==null?void 0:n.toLowerCase();return!!(!((s=e.getValue(t))==null||(s=s.toString())==null||(s=s.toLowerCase())==null)&&s.includes(a))};cy.autoRemove=e=>gn(e);const uy=(e,t,r)=>{var n;return!!(!((n=e.getValue(t))==null||(n=n.toString())==null)&&n.includes(r))};uy.autoRemove=e=>gn(e);const dy=(e,t,r)=>{var n;return((n=e.getValue(t))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(r==null?void 0:r.toLowerCase())};dy.autoRemove=e=>gn(e);const fy=(e,t,r)=>{var n;return(n=e.getValue(t))==null?void 0:n.includes(r)};fy.autoRemove=e=>gn(e);const hy=(e,t,r)=>!r.some(n=>{var s;return!((s=e.getValue(t))!=null&&s.includes(n))});hy.autoRemove=e=>gn(e)||!(e!=null&&e.length);const py=(e,t,r)=>r.some(n=>{var s;return(s=e.getValue(t))==null?void 0:s.includes(n)});py.autoRemove=e=>gn(e)||!(e!=null&&e.length);const xy=(e,t,r)=>e.getValue(t)===r;xy.autoRemove=e=>gn(e);const my=(e,t,r)=>e.getValue(t)==r;my.autoRemove=e=>gn(e);const bh=(e,t,r)=>{let[n,s]=r;const a=e.getValue(t);return a>=n&&a<=s};bh.resolveFilterValue=e=>{let[t,r]=e,n=typeof t!="number"?parseFloat(t):t,s=typeof r!="number"?parseFloat(r):r,a=t===null||Number.isNaN(n)?-1/0:n,i=r===null||Number.isNaN(s)?1/0:s;if(a>i){const o=a;a=i,i=o}return[a,i]};bh.autoRemove=e=>gn(e)||gn(e[0])&&gn(e[1]);const Mn={includesString:cy,includesStringSensitive:uy,equalsString:dy,arrIncludes:fy,arrIncludesAll:hy,arrIncludesSome:py,equals:xy,weakEquals:my,inNumberRange:bh};function gn(e){return e==null||e===""}const OR={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:$r("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);return typeof n=="string"?Mn.includesString:typeof n=="number"?Mn.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?Mn.equals:Array.isArray(n)?Mn.arrIncludes:Mn.weakEquals},e.getFilterFn=()=>{var r,n;return Eu(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(r=(n=t.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?r:Mn[e.columnDef.filterFn]},e.getCanFilter=()=>{var r,n,s;return((r=e.columnDef.enableColumnFilter)!=null?r:!0)&&((n=t.options.enableColumnFilters)!=null?n:!0)&&((s=t.options.enableFilters)!=null?s:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var r;return(r=t.getState().columnFilters)==null||(r=r.find(n=>n.id===e.id))==null?void 0:r.value},e.getFilterIndex=()=>{var r,n;return(r=(n=t.getState().columnFilters)==null?void 0:n.findIndex(s=>s.id===e.id))!=null?r:-1},e.setFilterValue=r=>{t.setColumnFilters(n=>{const s=e.getFilterFn(),a=n==null?void 0:n.find(d=>d.id===e.id),i=xs(r,a?a.value:void 0);if(lm(s,i,e)){var o;return(o=n==null?void 0:n.filter(d=>d.id!==e.id))!=null?o:[]}const c={id:e.id,value:i};if(a){var u;return(u=n==null?void 0:n.map(d=>d.id===e.id?c:d))!=null?u:[]}return n!=null&&n.length?[...n,c]:[c]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const r=e.getAllLeafColumns(),n=s=>{var a;return(a=xs(t,s))==null?void 0:a.filter(i=>{const o=r.find(c=>c.id===i.id);if(o){const c=o.getFilterFn();if(lm(c,i.value,o))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=t=>{var r,n;e.setColumnFilters(t?[]:(r=(n=e.initialState)==null?void 0:n.columnFilters)!=null?r:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function lm(e,t,r){return(e&&e.autoRemove?e.autoRemove(t,r):!1)||typeof t>"u"||typeof t=="string"&&!t}const IR=(e,t,r)=>r.reduce((n,s)=>{const a=s.getValue(e);return n+(typeof a=="number"?a:0)},0),PR=(e,t,r)=>{let n;return r.forEach(s=>{const a=s.getValue(e);a!=null&&(n>a||n===void 0&&a>=a)&&(n=a)}),n},LR=(e,t,r)=>{let n;return r.forEach(s=>{const a=s.getValue(e);a!=null&&(n<a||n===void 0&&a>=a)&&(n=a)}),n},MR=(e,t,r)=>{let n,s;return r.forEach(a=>{const i=a.getValue(e);i!=null&&(n===void 0?i>=i&&(n=s=i):(n>i&&(n=i),s<i&&(s=i)))}),[n,s]},BR=(e,t)=>{let r=0,n=0;if(t.forEach(s=>{let a=s.getValue(e);a!=null&&(a=+a)>=a&&(++r,n+=a)}),r)return n/r},UR=(e,t)=>{if(!t.length)return;const r=t.map(a=>a.getValue(e));if(!AR(r))return;if(r.length===1)return r[0];const n=Math.floor(r.length/2),s=r.sort((a,i)=>a-i);return r.length%2!==0?s[n]:(s[n-1]+s[n])/2},zR=(e,t)=>Array.from(new Set(t.map(r=>r.getValue(e))).values()),VR=(e,t)=>new Set(t.map(r=>r.getValue(e))).size,$R=(e,t)=>t.length,x0={sum:IR,min:PR,max:LR,extent:MR,mean:BR,median:UR,unique:zR,uniqueCount:VR,count:$R},HR={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,r;return(t=(r=e.getValue())==null||r.toString==null?void 0:r.toString())!=null?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:$r("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(r=>r!=null&&r.includes(e.id)?r.filter(n=>n!==e.id):[...r??[],e.id])},e.getCanGroup=()=>{var r,n;return((r=e.columnDef.enableGrouping)!=null?r:!0)&&((n=t.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.includes(e.id)},e.getGroupedIndex=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const r=e.getCanGroup();return()=>{r&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);if(typeof n=="number")return x0.sum;if(Object.prototype.toString.call(n)==="[object Date]")return x0.extent},e.getAggregationFn=()=>{var r,n;if(!e)throw new Error;return Eu(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(r=(n=t.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?r:x0[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var r,n;e.setGrouping(t?[]:(r=(n=e.initialState)==null?void 0:n.grouping)!=null?r:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=r=>{if(e._groupingValuesCache.hasOwnProperty(r))return e._groupingValuesCache[r];const n=t.getColumn(r);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[r]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[r]):e.getValue(r)},e._groupingValuesCache={}},createCell:(e,t,r,n)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===r.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var s;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((s=r.subRows)!=null&&s.length)}}};function GR(e,t,r){if(!(t!=null&&t.length)||!r)return e;const n=e.filter(a=>!t.includes(a.id));return r==="remove"?n:[...t.map(a=>e.find(i=>i.id===a)).filter(Boolean),...n]}const WR={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:$r("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=Me(r=>[sl(t,r)],r=>r.findIndex(n=>n.id===e.id),Be(t.options,"debugColumns")),e.getIsFirstColumn=r=>{var n;return((n=sl(t,r)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=r=>{var n;const s=sl(t,r);return((n=s[s.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var r;e.setColumnOrder(t?[]:(r=e.initialState.columnOrder)!=null?r:[])},e._getOrderColumnsFn=Me(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(t,r,n)=>s=>{let a=[];if(!(t!=null&&t.length))a=s;else{const i=[...t],o=[...s];for(;o.length&&i.length;){const c=i.shift(),u=o.findIndex(d=>d.id===c);u>-1&&a.push(o.splice(u,1)[0])}a=[...a,...o]}return GR(a,r,n)},Be(e.options,"debugTable"))}},m0=()=>({left:[],right:[]}),XR={getInitialState:e=>({columnPinning:m0(),...e}),getDefaultOptions:e=>({onColumnPinningChange:$r("columnPinning",e)}),createColumn:(e,t)=>{e.pin=r=>{const n=e.getLeafColumns().map(s=>s.id).filter(Boolean);t.setColumnPinning(s=>{var a,i;if(r==="right"){var o,c;return{left:((o=s==null?void 0:s.left)!=null?o:[]).filter(h=>!(n!=null&&n.includes(h))),right:[...((c=s==null?void 0:s.right)!=null?c:[]).filter(h=>!(n!=null&&n.includes(h))),...n]}}if(r==="left"){var u,d;return{left:[...((u=s==null?void 0:s.left)!=null?u:[]).filter(h=>!(n!=null&&n.includes(h))),...n],right:((d=s==null?void 0:s.right)!=null?d:[]).filter(h=>!(n!=null&&n.includes(h)))}}return{left:((a=s==null?void 0:s.left)!=null?a:[]).filter(h=>!(n!=null&&n.includes(h))),right:((i=s==null?void 0:s.right)!=null?i:[]).filter(h=>!(n!=null&&n.includes(h)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var s,a,i;return((s=n.columnDef.enablePinning)!=null?s:!0)&&((a=(i=t.options.enableColumnPinning)!=null?i:t.options.enablePinning)!=null?a:!0)}),e.getIsPinned=()=>{const r=e.getLeafColumns().map(o=>o.id),{left:n,right:s}=t.getState().columnPinning,a=r.some(o=>n==null?void 0:n.includes(o)),i=r.some(o=>s==null?void 0:s.includes(o));return a?"left":i?"right":!1},e.getPinnedIndex=()=>{var r,n;const s=e.getIsPinned();return s?(r=(n=t.getState().columnPinning)==null||(n=n[s])==null?void 0:n.indexOf(e.id))!=null?r:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=Me(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(r,n,s)=>{const a=[...n??[],...s??[]];return r.filter(i=>!a.includes(i.column.id))},Be(t.options,"debugRows")),e.getLeftVisibleCells=Me(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(r,n)=>(n??[]).map(a=>r.find(i=>i.column.id===a)).filter(Boolean).map(a=>({...a,position:"left"})),Be(t.options,"debugRows")),e.getRightVisibleCells=Me(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(r,n)=>(n??[]).map(a=>r.find(i=>i.column.id===a)).filter(Boolean).map(a=>({...a,position:"right"})),Be(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var r,n;return e.setColumnPinning(t?m0():(r=(n=e.initialState)==null?void 0:n.columnPinning)!=null?r:m0())},e.getIsSomeColumnsPinned=t=>{var r;const n=e.getState().columnPinning;if(!t){var s,a;return!!((s=n.left)!=null&&s.length||(a=n.right)!=null&&a.length)}return!!((r=n[t])!=null&&r.length)},e.getLeftLeafColumns=Me(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(t,r)=>(r??[]).map(n=>t.find(s=>s.id===n)).filter(Boolean),Be(e.options,"debugColumns")),e.getRightLeafColumns=Me(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(t,r)=>(r??[]).map(n=>t.find(s=>s.id===n)).filter(Boolean),Be(e.options,"debugColumns")),e.getCenterLeafColumns=Me(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n)=>{const s=[...r??[],...n??[]];return t.filter(a=>!s.includes(a.id))},Be(e.options,"debugColumns"))}};function qR(e){return e||(typeof document<"u"?document:null)}const Ro={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},g0=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),YR={getDefaultColumnDef:()=>Ro,getInitialState:e=>({columnSizing:{},columnSizingInfo:g0(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:$r("columnSizing",e),onColumnSizingInfoChange:$r("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var r,n,s;const a=t.getState().columnSizing[e.id];return Math.min(Math.max((r=e.columnDef.minSize)!=null?r:Ro.minSize,(n=a??e.columnDef.size)!=null?n:Ro.size),(s=e.columnDef.maxSize)!=null?s:Ro.maxSize)},e.getStart=Me(r=>[r,sl(t,r),t.getState().columnSizing],(r,n)=>n.slice(0,e.getIndex(r)).reduce((s,a)=>s+a.getSize(),0),Be(t.options,"debugColumns")),e.getAfter=Me(r=>[r,sl(t,r),t.getState().columnSizing],(r,n)=>n.slice(e.getIndex(r)+1).reduce((s,a)=>s+a.getSize(),0),Be(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(r=>{let{[e.id]:n,...s}=r;return s})},e.getCanResize=()=>{var r,n;return((r=e.columnDef.enableResizing)!=null?r:!0)&&((n=t.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let r=0;const n=s=>{if(s.subHeaders.length)s.subHeaders.forEach(n);else{var a;r+=(a=s.column.getSize())!=null?a:0}};return n(e),r},e.getStart=()=>{if(e.index>0){const r=e.headerGroup.headers[e.index-1];return r.getStart()+r.getSize()}return 0},e.getResizeHandler=r=>{const n=t.getColumn(e.column.id),s=n==null?void 0:n.getCanResize();return a=>{if(!n||!s||(a.persist==null||a.persist(),v0(a)&&a.touches&&a.touches.length>1))return;const i=e.getSize(),o=e?e.getLeafHeaders().map(y=>[y.column.id,y.column.getSize()]):[[n.id,n.getSize()]],c=v0(a)?Math.round(a.touches[0].clientX):a.clientX,u={},d=(y,v)=>{typeof v=="number"&&(t.setColumnSizingInfo(w=>{var _,S;const P=t.options.columnResizeDirection==="rtl"?-1:1,N=(v-((_=w==null?void 0:w.startOffset)!=null?_:0))*P,I=Math.max(N/((S=w==null?void 0:w.startSize)!=null?S:0),-.999999);return w.columnSizingStart.forEach(M=>{let[L,X]=M;u[L]=Math.round(Math.max(X+X*I,0)*100)/100}),{...w,deltaOffset:N,deltaPercentage:I}}),(t.options.columnResizeMode==="onChange"||y==="end")&&t.setColumnSizing(w=>({...w,...u})))},h=y=>d("move",y),f=y=>{d("end",y),t.setColumnSizingInfo(v=>({...v,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},p=qR(r),m={moveHandler:y=>h(y.clientX),upHandler:y=>{p==null||p.removeEventListener("mousemove",m.moveHandler),p==null||p.removeEventListener("mouseup",m.upHandler),f(y.clientX)}},x={moveHandler:y=>(y.cancelable&&(y.preventDefault(),y.stopPropagation()),h(y.touches[0].clientX),!1),upHandler:y=>{var v;p==null||p.removeEventListener("touchmove",x.moveHandler),p==null||p.removeEventListener("touchend",x.upHandler),y.cancelable&&(y.preventDefault(),y.stopPropagation()),f((v=y.touches[0])==null?void 0:v.clientX)}},g=KR()?{passive:!1}:!1;v0(a)?(p==null||p.addEventListener("touchmove",x.moveHandler,g),p==null||p.addEventListener("touchend",x.upHandler,g)):(p==null||p.addEventListener("mousemove",m.moveHandler,g),p==null||p.addEventListener("mouseup",m.upHandler,g)),t.setColumnSizingInfo(y=>({...y,startOffset:c,startSize:i,deltaOffset:0,deltaPercentage:0,columnSizingStart:o,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=t=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var r;e.setColumnSizing(t?{}:(r=e.initialState.columnSizing)!=null?r:{})},e.resetHeaderSizeInfo=t=>{var r;e.setColumnSizingInfo(t?g0():(r=e.initialState.columnSizingInfo)!=null?r:g0())},e.getTotalSize=()=>{var t,r;return(t=(r=e.getHeaderGroups()[0])==null?void 0:r.headers.reduce((n,s)=>n+s.getSize(),0))!=null?t:0},e.getLeftTotalSize=()=>{var t,r;return(t=(r=e.getLeftHeaderGroups()[0])==null?void 0:r.headers.reduce((n,s)=>n+s.getSize(),0))!=null?t:0},e.getCenterTotalSize=()=>{var t,r;return(t=(r=e.getCenterHeaderGroups()[0])==null?void 0:r.headers.reduce((n,s)=>n+s.getSize(),0))!=null?t:0},e.getRightTotalSize=()=>{var t,r;return(t=(r=e.getRightHeaderGroups()[0])==null?void 0:r.headers.reduce((n,s)=>n+s.getSize(),0))!=null?t:0}}};let Fo=null;function KR(){if(typeof Fo=="boolean")return Fo;let e=!1;try{const t={get passive(){return e=!0,!1}},r=()=>{};window.addEventListener("test",r,t),window.removeEventListener("test",r)}catch{e=!1}return Fo=e,Fo}function v0(e){return e.type==="touchstart"}const QR={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:$r("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=r=>{e.getCanHide()&&t.setColumnVisibility(n=>({...n,[e.id]:r??!e.getIsVisible()}))},e.getIsVisible=()=>{var r,n;const s=e.columns;return(r=s.length?s.some(a=>a.getIsVisible()):(n=t.getState().columnVisibility)==null?void 0:n[e.id])!=null?r:!0},e.getCanHide=()=>{var r,n;return((r=e.columnDef.enableHiding)!=null?r:!0)&&((n=t.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>r=>{e.toggleVisibility==null||e.toggleVisibility(r.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=Me(()=>[e.getAllCells(),t.getState().columnVisibility],r=>r.filter(n=>n.column.getIsVisible()),Be(t.options,"debugRows")),e.getVisibleCells=Me(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(r,n,s)=>[...r,...n,...s],Be(t.options,"debugRows"))},createTable:e=>{const t=(r,n)=>Me(()=>[n(),n().filter(s=>s.getIsVisible()).map(s=>s.id).join("_")],s=>s.filter(a=>a.getIsVisible==null?void 0:a.getIsVisible()),Be(e.options,"debugColumns"));e.getVisibleFlatColumns=t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=r=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(r),e.resetColumnVisibility=r=>{var n;e.setColumnVisibility(r?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=r=>{var n;r=(n=r)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((s,a)=>({...s,[a.id]:r||!(a.getCanHide!=null&&a.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(r=>!(r.getIsVisible!=null&&r.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(r=>r.getIsVisible==null?void 0:r.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>r=>{var n;e.toggleAllColumnsVisible((n=r.target)==null?void 0:n.checked)}}};function sl(e,t){return t?t==="center"?e.getCenterVisibleLeafColumns():t==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const JR={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},ZR={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:$r("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var r;const n=(r=e.getCoreRowModel().flatRows[0])==null||(r=r._getAllCellsByColumnId()[t.id])==null?void 0:r.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var r,n,s,a;return((r=e.columnDef.enableGlobalFilter)!=null?r:!0)&&((n=t.options.enableGlobalFilter)!=null?n:!0)&&((s=t.options.enableFilters)!=null?s:!0)&&((a=t.options.getColumnCanGlobalFilter==null?void 0:t.options.getColumnCanGlobalFilter(e))!=null?a:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>Mn.includesString,e.getGlobalFilterFn=()=>{var t,r;const{globalFilterFn:n}=e.options;return Eu(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(t=(r=e.options.filterFns)==null?void 0:r[n])!=null?t:Mn[n]},e.setGlobalFilter=t=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},eF={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:$r("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,r=!1;e._autoResetExpanded=()=>{var n,s;if(!t){e._queue(()=>{t=!0});return}if((n=(s=e.options.autoResetAll)!=null?s:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(r)return;r=!0,e._queue(()=>{e.resetExpanded(),r=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var s,a;e.setExpanded(n?{}:(s=(a=e.initialState)==null?void 0:a.expanded)!=null?s:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(s=>!s.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(a=>{const i=a.split(".");n=Math.max(n,i.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=r=>{t.setExpanded(n=>{var s;const a=n===!0?!0:!!(n!=null&&n[e.id]);let i={};if(n===!0?Object.keys(t.getRowModel().rowsById).forEach(o=>{i[o]=!0}):i=n,r=(s=r)!=null?s:!a,!a&&r)return{...i,[e.id]:!0};if(a&&!r){const{[e.id]:o,...c}=i;return c}return n})},e.getIsExpanded=()=>{var r;const n=t.getState().expanded;return!!((r=t.options.getIsRowExpanded==null?void 0:t.options.getIsRowExpanded(e))!=null?r:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var r,n,s;return(r=t.options.getRowCanExpand==null?void 0:t.options.getRowCanExpand(e))!=null?r:((n=t.options.enableExpanding)!=null?n:!0)&&!!((s=e.subRows)!=null&&s.length)},e.getIsAllParentsExpanded=()=>{let r=!0,n=e;for(;r&&n.parentId;)n=t.getRow(n.parentId,!0),r=n.getIsExpanded();return r},e.getToggleExpandedHandler=()=>{const r=e.getCanExpand();return()=>{r&&e.toggleExpanded()}}}},Ld=0,Md=10,y0=()=>({pageIndex:Ld,pageSize:Md}),tF={getInitialState:e=>({...e,pagination:{...y0(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:$r("pagination",e)}),createTable:e=>{let t=!1,r=!1;e._autoResetPageIndex=()=>{var n,s;if(!t){e._queue(()=>{t=!0});return}if((n=(s=e.options.autoResetAll)!=null?s:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(r)return;r=!0,e._queue(()=>{e.resetPageIndex(),r=!1})}},e.setPagination=n=>{const s=a=>xs(n,a);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(s)},e.resetPagination=n=>{var s;e.setPagination(n?y0():(s=e.initialState.pagination)!=null?s:y0())},e.setPageIndex=n=>{e.setPagination(s=>{let a=xs(n,s.pageIndex);const i=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return a=Math.max(0,Math.min(a,i)),{...s,pageIndex:a}})},e.resetPageIndex=n=>{var s,a;e.setPageIndex(n?Ld:(s=(a=e.initialState)==null||(a=a.pagination)==null?void 0:a.pageIndex)!=null?s:Ld)},e.resetPageSize=n=>{var s,a;e.setPageSize(n?Md:(s=(a=e.initialState)==null||(a=a.pagination)==null?void 0:a.pageSize)!=null?s:Md)},e.setPageSize=n=>{e.setPagination(s=>{const a=Math.max(1,xs(n,s.pageSize)),i=s.pageSize*s.pageIndex,o=Math.floor(i/a);return{...s,pageIndex:o,pageSize:a}})},e.setPageCount=n=>e.setPagination(s=>{var a;let i=xs(n,(a=e.options.pageCount)!=null?a:-1);return typeof i=="number"&&(i=Math.max(-1,i)),{...s,pageCount:i}}),e.getPageOptions=Me(()=>[e.getPageCount()],n=>{let s=[];return n&&n>0&&(s=[...new Array(n)].fill(null).map((a,i)=>i)),s},Be(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,s=e.getPageCount();return s===-1?!0:s===0?!1:n<s-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},w0=()=>({top:[],bottom:[]}),rF={getInitialState:e=>({rowPinning:w0(),...e}),getDefaultOptions:e=>({onRowPinningChange:$r("rowPinning",e)}),createRow:(e,t)=>{e.pin=(r,n,s)=>{const a=n?e.getLeafRows().map(c=>{let{id:u}=c;return u}):[],i=s?e.getParentRows().map(c=>{let{id:u}=c;return u}):[],o=new Set([...i,e.id,...a]);t.setRowPinning(c=>{var u,d;if(r==="bottom"){var h,f;return{top:((h=c==null?void 0:c.top)!=null?h:[]).filter(x=>!(o!=null&&o.has(x))),bottom:[...((f=c==null?void 0:c.bottom)!=null?f:[]).filter(x=>!(o!=null&&o.has(x))),...Array.from(o)]}}if(r==="top"){var p,m;return{top:[...((p=c==null?void 0:c.top)!=null?p:[]).filter(x=>!(o!=null&&o.has(x))),...Array.from(o)],bottom:((m=c==null?void 0:c.bottom)!=null?m:[]).filter(x=>!(o!=null&&o.has(x)))}}return{top:((u=c==null?void 0:c.top)!=null?u:[]).filter(x=>!(o!=null&&o.has(x))),bottom:((d=c==null?void 0:c.bottom)!=null?d:[]).filter(x=>!(o!=null&&o.has(x)))}})},e.getCanPin=()=>{var r;const{enableRowPinning:n,enablePinning:s}=t.options;return typeof n=="function"?n(e):(r=n??s)!=null?r:!0},e.getIsPinned=()=>{const r=[e.id],{top:n,bottom:s}=t.getState().rowPinning,a=r.some(o=>n==null?void 0:n.includes(o)),i=r.some(o=>s==null?void 0:s.includes(o));return a?"top":i?"bottom":!1},e.getPinnedIndex=()=>{var r,n;const s=e.getIsPinned();if(!s)return-1;const a=(r=s==="top"?t.getTopRows():t.getBottomRows())==null?void 0:r.map(i=>{let{id:o}=i;return o});return(n=a==null?void 0:a.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=t=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var r,n;return e.setRowPinning(t?w0():(r=(n=e.initialState)==null?void 0:n.rowPinning)!=null?r:w0())},e.getIsSomeRowsPinned=t=>{var r;const n=e.getState().rowPinning;if(!t){var s,a;return!!((s=n.top)!=null&&s.length||(a=n.bottom)!=null&&a.length)}return!!((r=n[t])!=null&&r.length)},e._getPinnedRows=(t,r,n)=>{var s;return((s=e.options.keepPinnedRows)==null||s?(r??[]).map(i=>{const o=e.getRow(i,!0);return o.getIsAllParentsExpanded()?o:null}):(r??[]).map(i=>t.find(o=>o.id===i))).filter(Boolean).map(i=>({...i,position:n}))},e.getTopRows=Me(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,r)=>e._getPinnedRows(t,r,"top"),Be(e.options,"debugRows")),e.getBottomRows=Me(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,r)=>e._getPinnedRows(t,r,"bottom"),Be(e.options,"debugRows")),e.getCenterRows=Me(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(t,r,n)=>{const s=new Set([...r??[],...n??[]]);return t.filter(a=>!s.has(a.id))},Be(e.options,"debugRows"))}},nF={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:$r("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var r;return e.setRowSelection(t?{}:(r=e.initialState.rowSelection)!=null?r:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(r=>{t=typeof t<"u"?t:!e.getIsAllRowsSelected();const n={...r},s=e.getPreGroupedRowModel().flatRows;return t?s.forEach(a=>{a.getCanSelect()&&(n[a.id]=!0)}):s.forEach(a=>{delete n[a.id]}),n})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(r=>{const n=typeof t<"u"?t:!e.getIsAllPageRowsSelected(),s={...r};return e.getRowModel().rows.forEach(a=>{Bd(s,a.id,n,!0,e)}),s}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=Me(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,r)=>Object.keys(t).length?_0(e,r):{rows:[],flatRows:[],rowsById:{}},Be(e.options,"debugTable")),e.getFilteredSelectedRowModel=Me(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,r)=>Object.keys(t).length?_0(e,r):{rows:[],flatRows:[],rowsById:{}},Be(e.options,"debugTable")),e.getGroupedSelectedRowModel=Me(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,r)=>Object.keys(t).length?_0(e,r):{rows:[],flatRows:[],rowsById:{}},Be(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:r}=e.getState();let n=!!(t.length&&Object.keys(r).length);return n&&t.some(s=>s.getCanSelect()&&!r[s.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(s=>s.getCanSelect()),{rowSelection:r}=e.getState();let n=!!t.length;return n&&t.some(s=>!r[s.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var t;const r=Object.keys((t=e.getState().rowSelection)!=null?t:{}).length;return r>0&&r<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:t.filter(r=>r.getCanSelect()).some(r=>r.getIsSelected()||r.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(r,n)=>{const s=e.getIsSelected();t.setRowSelection(a=>{var i;if(r=typeof r<"u"?r:!s,e.getCanSelect()&&s===r)return a;const o={...a};return Bd(o,e.id,r,(i=n==null?void 0:n.selectChildren)!=null?i:!0,t),o})},e.getIsSelected=()=>{const{rowSelection:r}=t.getState();return Ah(e,r)},e.getIsSomeSelected=()=>{const{rowSelection:r}=t.getState();return Ud(e,r)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:r}=t.getState();return Ud(e,r)==="all"},e.getCanSelect=()=>{var r;return typeof t.options.enableRowSelection=="function"?t.options.enableRowSelection(e):(r=t.options.enableRowSelection)!=null?r:!0},e.getCanSelectSubRows=()=>{var r;return typeof t.options.enableSubRowSelection=="function"?t.options.enableSubRowSelection(e):(r=t.options.enableSubRowSelection)!=null?r:!0},e.getCanMultiSelect=()=>{var r;return typeof t.options.enableMultiRowSelection=="function"?t.options.enableMultiRowSelection(e):(r=t.options.enableMultiRowSelection)!=null?r:!0},e.getToggleSelectedHandler=()=>{const r=e.getCanSelect();return n=>{var s;r&&e.toggleSelected((s=n.target)==null?void 0:s.checked)}}}},Bd=(e,t,r,n,s)=>{var a;const i=s.getRow(t,!0);r?(i.getCanMultiSelect()||Object.keys(e).forEach(o=>delete e[o]),i.getCanSelect()&&(e[t]=!0)):delete e[t],n&&(a=i.subRows)!=null&&a.length&&i.getCanSelectSubRows()&&i.subRows.forEach(o=>Bd(e,o.id,r,n,s))};function _0(e,t){const r=e.getState().rowSelection,n=[],s={},a=function(i,o){return i.map(c=>{var u;const d=Ah(c,r);if(d&&(n.push(c),s[c.id]=c),(u=c.subRows)!=null&&u.length&&(c={...c,subRows:a(c.subRows)}),d)return c}).filter(Boolean)};return{rows:a(t.rows),flatRows:n,rowsById:s}}function Ah(e,t){var r;return(r=t[e.id])!=null?r:!1}function Ud(e,t,r){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let s=!0,a=!1;return e.subRows.forEach(i=>{if(!(a&&!s)&&(i.getCanSelect()&&(Ah(i,t)?a=!0:s=!1),i.subRows&&i.subRows.length)){const o=Ud(i,t);o==="all"?a=!0:(o==="some"&&(a=!0),s=!1)}}),s?"all":a?"some":!1}const zd=/([0-9]+)/gm,sF=(e,t,r)=>gy(Os(e.getValue(r)).toLowerCase(),Os(t.getValue(r)).toLowerCase()),aF=(e,t,r)=>gy(Os(e.getValue(r)),Os(t.getValue(r))),iF=(e,t,r)=>jh(Os(e.getValue(r)).toLowerCase(),Os(t.getValue(r)).toLowerCase()),lF=(e,t,r)=>jh(Os(e.getValue(r)),Os(t.getValue(r))),oF=(e,t,r)=>{const n=e.getValue(r),s=t.getValue(r);return n>s?1:n<s?-1:0},cF=(e,t,r)=>jh(e.getValue(r),t.getValue(r));function jh(e,t){return e===t?0:e>t?1:-1}function Os(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function gy(e,t){const r=e.split(zd).filter(Boolean),n=t.split(zd).filter(Boolean);for(;r.length&&n.length;){const s=r.shift(),a=n.shift(),i=parseInt(s,10),o=parseInt(a,10),c=[i,o].sort();if(isNaN(c[0])){if(s>a)return 1;if(a>s)return-1;continue}if(isNaN(c[1]))return isNaN(i)?-1:1;if(i>o)return 1;if(o>i)return-1}return r.length-n.length}const Ii={alphanumeric:sF,alphanumericCaseSensitive:aF,text:iF,textCaseSensitive:lF,datetime:oF,basic:cF},uF={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:$r("sorting",e),isMultiSortEvent:t=>t.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const r=t.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const s of r){const a=s==null?void 0:s.getValue(e.id);if(Object.prototype.toString.call(a)==="[object Date]")return Ii.datetime;if(typeof a=="string"&&(n=!0,a.split(zd).length>1))return Ii.alphanumeric}return n?Ii.text:Ii.basic},e.getAutoSortDir=()=>{const r=t.getFilteredRowModel().flatRows[0];return typeof(r==null?void 0:r.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var r,n;if(!e)throw new Error;return Eu(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(r=(n=t.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?r:Ii[e.columnDef.sortingFn]},e.toggleSorting=(r,n)=>{const s=e.getNextSortingOrder(),a=typeof r<"u"&&r!==null;t.setSorting(i=>{const o=i==null?void 0:i.find(p=>p.id===e.id),c=i==null?void 0:i.findIndex(p=>p.id===e.id);let u=[],d,h=a?r:s==="desc";if(i!=null&&i.length&&e.getCanMultiSort()&&n?o?d="toggle":d="add":i!=null&&i.length&&c!==i.length-1?d="replace":o?d="toggle":d="replace",d==="toggle"&&(a||s||(d="remove")),d==="add"){var f;u=[...i,{id:e.id,desc:h}],u.splice(0,u.length-((f=t.options.maxMultiSortColCount)!=null?f:Number.MAX_SAFE_INTEGER))}else d==="toggle"?u=i.map(p=>p.id===e.id?{...p,desc:h}:p):d==="remove"?u=i.filter(p=>p.id!==e.id):u=[{id:e.id,desc:h}];return u})},e.getFirstSortDir=()=>{var r,n;return((r=(n=e.columnDef.sortDescFirst)!=null?n:t.options.sortDescFirst)!=null?r:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=r=>{var n,s;const a=e.getFirstSortDir(),i=e.getIsSorted();return i?i!==a&&((n=t.options.enableSortingRemoval)==null||n)&&(!(r&&(s=t.options.enableMultiRemove)!=null)||s)?!1:i==="desc"?"asc":"desc":a},e.getCanSort=()=>{var r,n;return((r=e.columnDef.enableSorting)!=null?r:!0)&&((n=t.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var r,n;return(r=(n=e.columnDef.enableMultiSort)!=null?n:t.options.enableMultiSort)!=null?r:!!e.accessorFn},e.getIsSorted=()=>{var r;const n=(r=t.getState().sorting)==null?void 0:r.find(s=>s.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var r,n;return(r=(n=t.getState().sorting)==null?void 0:n.findIndex(s=>s.id===e.id))!=null?r:-1},e.clearSorting=()=>{t.setSorting(r=>r!=null&&r.length?r.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const r=e.getCanSort();return n=>{r&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?t.options.isMultiSortEvent==null?void 0:t.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=t=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var r,n;e.setSorting(t?[]:(r=(n=e.initialState)==null?void 0:n.sorting)!=null?r:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},dF=[FR,QR,WR,XR,DR,OR,JR,ZR,uF,HR,eF,tF,rF,nF,YR];function fF(e){var t,r;const n=[...dF,...(t=e._features)!=null?t:[]];let s={_features:n};const a=s._features.reduce((f,p)=>Object.assign(f,p.getDefaultOptions==null?void 0:p.getDefaultOptions(s)),{}),i=f=>s.options.mergeOptions?s.options.mergeOptions(a,f):{...a,...f};let c={...{},...(r=e.initialState)!=null?r:{}};s._features.forEach(f=>{var p;c=(p=f.getInitialState==null?void 0:f.getInitialState(c))!=null?p:c});const u=[];let d=!1;const h={_features:n,options:{...a,...e},initialState:c,_queue:f=>{u.push(f),d||(d=!0,Promise.resolve().then(()=>{for(;u.length;)u.shift()();d=!1}).catch(p=>setTimeout(()=>{throw p})))},reset:()=>{s.setState(s.initialState)},setOptions:f=>{const p=xs(f,s.options);s.options=i(p)},getState:()=>s.options.state,setState:f=>{s.options.onStateChange==null||s.options.onStateChange(f)},_getRowId:(f,p,m)=>{var x;return(x=s.options.getRowId==null?void 0:s.options.getRowId(f,p,m))!=null?x:`${m?[m.id,p].join("."):p}`},getCoreRowModel:()=>(s._getCoreRowModel||(s._getCoreRowModel=s.options.getCoreRowModel(s)),s._getCoreRowModel()),getRowModel:()=>s.getPaginationRowModel(),getRow:(f,p)=>{let m=(p?s.getPrePaginationRowModel():s.getRowModel()).rowsById[f];if(!m&&(m=s.getCoreRowModel().rowsById[f],!m))throw new Error;return m},_getDefaultColumnDef:Me(()=>[s.options.defaultColumn],f=>{var p;return f=(p=f)!=null?p:{},{header:m=>{const x=m.header.column.columnDef;return x.accessorKey?x.accessorKey:x.accessorFn?x.id:null},cell:m=>{var x,g;return(x=(g=m.renderValue())==null||g.toString==null?void 0:g.toString())!=null?x:null},...s._features.reduce((m,x)=>Object.assign(m,x.getDefaultColumnDef==null?void 0:x.getDefaultColumnDef()),{}),...f}},Be(e,"debugColumns")),_getColumnDefs:()=>s.options.columns,getAllColumns:Me(()=>[s._getColumnDefs()],f=>{const p=function(m,x,g){return g===void 0&&(g=0),m.map(y=>{const v=RR(s,y,g,x),w=y;return v.columns=w.columns?p(w.columns,v,g+1):[],v})};return p(f)},Be(e,"debugColumns")),getAllFlatColumns:Me(()=>[s.getAllColumns()],f=>f.flatMap(p=>p.getFlatColumns()),Be(e,"debugColumns")),_getAllFlatColumnsById:Me(()=>[s.getAllFlatColumns()],f=>f.reduce((p,m)=>(p[m.id]=m,p),{}),Be(e,"debugColumns")),getAllLeafColumns:Me(()=>[s.getAllColumns(),s._getOrderColumnsFn()],(f,p)=>{let m=f.flatMap(x=>x.getLeafColumns());return p(m)},Be(e,"debugColumns")),getColumn:f=>s._getAllFlatColumnsById()[f]};Object.assign(s,h);for(let f=0;f<s._features.length;f++){const p=s._features[f];p==null||p.createTable==null||p.createTable(s)}return s}function hF(){return e=>Me(()=>[e.options.data],t=>{const r={rows:[],flatRows:[],rowsById:{}},n=function(s,a,i){a===void 0&&(a=0);const o=[];for(let u=0;u<s.length;u++){const d=Th(e,e._getRowId(s[u],u,i),s[u],u,a,void 0,i==null?void 0:i.id);if(r.flatRows.push(d),r.rowsById[d.id]=d,o.push(d),e.options.getSubRows){var c;d.originalSubRows=e.options.getSubRows(s[u],u),(c=d.originalSubRows)!=null&&c.length&&(d.subRows=n(d.originalSubRows,a+1,d))}}return o};return r.rows=n(t),r},Be(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function pF(e){const t=[],r=n=>{var s;t.push(n),(s=n.subRows)!=null&&s.length&&n.getIsExpanded()&&n.subRows.forEach(r)};return e.rows.forEach(r),{rows:t,flatRows:e.flatRows,rowsById:e.rowsById}}function xF(e,t,r){return r.options.filterFromLeafRows?mF(e,t,r):gF(e,t,r)}function mF(e,t,r){var n;const s=[],a={},i=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,o=function(c,u){u===void 0&&(u=0);const d=[];for(let f=0;f<c.length;f++){var h;let p=c[f];const m=Th(r,p.id,p.original,p.index,p.depth,void 0,p.parentId);if(m.columnFilters=p.columnFilters,(h=p.subRows)!=null&&h.length&&u<i){if(m.subRows=o(p.subRows,u+1),p=m,t(p)&&!m.subRows.length){d.push(p),a[p.id]=p,s.push(p);continue}if(t(p)||m.subRows.length){d.push(p),a[p.id]=p,s.push(p);continue}}else p=m,t(p)&&(d.push(p),a[p.id]=p,s.push(p))}return d};return{rows:o(e),flatRows:s,rowsById:a}}function gF(e,t,r){var n;const s=[],a={},i=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,o=function(c,u){u===void 0&&(u=0);const d=[];for(let f=0;f<c.length;f++){let p=c[f];if(t(p)){var h;if((h=p.subRows)!=null&&h.length&&u<i){const x=Th(r,p.id,p.original,p.index,p.depth,void 0,p.parentId);x.subRows=o(p.subRows,u+1),p=x}d.push(p),s.push(p),a[p.id]=p}}return d};return{rows:o(e),flatRows:s,rowsById:a}}function vF(){return e=>Me(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(t,r,n)=>{if(!t.rows.length||!(r!=null&&r.length)&&!n){for(let f=0;f<t.flatRows.length;f++)t.flatRows[f].columnFilters={},t.flatRows[f].columnFiltersMeta={};return t}const s=[],a=[];(r??[]).forEach(f=>{var p;const m=e.getColumn(f.id);if(!m)return;const x=m.getFilterFn();x&&s.push({id:f.id,filterFn:x,resolvedValue:(p=x.resolveFilterValue==null?void 0:x.resolveFilterValue(f.value))!=null?p:f.value})});const i=(r??[]).map(f=>f.id),o=e.getGlobalFilterFn(),c=e.getAllLeafColumns().filter(f=>f.getCanGlobalFilter());n&&o&&c.length&&(i.push("__global__"),c.forEach(f=>{var p;a.push({id:f.id,filterFn:o,resolvedValue:(p=o.resolveFilterValue==null?void 0:o.resolveFilterValue(n))!=null?p:n})}));let u,d;for(let f=0;f<t.flatRows.length;f++){const p=t.flatRows[f];if(p.columnFilters={},s.length)for(let m=0;m<s.length;m++){u=s[m];const x=u.id;p.columnFilters[x]=u.filterFn(p,x,u.resolvedValue,g=>{p.columnFiltersMeta[x]=g})}if(a.length){for(let m=0;m<a.length;m++){d=a[m];const x=d.id;if(d.filterFn(p,x,d.resolvedValue,g=>{p.columnFiltersMeta[x]=g})){p.columnFilters.__global__=!0;break}}p.columnFilters.__global__!==!0&&(p.columnFilters.__global__=!1)}}const h=f=>{for(let p=0;p<i.length;p++)if(f.columnFilters[i[p]]===!1)return!1;return!0};return xF(t.rows,h,e)},Be(e.options,"debugTable","getFilteredRowModel",()=>e._autoResetPageIndex()))}function yF(e){return t=>Me(()=>[t.getState().pagination,t.getPrePaginationRowModel(),t.options.paginateExpandedRows?void 0:t.getState().expanded],(r,n)=>{if(!n.rows.length)return n;const{pageSize:s,pageIndex:a}=r;let{rows:i,flatRows:o,rowsById:c}=n;const u=s*a,d=u+s;i=i.slice(u,d);let h;t.options.paginateExpandedRows?h={rows:i,flatRows:o,rowsById:c}:h=pF({rows:i,flatRows:o,rowsById:c}),h.flatRows=[];const f=p=>{h.flatRows.push(p),p.subRows.length&&p.subRows.forEach(f)};return h.rows.forEach(f),h},Be(t.options,"debugTable"))}function wF(){return e=>Me(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,r)=>{if(!r.rows.length||!(t!=null&&t.length))return r;const n=e.getState().sorting,s=[],a=n.filter(c=>{var u;return(u=e.getColumn(c.id))==null?void 0:u.getCanSort()}),i={};a.forEach(c=>{const u=e.getColumn(c.id);u&&(i[c.id]={sortUndefined:u.columnDef.sortUndefined,invertSorting:u.columnDef.invertSorting,sortingFn:u.getSortingFn()})});const o=c=>{const u=c.map(d=>({...d}));return u.sort((d,h)=>{for(let p=0;p<a.length;p+=1){var f;const m=a[p],x=i[m.id],g=x.sortUndefined,y=(f=m==null?void 0:m.desc)!=null?f:!1;let v=0;if(g){const w=d.getValue(m.id),_=h.getValue(m.id),S=w===void 0,P=_===void 0;if(S||P){if(g==="first")return S?-1:1;if(g==="last")return S?1:-1;v=S&&P?0:S?g:-g}}if(v===0&&(v=x.sortingFn(d,h,m.id)),v!==0)return y&&(v*=-1),x.invertSorting&&(v*=-1),v}return d.index-h.index}),u.forEach(d=>{var h;s.push(d),(h=d.subRows)!=null&&h.length&&(d.subRows=o(d.subRows))}),u};return{rows:o(r.rows),flatRows:s,rowsById:r.rowsById}},Be(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function om(e,t){return e?_F(e)?b.createElement(e,t):e:null}function _F(e){return SF(e)||typeof e=="function"||EF(e)}function SF(e){return typeof e=="function"&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()}function EF(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function NF(e){const t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[r]=b.useState(()=>({current:fF(t)})),[n,s]=b.useState(()=>r.current.initialState);return r.current.setOptions(a=>({...a,...e,state:{...n,...e.state},onStateChange:i=>{s(i),e.onStateChange==null||e.onStateChange(i)}})),r.current}function CF({columns:e,data:t,searchKey:r="name",toolbar:n}){var h;const[s,a]=b.useState([]),[i,o]=b.useState([]),[c,u]=b.useState({}),d=NF({data:t,columns:e,getCoreRowModel:hF(),getPaginationRowModel:yF(),getSortedRowModel:wF(),getFilteredRowModel:vF(),onSortingChange:a,onColumnFiltersChange:o,onColumnVisibilityChange:u,initialState:{pagination:{pageSize:1e4,pageIndex:0}},state:{sorting:s,columnFilters:i,columnVisibility:c}});return l.jsxs("div",{className:"space-y-4",children:[n&&l.jsx(n,{table:d}),l.jsx("div",{className:"rounded-md border border-slate-200 bg-white shadow-sm overflow-hidden flex flex-col",children:l.jsx("div",{className:"relative w-full overflow-auto h-[65vh] lg:h-[75vh]",children:l.jsxs("table",{className:"w-full caption-bottom text-sm text-left relative",children:[l.jsx("thead",{className:"sticky top-0 z-20 bg-slate-50 border-b border-slate-200 shadow-sm",children:d.getHeaderGroups().map(f=>l.jsx("tr",{children:f.headers.map(p=>l.jsx("th",{className:"h-12 px-6 align-middle font-bold text-slate-500 uppercase text-xs [&:has([role=checkbox])]:pr-0 bg-slate-50",children:p.isPlaceholder?null:om(p.column.columnDef.header,p.getContext())},p.id))},f.id))}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:(h=d.getRowModel().rows)!=null&&h.length?d.getRowModel().rows.map(f=>l.jsx("tr",{"data-state":f.getIsSelected()&&"selected",className:"transition-colors hover:bg-slate-50/80",children:f.getVisibleCells().map(p=>l.jsx("td",{className:"p-6 align-middle [&:has([role=checkbox])]:pr-0",children:om(p.column.columnDef.cell,p.getContext())},p.id))},f.id)):l.jsx("tr",{children:l.jsx("td",{colSpan:e.length,className:"h-24 text-center text-slate-400",children:"No se encontraron resultados."})})})]})})}),l.jsx("div",{className:"flex items-center justify-between px-2",children:l.jsxs("div",{className:"text-xs text-slate-400 font-medium",children:["Mostrando ",d.getRowModel().rows.length," registros (Scroll infinito)"]})})]})}function TF({table:e}){var s,a,i,o;const t=e.getState().columnFilters.length>0,r=((s=e.getColumn("category"))==null?void 0:s.getFilterValue())??"ALL",n=b.useMemo(()=>{const c=e.getPreFilteredRowModel().rows,u=new Set;return c.forEach(d=>{const h=d.getValue("category");h&&u.add(h)}),Array.from(u).sort()},[e.getPreFilteredRowModel().rows]);return l.jsx("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 py-4 bg-white p-4 rounded-lg border border-slate-200 shadow-sm mb-4",children:l.jsxs("div",{className:"flex flex-1 flex-wrap items-center gap-3 w-full",children:[l.jsxs("div",{className:"relative w-full md:w-auto",children:[l.jsx(ii,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-slate-400"}),l.jsx("input",{placeholder:"Buscar por Nombre...",value:((a=e.getColumn("name"))==null?void 0:a.getFilterValue())??"",onChange:c=>{var u;return(u=e.getColumn("name"))==null?void 0:u.setFilterValue(c.target.value)},className:"h-9 w-full md:w-[250px] pl-9 pr-4 rounded-md border border-slate-300 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.getColumn("category")&&l.jsx("div",{className:"relative",children:l.jsxs("select",{value:r,className:"h-9 rounded-md border border-slate-300 bg-white px-3 py-1 text-sm text-slate-700 shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",onChange:c=>{var d,h;const u=c.target.value;u==="ALL"?(d=e.getColumn("category"))==null||d.setFilterValue(void 0):(h=e.getColumn("category"))==null||h.setFilterValue(u)},children:[l.jsx("option",{value:"ALL",children:"Todas las Categoras"}),n.map(c=>l.jsx("option",{value:c,children:c},c))]})}),e.getColumn("physical_stock")&&l.jsxs("label",{className:"flex items-center space-x-2 rounded-md border border-slate-200 px-3 py-1.5 hover:bg-slate-50 cursor-pointer bg-slate-50/50",children:[l.jsx("input",{type:"checkbox",checked:((o=(i=e.getColumn("physical_stock"))==null?void 0:i.getFilterValue())==null?void 0:o[0])===.01,className:"h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500",onChange:c=>{var d,h;c.target.checked?(d=e.getColumn("physical_stock"))==null||d.setFilterValue(f=>[.01,1e6]):(h=e.getColumn("physical_stock"))==null||h.setFilterValue(void 0)}}),l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Con Existencias"})]}),t&&l.jsxs("button",{onClick:()=>e.resetColumnFilters(),className:"h-9 px-3 text-sm font-medium text-slate-500 hover:text-slate-900 flex items-center gap-2 hover:bg-slate-100 rounded-md transition-colors",children:["Limpiar",l.jsx(kr,{className:"h-4 w-4"})]})]})})}function bF(){const{materials:e,createMaterial:t,updateMaterial:r,deleteMaterial:n}=Av(),s=b.useRef(null),[a,i]=b.useState(""),[o,c]=b.useState(!1),[u,d]=b.useState(!1),[h,f]=b.useState(null),[p,m]=b.useState(!1),x={sku:"",name:"",category:"",production_route:"MATERIAL",purchase_unit:"",usage_unit:"",conversion_factor:1,current_cost:0,associated_element_sku:""},[g,y]=b.useState(x);b.useEffect(()=>{const G=(localStorage.getItem("user_role")||"").toUpperCase().trim();i(G)},[]);const v=a==="SALES"||a==="VENTAS",w=["DESIGN","DISEO","DISENO"].includes(a),_=["PRODUCTION","PRODUCCION","PRODUCCIN"].includes(a),S=w||_,P=["ADMIN","ADMINISTRADOR","DIRECTION","DIRECCION","PRODUCTION","PRODUCCION"].includes(a),N=b.useMemo(()=>{const G=[{accessorKey:"sku",size:120,header:({column:J})=>l.jsxs("button",{className:"flex items-center gap-1 hover:text-indigo-600 transition-colors",onClick:()=>J.toggleSorting(J.getIsSorted()==="asc"),children:["SKU",l.jsx(wo,{className:"h-3 w-3"})]}),cell:({row:J})=>l.jsx("span",{className:"font-mono text-xs text-indigo-600 font-bold",children:J.original.sku})},{accessorKey:"name",header:({column:J})=>l.jsxs("button",{className:"flex items-center gap-1 hover:text-indigo-600 transition-colors",onClick:()=>J.toggleSorting(J.getIsSorted()==="asc"),children:["Nombre",l.jsx(wo,{className:"h-3 w-3"})]}),enableHiding:!0},{accessorKey:"category",header:({column:J})=>l.jsxs("button",{className:"flex items-center gap-1 hover:text-indigo-600 transition-colors",onClick:()=>J.toggleSorting(J.getIsSorted()==="asc"),children:["Categora",l.jsx(wo,{className:"h-3 w-3"})]}),cell:({row:J})=>l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border bg-slate-100 text-slate-800 border-slate-200",children:J.getValue("category")}),filterFn:(J,q,se)=>se==="ALL"?!0:J.getValue(q)===se},{accessorKey:"physical_stock",header:({column:J})=>l.jsxs("button",{className:"flex items-center gap-1 hover:text-indigo-600 transition-colors",onClick:()=>J.toggleSorting(J.getIsSorted()==="asc"),children:["Stock",l.jsx(wo,{className:"h-3 w-3"})]}),cell:({row:J})=>{const q=J.original.physical_stock||0;return l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:`font-bold ${q<0?"text-red-500":"text-slate-700"}`,children:q})," ",J.original.usage_unit]})},filterFn:(J,q,se)=>{const ue=J.getValue(q);if(Array.isArray(se)){const[fe,R]=se;return ue>=fe&&ue<=R}return!0}},{accessorKey:"production_route",header:"Ruta / Auto-Link",cell:({row:J})=>l.jsxs("div",{className:"flex flex-col gap-1 items-start",children:[l.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-400 bg-slate-50 px-1 rounded border border-slate-100",children:J.original.production_route}),J.original.associated_element_sku&&l.jsxs("div",{className:"flex items-center gap-1 text-xs bg-orange-50 text-orange-700 px-2 py-1 rounded border border-orange-200",children:[l.jsx(ex,{size:12}),l.jsx("span",{children:J.original.associated_element_sku})]})]})}];return P&&G.push({accessorKey:"current_cost",header:()=>l.jsx("div",{className:"text-right",children:"Costo"}),cell:({row:J})=>{const q=parseFloat(J.getValue("current_cost")||"0"),se=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(q);return l.jsx("div",{className:"text-right font-medium text-slate-900",children:se})}}),S||G.push({id:"actions",cell:({row:J})=>{const q=J.original;return l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>X(q),className:"p-1.5 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded transition-colors",children:l.jsx(js,{size:16})}),l.jsx("button",{onClick:()=>q.id&&C(q.id),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",children:l.jsx(Rn,{size:16})})]})}}),G},[S,P]);if(v)return l.jsx(Wf,{to:"/",replace:!0});const I=Array.from(new Set(e.map(G=>G.category))).sort(),M=G=>({SKU:G.sku,Material:G.name,Categora:G.category,"Stock Fsico":G.physical_stock||0,"Unidad Uso":G.usage_unit,Ruta:G.production_route,...P&&{"Costo Unitario":G.current_cost,"Valor Inventario":(G.physical_stock||0)*G.current_cost}}),L=async G=>{var se,ue,fe;if(S)return;const J=(se=G.target.files)==null?void 0:se[0];if(!J)return;if(!J.name.endsWith(".csv")){alert("Por favor selecciona un archivo .csv vlido.");return}const q=new FormData;if(q.append("file",J),!confirm(`Deseas importar "${J.name}"?`)){s.current&&(s.current.value="");return}try{const R=await Oe.post("/foundations/materials/import-csv",q,{headers:{"Content-Type":"multipart/form-data"}}),{created:W,updated:B,errors:D}=R.data;let te=` Importacin completada.
- Creados: ${W}
- Actualizados: ${B}`;D&&D.length>0&&(te+=`

 Hubo errores. Revisa consola.`),alert(te),window.location.reload()}catch(R){console.error(R),alert(" Error al importar: "+(((fe=(ue=R.response)==null?void 0:ue.data)==null?void 0:fe.detail)||R.message))}finally{s.current&&(s.current.value="")}},X=G=>{S||(y(G),f(G.id||null),d(!0),c(!0),window.scrollTo({top:0,behavior:"smooth"}))},C=async G=>{S||confirm("Ests seguro de eliminar este material?")&&await n(G)},U=async G=>{var se;if(G.preventDefault(),S)return;if(!g.sku||!g.name||!g.category)return alert("Por favor completa los campos obligatorios.");const J={...g,current_cost:P?g.current_cost:g.current_cost||0,associated_element_sku:((se=g.associated_element_sku)==null?void 0:se.trim())===""?null:g.associated_element_sku};let q;u&&h?q=await r(h,J):q=await t(J),q.success?z():alert(` Error: ${q.error}`)},z=()=>{y(x),d(!1),f(null),c(!1)},V=I.filter(G=>G.toLowerCase().includes((g.category||"").toLowerCase()));return l.jsxs("div",{className:"space-y-6 p-6",children:[l.jsx("input",{type:"file",ref:s,onChange:L,accept:".csv",className:"hidden"}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight flex items-center gap-2",children:["Catlogo de Materiales",S&&l.jsxs("span",{className:"text-[10px] bg-slate-100 text-slate-500 border border-slate-200 px-2 py-0.5 rounded-full flex items-center gap-1",children:[l.jsx(aa,{size:10})," SOLO LECTURA"]}),!P&&l.jsxs("span",{className:"text-[10px] bg-red-50 text-red-500 border border-red-100 px-2 py-0.5 rounded-full flex items-center gap-1",children:[l.jsx(W1,{size:10})," COSTOS OCULTOS"]})]}),l.jsx("p",{className:"text-sm text-slate-500",children:"Gestin de insumos y agrupacin dinmica."})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Kl,{data:e,fileName:"Inventario_Materiales",mapping:M}),!S&&l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:()=>{var G;return(G=s.current)==null?void 0:G.click()},className:"flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-colors",children:[l.jsx(KE,{size:16})," Importar CSV"]}),l.jsxs("button",{onClick:()=>{o?z():c(!0)},className:`flex items-center gap-2 px-4 py-2 text-white rounded-lg text-sm font-medium shadow-sm transition-all ${o?"bg-slate-500 hover:bg-slate-600":"bg-indigo-600 hover:bg-indigo-700"}`,children:[o?l.jsx(kr,{size:16}):l.jsx(xr,{size:16}),o?"Cancelar":"Nuevo Material"]})]})]})]}),o&&!S&&l.jsxs("div",{className:"bg-slate-50 p-5 rounded-lg border border-indigo-200 mb-6 shadow-sm animate-in fade-in slide-in-from-top-4",children:[l.jsxs("h3",{className:"font-bold text-sm mb-4 text-indigo-800 flex items-center gap-2",children:[u?l.jsx(js,{size:16}):l.jsx(xr,{size:16}),u?"Editando Material":"Alta de Material Unitario"]}),l.jsx("form",{onSubmit:U,className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"md:col-span-1",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"SKU (nico)"}),l.jsx("input",{className:"input-std font-mono",placeholder:"Ej. TAB-BL-15",value:g.sku,onChange:G=>y({...g,sku:G.target.value}),autoFocus:!u})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Nombre / Descripcin"}),l.jsx("input",{className:"input-std",placeholder:"Ej. MDF Blanco 15mm",value:g.name,onChange:G=>y({...g,name:G.target.value})})]}),l.jsxs("div",{className:"md:col-span-1 relative",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Categora"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{className:"input-std",placeholder:"Selecciona...",value:g.category,onChange:G=>{y({...g,category:G.target.value}),m(!0)},onFocus:()=>m(!0),onBlur:()=>setTimeout(()=>m(!1),200)}),l.jsx("div",{className:"absolute right-2 top-2.5 text-slate-400 pointer-events-none",children:l.jsx(qf,{size:14})})]}),p&&V.length>0&&l.jsx("ul",{className:"absolute z-10 w-full bg-white border border-slate-200 rounded-md shadow-lg mt-1 max-h-48 overflow-auto text-sm",children:V.map(G=>l.jsx("li",{className:"px-3 py-2 hover:bg-indigo-50 cursor-pointer text-slate-700",onClick:()=>y({...g,category:G}),children:G},G))})]}),l.jsxs("div",{className:"md:col-span-3 bg-white p-3 rounded border border-slate-200 grid grid-cols-3 gap-4 items-end",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Unidad Compra"}),l.jsx("input",{className:"input-std bg-slate-50",placeholder:"Ej. Hoja",value:g.purchase_unit,onChange:G=>y({...g,purchase_unit:G.target.value,usage_unit:G.target.value})})]}),l.jsxs("div",{className:"relative",children:[l.jsx("label",{className:"text-[10px] font-bold text-indigo-500 uppercase w-full text-center block",children:"Factor Conversin"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(wc,{size:14,className:"text-slate-400"}),l.jsx("input",{type:"number",step:"0.01",className:"input-std font-bold text-center text-indigo-700 border-indigo-200",value:g.conversion_factor,onChange:G=>y({...g,conversion_factor:parseFloat(G.target.value)})}),l.jsx(wc,{size:14,className:"text-slate-400"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Unidad Uso"}),l.jsx("input",{className:"input-std bg-slate-50",placeholder:"Ej. m2",value:g.usage_unit,onChange:G=>y({...g,usage_unit:G.target.value})})]})]}),l.jsxs("div",{className:"md:col-span-1",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Ruta Produccin"}),l.jsxs("select",{className:"input-std h-[42px]",value:g.production_route,onChange:G=>y({...g,production_route:G.target.value}),children:[l.jsx("option",{value:"MATERIAL",children:"MATERIAL (Inventariable)"}),l.jsx("option",{value:"PROCESO",children:"PROCESO (Interno)"}),l.jsx("option",{value:"CONSUMIBLE",children:"CONSUMIBLE (Gasto)"}),l.jsx("option",{value:"SERVICIO",children:"SERVICIO (Externo)"})]})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase flex items-center gap-1",children:[l.jsx(ex,{size:12})," Link SKU"]}),l.jsx("input",{className:"input-std border-dashed",value:g.associated_element_sku||"",onChange:G=>y({...g,associated_element_sku:G.target.value})})]}),P&&l.jsxs("div",{className:"md:col-span-2",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase flex items-center gap-1",children:[l.jsx(fn,{size:12})," Costo Compra"]}),l.jsx("input",{type:"number",step:"0.01",className:"input-std font-bold text-slate-700",value:g.current_cost,onChange:G=>y({...g,current_cost:parseFloat(G.target.value)})})]}),l.jsxs("div",{className:"md:col-span-4 mt-2 flex gap-3",children:[l.jsx("button",{type:"button",onClick:z,className:"flex-1 bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 rounded px-4 py-3 text-sm font-bold",children:"Cancelar"}),l.jsx("button",{type:"submit",className:"flex-[2] bg-indigo-600 hover:bg-indigo-700 text-white rounded px-4 py-3 text-sm font-bold shadow-sm flex items-center justify-center gap-2",children:u?"Guardar Cambios":"Crear Material"})]})]})})]}),l.jsx(CF,{columns:N,data:e,searchKey:"name",toolbar:TF}),l.jsx("style",{children:".input-std { width: 100%; padding: 0.5rem; border: 1px solid #cbd5e1; border-radius: 0.375rem; font-size: 0.875rem; color: #1e293b; transition: all 0.2s; } .input-std:focus { outline: none; border-color: #6366f1; ring: 2px solid #e0e7ff; }"})]})}const vy=()=>{const[e,t]=b.useState([]),[r,n]=b.useState(!0),s="/foundations/providers",a=b.useCallback(async()=>{n(!0);try{const{data:u}=await Oe.get(s);Array.isArray(u)?t(u):t([])}catch(u){console.error("Error cargando proveedores:",u),t([])}finally{n(!1)}},[]);return b.useEffect(()=>{a()},[a]),{providers:e,loading:r,fetchProviders:a,createProvider:async u=>{var d,h;try{return await Oe.post(s,u),await a(),{success:!0}}catch(f){return{success:!1,error:((h=(d=f.response)==null?void 0:d.data)==null?void 0:h.detail)||"Error al crear"}}},updateProvider:async(u,d)=>{var h,f;try{return await Oe.put(`${s}/${u}`,d),await a(),{success:!0}}catch(p){return{success:!1,error:((f=(h=p.response)==null?void 0:h.data)==null?void 0:f.detail)||"Error al actualizar"}}},deleteProvider:async u=>{if(window.confirm("Confirma que desea eliminar este proveedor?"))try{await Oe.delete(`${s}/${u}`),await a()}catch{alert("No se pudo eliminar.")}}}};function AF(){const{providers:e,loading:t,createProvider:r,updateProvider:n,deleteProvider:s}=vy(),[a,i]=b.useState(!1),[o,c]=b.useState(null),[u,d]=b.useState(""),h={business_name:"",rfc_tax_id:"",credit_days:0,contact_name:"",email:"",phone:""},[f,p]=b.useState(h),m=w=>({"ID Sistema":w.id,"Empresa / Razn Social":w.business_name,RFC:w.rfc_tax_id||"N/A","Das Crdito":w.credit_days||0,Contacto:w.contact_name||"",Telfono:w.phone||"",Email:w.email||""}),x=()=>{c(null),p(h),i(!0)},g=w=>{c(w.id),p({...w,contact_name:w.contact_name||"",email:w.email||"",phone:w.phone||"",rfc_tax_id:w.rfc_tax_id||""}),i(!0)},y=async w=>{w.preventDefault();const _=o?await n(o,f):await r(f);_.success?i(!1):alert(_.error)},v=e.filter(w=>w.business_name.toLowerCase().includes(u.toLowerCase())||w.rfc_tax_id&&w.rfc_tax_id.toLowerCase().includes(u.toLowerCase()));return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Directorio de Proveedores"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Gestin de socios comerciales y cuentas por pagar."})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Kl,{data:e,fileName:"Reporte_Proveedores",mapping:m}),l.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium shadow-sm transition-all",children:[l.jsx(xr,{size:16}),"Nuevo Proveedor"]})]})]}),l.jsx("div",{className:"flex items-center gap-3 bg-white p-2 rounded-lg border border-slate-200 shadow-sm",children:l.jsxs("div",{className:"relative flex-1",children:[l.jsx(ii,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),l.jsx("input",{type:"text",placeholder:"Buscar por Empresa o RFC...",value:u,onChange:w=>d(w.target.value),className:"w-full pl-10 pr-4 py-2 text-sm text-slate-700 placeholder:text-slate-400 outline-none"})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-slate-50 border-b border-slate-100",children:[l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Empresa"}),l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Contacto"}),l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"RFC"}),l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right",children:"Acciones"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:t?l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"p-8 text-center text-slate-400",children:"Cargando directorio..."})}):v.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"p-12 text-center",children:l.jsxs("div",{className:"flex flex-col items-center justify-center text-slate-400",children:[l.jsx(au,{size:48,className:"mb-4 opacity-20"}),l.jsx("p",{children:"No se encontraron proveedores."})]})})}):v.map(w=>l.jsxs("tr",{className:"hover:bg-slate-50/80 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"font-bold text-slate-900 text-sm",children:w.business_name}),l.jsxs("span",{className:"text-xs text-slate-500",children:["Crdito: ",w.credit_days," das"]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex flex-col gap-1",children:[w.contact_name&&l.jsxs("span",{className:"text-sm font-medium text-slate-700 flex items-center gap-1",children:[l.jsx(ks,{size:12,className:"text-slate-400"})," ",w.contact_name]}),w.phone&&l.jsxs("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[l.jsx(Q1,{size:10})," ",w.phone]}),w.email&&l.jsxs("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[l.jsx(iu,{size:10})," ",w.email]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"font-mono text-xs text-slate-600 bg-slate-100 px-2 py-1 rounded border border-slate-200",children:w.rfc_tax_id||"N/A"})}),l.jsxs("td",{className:"px-6 py-4 text-right flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>g(w),className:"p-2 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded transition-colors",title:"Editar Proveedor",children:l.jsx(lu,{size:18})}),l.jsx("button",{onClick:()=>s(w.id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Eliminar Proveedor",children:l.jsx(Rn,{size:18})})]})]},w.id))})]})})}),a&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/50 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200",children:[l.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[l.jsx("h3",{className:"font-bold text-slate-800",children:o?"Editar Proveedor":"Nuevo Proveedor"}),l.jsx("button",{onClick:()=>i(!1),className:"text-slate-400 hover:text-slate-600",children:l.jsx(kr,{size:20})})]}),l.jsxs("form",{onSubmit:y,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Nombre Comercial / Empresa *"}),l.jsx("input",{required:!0,autoFocus:!0,type:"text",className:"input-std",placeholder:"Ej. Maderas del Sur",value:f.business_name,onChange:w=>p({...f,business_name:w.target.value})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"RFC / Tax ID *"}),l.jsx("input",{required:!0,type:"text",className:"input-std font-mono uppercase",placeholder:"XAXX010101000",value:f.rfc_tax_id,onChange:w=>p({...f,rfc_tax_id:w.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Das Crdito"}),l.jsx("input",{type:"number",min:"0",className:"input-std",value:f.credit_days,onChange:w=>p({...f,credit_days:Number(w.target.value)})})]})]}),l.jsxs("div",{className:"pt-2 border-t border-slate-100",children:[l.jsx("h4",{className:"text-xs font-bold text-indigo-600 uppercase mb-3 flex items-center gap-1",children:"Datos de Contacto"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Nombre Contacto"}),l.jsx("input",{type:"text",className:"input-std",placeholder:"Ej. Juan Prez",value:f.contact_name,onChange:w=>p({...f,contact_name:w.target.value})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Telfono"}),l.jsx("input",{type:"tel",className:"input-std",placeholder:"555-000-0000",value:f.phone,onChange:w=>p({...f,phone:w.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Email"}),l.jsx("input",{type:"email",className:"input-std",placeholder:"contacto@empresa.com",value:f.email,onChange:w=>p({...f,email:w.target.value})})]})]})]})]}),l.jsxs("div",{className:"pt-4 flex gap-3",children:[l.jsx("button",{type:"button",onClick:()=>i(!1),className:"flex-1 px-4 py-2 border border-slate-200 text-slate-600 rounded-lg text-sm font-medium hover:bg-slate-50 transition-colors",children:"Cancelar"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 shadow-sm transition-colors",children:"Guardar"})]})]})]})}),l.jsx("style",{children:`
        .input-std {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            outline: none;
            transition: all 0.2s;
        }
        .input-std:focus {
            ring: 2px;
            ring-color: #6366f1;
            border-color: #6366f1;
        }
      `})]})}const Nu=()=>{const[e,t]=b.useState([]),[r,n]=b.useState(!0),s="/foundations/clients",a=b.useCallback(async()=>{n(!0);try{const u=await Oe.get(s);Array.isArray(u.data)?t(u.data):(console.warn("Respuesta inesperada de Clientes:",u.data),t([]))}catch(u){console.error("Error cargando clientes:",u),t([])}finally{n(!1)}},[]);return b.useEffect(()=>{a()},[a]),{clients:e,loading:r,createClient:async u=>{var d,h;try{return await Oe.post(s,u),await a(),{success:!0}}catch(f){return console.error(f),{success:!1,error:((h=(d=f.response)==null?void 0:d.data)==null?void 0:h.detail)||"Error al crear cliente"}}},updateClient:async(u,d)=>{var h,f;try{return await Oe.put(`${s}/${u}`,d),await a(),{success:!0}}catch(p){return console.error(p),{success:!1,error:((f=(h=p.response)==null?void 0:h.data)==null?void 0:f.detail)||"Error al actualizar cliente"}}},deleteClient:async u=>{var d,h;try{return await Oe.delete(`${s}/${u}`),await a(),{success:!0}}catch(f){return console.error(f),{success:!1,error:((h=(d=f.response)==null?void 0:d.data)==null?void 0:h.detail)||"Error al eliminar cliente"}}},fetchClients:a}};function jF(){const{clients:e,loading:t,createClient:r,updateClient:n,deleteClient:s}=Nu(),[a,i]=b.useState(!1),[o,c]=b.useState(!1),[u,d]=b.useState("general"),h={id:void 0,full_name:"",email:"",phone:"",rfc_tax_id:"",fiscal_address:"",notes:"",contact_name:"",contact_phone:"",contact_dept:"",contact2_name:"",contact2_phone:"",contact2_dept:"",contact3_name:"",contact3_phone:"",contact3_dept:"",contact4_name:"",contact4_phone:"",contact4_dept:""},[f,p]=b.useState(h),m=_=>({ID:_.id,Cliente:_.full_name,RFC:_.rfc_tax_id||"N/A",Email:_.email,"Telfono Ofic.":_.phone,"C1 Nombre":_.contact_name||"","C1 Depto":_.contact_dept||"","C1 Tel":_.contact_phone||"","C2 Nombre":_.contact2_name||"","C2 Depto":_.contact2_dept||"","C2 Tel":_.contact2_phone||"","C3 Nombre":_.contact3_name||"","C3 Depto":_.contact3_dept||"","C3 Tel":_.contact3_phone||"","C4 Nombre":_.contact4_name||"","C4 Depto":_.contact4_dept||"","C4 Tel":_.contact4_phone||"",Observaciones:_.notes||""}),x=async _=>{_.preventDefault();let S;o&&f.id?S=await n(f.id,f):S=await r(f),S&&S.success?v():alert(S?S.error:"Error desconocido")},g=_=>{p(_),c(!0),d("general"),i(!0)},y=async _=>{window.confirm("Ests seguro de eliminar este cliente?")&&await s(_)},v=()=>{i(!1),p(h),c(!1),d("general")},w=(_,S)=>{const P=_===1?"":_,N=()=>f[`contact${P}_name`]||"",I=()=>f[`contact${P}_phone`]||"",M=()=>f[`contact${P}_dept`]||"",L=U=>p({...f,[`contact${P}_name`]:U}),X=U=>p({...f,[`contact${P}_phone`]:U}),C=U=>p({...f,[`contact${P}_dept`]:U});return l.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-200",children:[l.jsxs("h4",{className:"text-xs font-bold text-slate-500 mb-2 uppercase flex items-center gap-1",children:[l.jsx(ks,{size:12})," ",S]}),l.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[l.jsx("div",{className:"col-span-5",children:l.jsx("input",{placeholder:"Nombre Completo",className:"input-mini",value:N(),onChange:U=>L(U.target.value)})}),l.jsx("div",{className:"col-span-4",children:l.jsx("input",{placeholder:"Telfono / Celular",className:"input-mini",value:I(),onChange:U=>X(U.target.value)})}),l.jsx("div",{className:"col-span-3",children:l.jsx("input",{placeholder:"Depto.",className:"input-mini",value:M(),onChange:U=>C(U.target.value)})})]})]})};return l.jsxs("div",{className:"space-y-6 p-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Cartera de Clientes"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Gestin comercial y agenda de contactos."})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Kl,{data:e,fileName:"Cartera_Clientes_Completa",mapping:m}),l.jsxs("button",{onClick:()=>{c(!1),p(h),i(!0)},className:"flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 font-medium shadow-sm",children:[l.jsx(xr,{size:18})," Nuevo Cliente"]})]})]}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:l.jsxs("table",{className:"w-full text-left",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-4 text-xs font-bold text-slate-500 uppercase",children:"Cliente / Empresa"}),l.jsx("th",{className:"p-4 text-xs font-bold text-slate-500 uppercase",children:"Contacto Principal"}),l.jsx("th",{className:"p-4 text-xs font-bold text-slate-500 uppercase",children:"Comunicacin"}),l.jsx("th",{className:"p-4 text-xs font-bold text-slate-500 uppercase",children:"Observaciones"}),l.jsx("th",{className:"p-4 text-xs font-bold text-slate-500 uppercase text-right",children:"Acciones"})]})}),l.jsxs("tbody",{className:"divide-y divide-slate-100",children:[t?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"p-8 text-center text-slate-400",children:"Cargando cartera..."})}):null,e.length===0&&!t&&l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"p-8 text-center text-slate-400",children:"No hay clientes registrados."})}),e.map(_=>{const S=[_.contact2_name,_.contact3_name,_.contact4_name].filter(Boolean).length;return l.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[l.jsxs("td",{className:"p-4",children:[l.jsx("div",{className:"font-bold text-slate-800",children:_.full_name}),l.jsx("div",{className:"text-xs font-mono text-slate-500",children:_.rfc_tax_id||"Sin RFC"})]}),l.jsx("td",{className:"p-4",children:_.contact_name?l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("span",{className:"text-sm font-medium text-slate-700 flex items-center gap-1",children:[l.jsx(ks,{size:12,className:"text-indigo-500"})," ",_.contact_name]}),l.jsxs("div",{className:"flex gap-2 text-xs text-slate-500",children:[_.contact_dept&&l.jsx("span",{className:"bg-slate-100 px-1 rounded",children:_.contact_dept}),_.contact_phone&&l.jsx("span",{children:_.contact_phone})]}),S>0&&l.jsxs("span",{className:"text-[10px] text-indigo-600 font-bold bg-indigo-50 w-fit px-1.5 rounded-full mt-1",children:["+",S," Contactos ms"]})]}):l.jsx("span",{className:"text-xs text-slate-300 italic",children:"No especificado"})}),l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex flex-col gap-1 text-sm text-slate-600",children:[l.jsxs("span",{className:"flex items-center gap-2 text-xs",children:[l.jsx(iu,{size:12})," ",_.email]}),l.jsxs("span",{className:"flex items-center gap-2 text-xs",children:[l.jsx(Q1,{size:12})," ",_.phone]})]})}),l.jsx("td",{className:"p-4",children:_.notes?l.jsxs("div",{className:"text-xs text-slate-500 max-w-xs truncate",title:_.notes,children:[l.jsx(As,{size:10,className:"inline mr-1"}),_.notes]}):"-"}),l.jsx("td",{className:"p-4 text-right",children:l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>g(_),className:"p-1.5 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors",title:"Editar / Ver Contactos",children:l.jsx(js,{size:16})}),l.jsx("button",{onClick:()=>_.id&&y(_.id),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Eliminar",children:l.jsx(Rn,{size:16})})]})})]},_.id)})]})]})}),a&&l.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl shadow-2xl animate-in zoom-in duration-200 overflow-hidden flex flex-col max-h-[90vh]",children:[l.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-slate-100 bg-white",children:[l.jsx("h2",{className:"text-lg font-bold text-slate-800",children:o?"Editar Cliente":"Nuevo Cliente"}),l.jsx("button",{onClick:v,className:"text-slate-400 hover:text-slate-600",children:l.jsx(kr,{size:20})})]}),l.jsxs("div",{className:"flex border-b border-slate-200 bg-slate-50",children:[l.jsxs("button",{onClick:()=>d("general"),className:`flex-1 py-3 text-sm font-bold flex justify-center items-center gap-2 border-b-2 transition-colors ${u==="general"?"border-indigo-600 text-indigo-700 bg-white":"border-transparent text-slate-500 hover:text-slate-700"}`,children:[l.jsx(au,{size:16})," Datos Empresa"]}),l.jsxs("button",{onClick:()=>d("contacts"),className:`flex-1 py-3 text-sm font-bold flex justify-center items-center gap-2 border-b-2 transition-colors ${u==="contacts"?"border-indigo-600 text-indigo-700 bg-white":"border-transparent text-slate-500 hover:text-slate-700"}`,children:[l.jsx(bl,{size:16})," Agenda de Contactos (4)"]})]}),l.jsxs("form",{onSubmit:x,className:"flex-1 overflow-y-auto p-6 bg-white",children:[u==="general"&&l.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Razn Social / Nombre Cliente *"}),l.jsx("input",{required:!0,className:"input-std",value:f.full_name,onChange:_=>p({...f,full_name:_.target.value})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"RFC"}),l.jsx("input",{className:"input-std",value:f.rfc_tax_id||"",onChange:_=>p({...f,rfc_tax_id:_.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Telfono Oficina *"}),l.jsx("input",{required:!0,className:"input-std",value:f.phone,onChange:_=>p({...f,phone:_.target.value})})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Email Facturacin / General *"}),l.jsx("input",{type:"email",required:!0,className:"input-std",value:f.email,onChange:_=>p({...f,email:_.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Direccin Fiscal"}),l.jsx("input",{className:"input-std",value:f.fiscal_address||"",onChange:_=>p({...f,fiscal_address:_.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Observaciones Generales"}),l.jsx("textarea",{className:"input-std min-h-[80px]",value:f.notes||"",onChange:_=>p({...f,notes:_.target.value})})]})]}),u==="contacts"&&l.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[l.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 p-3 rounded-lg mb-4 text-xs text-indigo-800 flex gap-2",children:[l.jsx(bl,{size:14,className:"mt-0.5"}),l.jsx("p",{children:"Puedes registrar hasta 4 contactos clave para este cliente. Asegrate de llenar al menos el Contacto Principal."})]}),w(1,"Contacto Principal (Obligatorio)"),w(2,"Contacto Adicional 2"),w(3,"Contacto Adicional 3"),w(4,"Contacto Adicional 4")]})]}),l.jsxs("div",{className:"p-5 border-t border-slate-100 bg-slate-50 flex gap-3",children:[l.jsx("button",{type:"button",onClick:v,className:"flex-1 px-4 py-2 border border-slate-200 rounded-lg hover:bg-slate-100 text-slate-600 font-medium transition-colors",children:"Cancelar"}),l.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium shadow-sm transition-colors",children:o?"Guardar Cambios":"Crear Cliente"})]})]})}),l.jsx("style",{children:`
        .input-std { width: 100%; padding: 0.6rem; border: 1px solid #e2e8f0; border-radius: 0.5rem; font-size: 0.875rem; outline: none; transition: border-color 0.2s; }
        .input-std:focus { border-color: #6366f1; ring: 1px; }
        .input-mini { width: 100%; padding: 0.4rem; border: 1px solid #e2e8f0; border-radius: 0.3rem; font-size: 0.75rem; outline: none; }
        .input-mini:focus { border-color: #6366f1; }
        .label-std { display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; margin-bottom: 0.25rem; }
      `})]})}function kF(){const{taxRates:e,createTaxRate:t,toggleTaxRate:r,loading:n}=pu(),[s,a]=b.useState(!1),[i,o]=b.useState(""),[c,u]=b.useState(""),d=async h=>{if(h.preventDefault(),!i)return alert("El campo Nombre est vaco");if(!c)return alert("El campo Tasa est vaco");const f=parseFloat(c)/100;console.log("Enviando datos:",{name:i,rateDecimal:f});try{const p=await t(i,f);console.log("Respuesta del Hook:",p),p.success?(alert("Guardado correctamente!"),o(""),u(""),a(!1)):alert("Error del Backend: "+(p.error||"Desconocido"))}catch(p){alert("Error Crtico en Frontend: "+p)}};return l.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl font-bold text-slate-900 flex items-center gap-2",children:[l.jsx(Tl,{className:"text-blue-600"})," Catlogo de Impuestos"]}),l.jsx("p",{className:"text-slate-500 text-sm",children:"Define las tasas de IVA aplicables (0%, 8%, 16%, etc)."})]}),l.jsxs("button",{onClick:()=>a(!s),className:"btn-primary bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-700 transition-colors shadow-sm font-bold",children:[l.jsx(xr,{size:18})," Nuevo Impuesto"]})]}),s&&l.jsx("div",{className:"bg-blue-50 border border-blue-100 p-4 rounded-xl mb-6 animate-in slide-in-from-top-2",children:l.jsxs("form",{onSubmit:d,className:"flex gap-4 items-end",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("label",{className:"text-xs font-bold text-blue-800 uppercase mb-1 block",children:"Nombre Etiqueta"}),l.jsx("input",{autoFocus:!0,placeholder:"Ej. IVA General",className:"w-full p-2 border border-blue-200 rounded outline-none focus:ring-2 focus:ring-blue-200",value:i,onChange:h=>o(h.target.value)})]}),l.jsxs("div",{className:"w-32",children:[l.jsx("label",{className:"text-xs font-bold text-blue-800 uppercase mb-1 block",children:"Tasa (%)"}),l.jsx("input",{type:"number",placeholder:"16",className:"w-full p-2 border border-blue-200 rounded outline-none focus:ring-2 focus:ring-blue-200 text-center font-bold",value:c,onChange:h=>u(h.target.value)})]}),l.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded font-bold hover:bg-blue-700",children:"Guardar"})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:l.jsxs("table",{className:"w-full text-left",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase",children:"Nombre"}),l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase text-center",children:"Tasa Decimal"}),l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase text-center",children:"Tasa %"}),l.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase text-center",children:"Estado"}),l.jsx("th",{className:"px-6 py-4 text-right",children:"Accin"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:n?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"p-8 text-center text-slate-400",children:"Cargando..."})}):e.map(h=>l.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4 font-bold text-slate-700",children:h.name}),l.jsx("td",{className:"px-6 py-4 text-center font-mono text-slate-500",children:h.rate}),l.jsx("td",{className:"px-6 py-4 text-center",children:l.jsxs("span",{className:"bg-slate-100 text-slate-700 px-2 py-1 rounded text-xs font-bold border border-slate-200",children:[(h.rate*100).toFixed(0),"%"]})}),l.jsx("td",{className:"px-6 py-4 text-center",children:h.is_active?l.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-green-600 font-bold bg-green-50 px-2 py-1 rounded-full border border-green-100",children:[l.jsx(Xs,{size:12})," Activo"]}):l.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-slate-400 font-bold bg-slate-100 px-2 py-1 rounded-full border border-slate-200",children:[l.jsx(Zf,{size:12})," Inactivo"]})}),l.jsx("td",{className:"px-6 py-4 text-right",children:l.jsx("button",{onClick:()=>r(h.id),className:`p-2 rounded hover:bg-slate-100 transition-colors ${h.is_active?"text-red-500":"text-green-600"}`,title:h.is_active?"Desactivar":"Activar",children:l.jsx($E,{size:18})})})]},h.id))})]})})]})}function RF(){const{config:e,taxRates:t,loading:r,error:n,saving:s,updateConfig:a}=pu(),i=b.useRef(null),[o,c]=b.useState(!1),[u,d]=b.useState(""),[h,f]=b.useState(""),[p,m]=b.useState(""),[x,g]=b.useState(""),[y,v]=b.useState(""),[w,_]=b.useState(""),[S,P]=b.useState(""),[N,I]=b.useState(""),[M,L]=b.useState(""),[X,C]=b.useState(""),[U,z]=b.useState(""),[V,G]=b.useState(0),[J,q]=b.useState(""),[se,ue]=b.useState(""),fe=D=>{if(!D)return"";const te=typeof D=="string"?parseFloat(D.replace(/,/g,"")):D;return isNaN(te)?"":new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(te)},R=D=>D.replace(/,/g,"");b.useEffect(()=>{if(e){if(d(e.company_name||""),f(e.logo_path||""),m(e.company_rfc||""),g(e.company_address||""),v(e.company_phone||""),_(e.company_email||""),P(e.company_website||""),I((e.target_profit_margin*100).toFixed(0)),L((e.cost_tolerance_percent*100).toFixed(0)),C(e.quote_validity_days.toString()),z(e.default_edgebanding_factor.toString()),q(e.annual_sales_target?fe(e.annual_sales_target):""),ue(e.last_year_sales?fe(e.last_year_sales):""),e.default_tax_rate_id)G(e.default_tax_rate_id);else if(t&&t.length>0){const D=t.find(te=>te.is_active);D&&G(D.id||0)}}},[e,t]);const W=async D=>{var Ee;const te=(Ee=D.target.files)==null?void 0:Ee[0];if(!te)return;c(!0);const we=new FormData;we.append("file",te);try{const{data:xe}=await Oe.post("/foundations/config/upload-logo",we,{headers:{"Content-Type":"multipart/form-data"}});f(xe.url)}catch(xe){console.error("Error upload:",xe),alert("Error al subir el logo.")}finally{c(!1),i.current&&(i.current.value="")}},B=async()=>{const D=Number(N),te=Number(M),we=Number(X),Ee=Number(U),xe=J?parseFloat(R(J)):0,pe=se?parseFloat(R(se)):0;if(isNaN(D)||isNaN(te)||isNaN(we)||isNaN(Ee)){alert("Por favor revisa los campos numricos.");return}const Le={company_name:u,logo_path:h,company_rfc:p,company_address:x,company_phone:y,company_email:w,company_website:S,target_profit_margin:D/100,cost_tolerance_percent:te/100,quote_validity_days:we,default_edgebanding_factor:Ee,default_tax_rate_id:V,annual_sales_target:xe,last_year_sales:pe};try{await a(Le),alert(" Configuracin guardada correctamente."),window.location.reload()}catch(ie){console.error("Error al guardar:",ie),alert(" Ocurri un error al guardar.")}};return r?l.jsx("div",{className:"p-10 text-center animate-pulse",children:"Cargando configuracin..."}):n?l.jsxs("div",{className:"p-10 text-center text-red-600",children:[l.jsx(Nl,{className:"inline"})," ",n]}):l.jsxs("div",{className:"p-6 max-w-6xl mx-auto space-y-8 pb-20",children:[l.jsxs("div",{className:"flex justify-between items-center pb-4 border-b border-slate-200",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Configuracin Maestra"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Parmetros globales de Identidad y Reglas de Negocio."})]}),l.jsxs("button",{onClick:B,disabled:s,className:"flex items-center gap-2 bg-slate-900 text-white px-6 py-2.5 rounded-lg hover:bg-slate-800 font-medium shadow-lg transition-all active:scale-95 disabled:opacity-50",children:[l.jsx(ou,{size:18})," ",s?"Guardando...":"Guardar Cambios"]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[l.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[l.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(au,{className:"text-blue-600"})," Identidad Corporativa"]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 space-y-5",children:[l.jsxs("div",{className:"flex flex-col items-center justify-center p-4 border-2 border-dashed border-slate-200 rounded-lg bg-slate-50 hover:bg-slate-100 transition-colors",children:[l.jsxs("div",{className:"relative mb-3 group",children:[h?l.jsx("img",{src:h,alt:"Logo",className:"w-24 h-24 object-contain rounded-md bg-white border border-slate-100 shadow-sm",onError:D=>D.currentTarget.src="https://via.placeholder.com/150?text=Sin+Logo"}):l.jsx("div",{className:"w-24 h-24 flex items-center justify-center bg-slate-200 rounded-md text-slate-400",children:l.jsx(LE,{size:32})}),o&&l.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center rounded-md",children:l.jsx("span",{className:"text-xs font-bold text-blue-600 animate-pulse",children:"Subiendo..."})})]}),l.jsxs("div",{className:"w-full text-center",children:[l.jsx("input",{type:"file",ref:i,className:"hidden",accept:"image/*",onChange:W}),l.jsxs("button",{onClick:()=>{var D;return(D=i.current)==null?void 0:D.click()},disabled:o,className:"text-xs flex items-center justify-center gap-2 mx-auto bg-white border border-slate-300 text-slate-700 font-bold py-1.5 px-3 rounded hover:bg-slate-50 transition-all shadow-sm",children:[l.jsx(YE,{size:14})," ",o?"Cargando...":"Cambiar Logo"]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Nombre Empresa"}),l.jsx("input",{className:"input-std",value:u,onChange:D=>d(D.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"RFC / Tax ID"}),l.jsx("input",{className:"input-std",value:p,onChange:D=>m(D.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Direccin"}),l.jsx("textarea",{className:"input-std h-20 resize-none",value:x,onChange:D=>g(D.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Telfono"}),l.jsx("input",{className:"input-std",value:y,onChange:D=>v(D.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Email"}),l.jsx("input",{className:"input-std",value:w,onChange:D=>_(D.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"label-std",children:"Sitio Web"}),l.jsx("input",{className:"input-std",value:S,onChange:D=>P(D.target.value)})]})]})]}),l.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[l.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Tl,{className:"text-emerald-600"})," Reglas de Negocio"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"card-std",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsx("h2",{className:"text-base font-bold text-slate-700",children:"Margen"}),l.jsx("span",{className:"badge-blue",children:"Finanzas"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:N,onChange:D=>I(D.target.value),className:"input-large border-blue-200 focus:border-blue-500"}),l.jsx("span",{className:"unit-label",children:"%"})]})]}),l.jsxs("div",{className:"card-std",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsx("h2",{className:"text-base font-bold text-slate-700",children:"Tolerancia"}),l.jsx("span",{className:"badge-orange",children:"Seguridad"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:M,onChange:D=>L(D.target.value),className:"input-large border-orange-200 focus:border-orange-500"}),l.jsx("span",{className:"unit-label",children:"%"})]})]}),l.jsxs("div",{className:"card-std",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsx("h2",{className:"text-base font-bold text-slate-700",children:"Vigencia"}),l.jsx(kn,{size:18,className:"text-slate-400"})]}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:X,onChange:D=>C(D.target.value),className:"input-large border-indigo-200 focus:border-indigo-500"}),l.jsx("span",{className:"absolute right-0 top-4 text-sm font-bold text-slate-400",children:"Das"})]})]}),l.jsxs("div",{className:"card-std",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsx("h2",{className:"text-base font-bold text-slate-700",children:"IVA Default"}),l.jsx("span",{className:"badge-blue",children:"Fiscal"})]}),l.jsxs("select",{value:V,onChange:D=>G(Number(D.target.value)),className:"w-full p-2 bg-slate-50 border border-slate-200 rounded h-12 outline-none",children:[l.jsx("option",{value:0,disabled:!0,children:"-- Selecciona --"}),t&&t.map(D=>l.jsxs("option",{value:D.id,children:[D.name," (",(D.rate*100).toFixed(0),"%)"]},D.id))]})]}),l.jsx("div",{className:"card-std md:col-span-2 border-l-4 border-l-purple-500",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(J1,{size:18,className:"text-purple-600"})," Factor Tapacanto"]}),l.jsx("p",{className:"helper-text mt-1",children:"Metros lineales promedio por Hoja."})]}),l.jsxs("div",{className:"relative w-32",children:[l.jsx("input",{type:"number",value:U,onChange:D=>z(D.target.value),className:"input-large border-purple-200 focus:border-purple-500 text-right"}),l.jsx("span",{className:"absolute right-0 -bottom-5 text-xs font-bold text-slate-400",children:"ml / Hoja"})]})]})})]}),l.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2 pt-6 border-t border-slate-200",children:[l.jsx(rx,{className:"text-purple-600"})," Metas Financieras"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-purple-50 p-5 rounded-xl border border-purple-100 shadow-sm relative overflow-hidden group hover:shadow-md transition-all",children:[l.jsx("div",{className:"absolute right-0 top-0 p-3 opacity-10 group-hover:opacity-20 transition-opacity",children:l.jsx(rx,{size:60,className:"text-purple-600"})}),l.jsxs("label",{className:"block text-xs font-bold text-purple-800 uppercase mb-2",children:["Meta Ventas ",new Date().getFullYear()]}),l.jsxs("div",{className:"relative",children:[l.jsx(fn,{size:20,className:"absolute left-0 top-3 text-purple-400"}),l.jsx("input",{type:"text",className:"w-full pl-6 bg-transparent text-3xl font-bold text-purple-900 border-b-2 border-purple-200 focus:border-purple-500 outline-none",value:J,onChange:D=>q(D.target.value),onFocus:()=>q(R(J)),onBlur:()=>q(fe(J))})]})]}),l.jsxs("div",{className:"bg-slate-50 p-5 rounded-xl border border-slate-200 shadow-sm relative overflow-hidden group hover:shadow-md transition-all",children:[l.jsx("div",{className:"absolute right-0 top-0 p-3 opacity-10 group-hover:opacity-20 transition-opacity",children:l.jsx(ev,{size:60,className:"text-slate-600"})}),l.jsx("label",{className:"block text-xs font-bold text-slate-600 uppercase mb-2",children:"Ventas Ao Anterior"}),l.jsxs("div",{className:"relative",children:[l.jsx(fn,{size:20,className:"absolute left-0 top-3 text-slate-400"}),l.jsx("input",{type:"text",className:"w-full pl-6 bg-transparent text-3xl font-bold text-slate-700 border-b-2 border-slate-300 focus:border-slate-500 outline-none",value:se,onChange:D=>ue(D.target.value),onFocus:()=>ue(R(se)),onBlur:()=>ue(fe(se))})]})]})]})]})]}),l.jsx("style",{children:".label-std { display: block; font-size: 0.75rem; font-weight: 700; color: #64748b; text-transform: uppercase; margin-bottom: 0.25rem; } .input-std { width: 100%; padding: 0.5rem; border: 1px solid #cbd5e1; border-radius: 0.5rem; font-size: 0.875rem; outline: none; transition: all 0.2s; } .input-std:focus { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); } .card-std { background-color: white; padding: 1.25rem; border-radius: 0.75rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); border: 1px solid #e2e8f0; } .badge-blue { background-color: #eff6ff; color: #1d4ed8; padding: 0.125rem 0.5rem; border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 700; } .badge-orange { background-color: #fff7ed; color: #c2410c; padding: 0.125rem 0.5rem; border-radius: 0.25rem; font-size: 0.6875rem; font-weight: 700; } .input-large { width: 100%; font-size: 2.25rem; font-weight: 700; color: #1e293b; border-bottom-width: 2px; padding-top: 0.25rem; padding-bottom: 0.25rem; outline: none; background-color: transparent; } .unit-label { position: absolute; right: 0; top: 0.75rem; font-size: 1.25rem; font-weight: 700; color: #94a3b8; } .helper-text { font-size: 0.75rem; color: #94a3b8; margin-top: 0.5rem; }"})]})}const dr={getMasters:async(e,t)=>{const r={};return e&&(r.client_id=e),t&&(r.only_ready=!0),(await Oe.get(it.DESIGN.MASTERS,{params:r})).data},createMaster:async e=>(await Oe.post(it.DESIGN.MASTERS,e)).data,updateMaster:async(e,t)=>{const r=`${it.DESIGN.MASTERS}/${e}`;return(await Oe.put(r,t)).data},deleteMaster:async e=>{const t=`${it.DESIGN.MASTERS}/${e}`;await Oe.delete(t)},getMasterDetail:async e=>{const t=`${it.DESIGN.MASTERS}/${e}`;return(await Oe.get(t)).data},uploadBlueprint:async(e,t)=>{const r=`${it.DESIGN.MASTERS}/${e}/blueprint`,n=new FormData;return n.append("blueprint",t),(await Oe.post(r,n,{headers:{"Content-Type":"multipart/form-data"}})).data},deleteBlueprint:async e=>{const t=`${it.DESIGN.MASTERS}/${e}/blueprint`;await Oe.delete(t)},createVersion:async e=>(await Oe.post(it.DESIGN.VERSIONS,e)).data,updateVersion:async(e,t)=>{const r=`${it.DESIGN.VERSIONS}/${e}`;return(await Oe.put(r,t)).data},getVersion:async e=>{const t=`${it.DESIGN.VERSIONS}/${e}`;return(await Oe.get(t)).data},updateVersionStatus:async(e,t)=>{const r=it.DESIGN.VERSION_STATUS(e);return(await Oe.patch(r,null,{params:{status:t}})).data}};var vr=(e=>(e.DRAFT="DRAFT",e.READY="READY",e.OBSOLETE="OBSOLETE",e))(vr||{});const FF=()=>{const[e,t]=b.useState([]),[r,n]=b.useState(null),[s,a]=b.useState(!1),[i,o]=b.useState(null),c=b.useCallback(async x=>{var g,y;a(!0),o(null);try{const v=await dr.getMasters(x);t(v)}catch(v){console.error("Error loading masters:",v),o(((y=(g=v.response)==null?void 0:g.data)==null?void 0:y.detail)||"Error al cargar los diseos.")}finally{a(!1)}},[]),u=b.useCallback(async x=>{var g,y;a(!0),o(null);try{const v=await dr.createMaster(x);return t(w=>[v,...w]),v}catch(v){throw console.error("Error creating master:",v),o(((y=(g=v.response)==null?void 0:g.data)==null?void 0:y.detail)||"Error al crear el diseo."),v}finally{a(!1)}},[]),d=b.useCallback(async(x,g)=>{var y,v;a(!0),o(null);try{const w=await dr.updateMaster(x,g);return t(_=>_.map(S=>S.id===x?w:S)),r&&r.id===x&&n(_=>_?{..._,...w}:null),w}catch(w){throw console.error("Error updating master:",w),o(((v=(y=w.response)==null?void 0:y.data)==null?void 0:v.detail)||"Error al actualizar el diseo."),w}finally{a(!1)}},[r]),h=b.useCallback(async x=>{var g,y;a(!0),o(null);try{await dr.deleteMaster(x),t(v=>v.filter(w=>w.id!==x)),r&&r.id===x&&n(null)}catch(v){throw console.error("Error deleting master:",v),o(((y=(g=v.response)==null?void 0:g.data)==null?void 0:y.detail)||"No se pudo eliminar. Verifica que no tenga recetas activas."),v}finally{a(!1)}},[r]),f=b.useCallback(async x=>{var g,y;a(!0),o(null);try{const v=await dr.getMasterDetail(x);n(v)}catch(v){console.error("Error loading master detail:",v),o(((y=(g=v.response)==null?void 0:g.data)==null?void 0:y.detail)||"Error al cargar detalles.")}finally{a(!1)}},[]),p=b.useCallback(async x=>{var g,y;a(!0),o(null);try{const v=await dr.createVersion(x);if(r&&r.id===x.master_id){const w=r.versions?[...r.versions,v]:[v];n({...r,versions:w})}return v}catch(v){throw console.error("Error creating version:",v),o(((y=(g=v.response)==null?void 0:g.data)==null?void 0:y.detail)||"Error al guardar la versin."),v}finally{a(!1)}},[r]),m=b.useCallback(async x=>{var g,y;a(!0),o(null);try{const v=await dr.updateVersionStatus(x,vr.READY);if(r&&r.versions){const w=r.versions.map(_=>_.id===x?v:_);n({...r,versions:w})}return v}catch(v){throw o(((y=(g=v.response)==null?void 0:g.data)==null?void 0:y.detail)||"Error al publicar la versin."),v}finally{a(!1)}},[r]);return{masters:e,currentMaster:r,loading:s,error:i,loadMasters:c,addMaster:u,updateMaster:d,deleteMaster:h,loadMasterDetail:f,addVersion:p,publishVersion:m}},yy=({isOpen:e,onClose:t,title:r,children:n,size:s="md",className:a=""})=>{const i=b.useRef(null);if(b.useEffect(()=>{const c=u=>{u.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",c),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",c),document.body.style.overflow="unset"}},[e,t]),!e)return null;const o={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",custom:""};return l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[l.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity",onClick:t}),l.jsxs("div",{ref:i,className:`
            relative bg-white rounded-xl shadow-2xl w-full flex flex-col
            max-h-[90vh] /* Altura mxima de seguridad */
            animate-in fade-in zoom-in duration-200
            ${s!=="custom"?o[s]:""} 
            ${a} /* Aqu entra el w-[95vw] y h-[90vh] que mandamos desde fuera */
        `,role:"dialog","aria-modal":"true",children:[l.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-100 shrink-0",children:[l.jsx("h3",{className:"font-bold text-lg text-slate-800",children:r}),l.jsx("button",{onClick:t,className:"p-1 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-full transition-colors",children:l.jsx(kr,{size:20})})]}),l.jsx("div",{className:"p-6 overflow-y-auto flex-1 h-full flex flex-col",children:n})]})]})},DF=()=>{const e=On(),[t,r]=b.useState("ADMIN");b.useEffect(()=>{const ie=(localStorage.getItem("user_role")||"ADMIN").toUpperCase();r(ie)},[]);const n=t==="SALES",{masters:s,loading:a,error:i,loadMasters:o,addMaster:c,updateMaster:u,deleteMaster:d}=FF(),{clients:h,fetchClients:f}=Nu(),[p,m]=b.useState(!1),[x,g]=b.useState(!1),[y,v]=b.useState(null),[w,_]=b.useState(""),[S,P]=b.useState(!1),[N,I]=b.useState(new Set),M=b.useRef(null),[L,X]=b.useState(null),[C,U]=b.useState(null),[z,V]=b.useState({name:"",category:"General",client_id:0});b.useEffect(()=>{o(),f()},[o,f]),b.useEffect(()=>{if(h.length>0&&s.length>0&&N.size===0){const ie=new Set(h.map(je=>je.id));I(ie)}},[h.length,s.length]);const G=ie=>{var je;return((je=h.find(ke=>ke.id===ie))==null?void 0:je.full_name)||"Stock"},J=ie=>({"ID Sistema":ie.id,Producto:ie.name,Categora:ie.category,Cliente:G(ie.client_id),"Tiene Plano":ie.blueprint_path?"S":"NO","Versiones Activas":ie.versions?ie.versions.length:0}),q=ie=>{n||(X(ie),setTimeout(()=>{M.current&&M.current.click()},50))},se=async ie=>{var ke;const je=(ke=ie.target.files)==null?void 0:ke[0];if(!(!je||!L))try{await dr.uploadBlueprint(L,je),alert(" Plano adjuntado."),await o()}catch(Xe){console.error(Xe),alert("Error al subir.")}finally{M.current&&(M.current.value=""),X(null)}},ue=ie=>{U(ie)},fe=()=>U(null),R=async(ie,je)=>{if(ie.stopPropagation(),!n&&window.confirm("Eliminar plano?"))try{await dr.deleteBlueprint(je),await o()}catch{alert("Error.")}},W=b.useMemo(()=>{const ie=new Set(["Cocinas","Closets","Baos","General"]);return s.forEach(je=>{je.category&&ie.add(je.category.trim())}),Array.from(ie).sort()},[s]),B=b.useMemo(()=>z.category?W.filter(ie=>ie.toLowerCase().includes(z.category.toLowerCase())):W,[W,z.category]),D=b.useMemo(()=>{const ie=s.filter(ke=>ke.name.toLowerCase().includes(w.toLowerCase())||ke.category.toLowerCase().includes(w.toLowerCase())),je={};return ie.forEach(ke=>{const Xe=ke.client_id,$e=ke.category||"General";je[Xe]||(je[Xe]={}),je[Xe][$e]||(je[Xe][$e]=[]),je[Xe][$e].push(ke)}),je},[s,w]),te=ie=>{const je=new Set(N);je.has(ie)?je.delete(ie):je.add(ie),I(je)},we=()=>{n||(f(),g(!1),V({name:"",category:"",client_id:0}),v(null),m(!0),P(!1))},Ee=(ie,je)=>{ie.stopPropagation(),!n&&(f(),g(!0),v(je.id),V({name:je.name,category:je.category,client_id:je.client_id||0}),m(!0),P(!1))},xe=async(ie,je,ke)=>{if(ie.stopPropagation(),!n&&window.confirm(` Eliminar "${ke}"?`))try{await d(je)}catch{alert("Error.")}},pe=async(ie,je)=>{if(n){alert(" Acceso Restringido: Solo Ingeniera puede ver los detalles tcnicos y costos.");return}if(je&&je.length>0)e(`/design/versions/${je[0].id}`);else try{const ke=await dr.createVersion({master_id:ie,version_name:"V1.0",status:vr.DRAFT,is_active:!0,components:[]});await o(),e(`/design/versions/${ke.id}`)}catch{alert("Error.")}},Le=async()=>{if(!(!z.name||!z.client_id))try{x&&y?await u(y,{...z,category:z.category||"General",client_id:Number(z.client_id)}):await c({...z,category:z.category||"General",client_id:Number(z.client_id),is_active:!0}),m(!1)}catch(ie){console.error(ie)}};return l.jsxs("div",{className:"h-full flex flex-col bg-slate-50",children:[l.jsx("input",{type:"file",ref:M,className:"hidden",accept:".pdf,image/*",onChange:se}),l.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 shadow-sm sticky top-0 z-10",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-xl font-black text-slate-800 tracking-tight flex items-center gap-2",children:["Catlogo de Ingeniera",n&&l.jsxs(la,{className:"bg-amber-100 text-amber-700 border-amber-200",children:[l.jsx(aa,{size:10,className:"mr-1"})," MODO LECTURA"]})]}),l.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"Gestin de Productos y Recetas"})]}),l.jsxs("div",{className:"flex gap-3 w-full sm:w-auto items-center",children:[l.jsx(Kl,{data:s,fileName:"Catalogo_Productos",mapping:J,label:"Excel"}),l.jsxs("div",{className:"relative flex-1 sm:flex-none",children:[l.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16}),l.jsx("input",{type:"text",placeholder:"Buscar...",value:w,onChange:ie=>_(ie.target.value),className:"pl-9 pr-4 py-2 bg-slate-100 border-none rounded-full text-sm w-full sm:w-48"})]}),!n&&l.jsxs(ot,{onClick:we,className:"bg-indigo-600 hover:bg-indigo-700 text-white shadow-md",children:[l.jsx(xr,{size:18,className:"mr-1"})," Nuevo"]})]})]}),i&&l.jsxs("div",{className:"m-6 bg-red-50 text-red-700 p-4 rounded border border-red-200",children:[l.jsx(Nl,{size:18})," ",i]}),l.jsx("div",{className:"flex-1 overflow-auto p-6",children:l.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[!a&&Object.keys(D).length===0&&l.jsxs("div",{className:"text-center py-20 bg-white rounded border-dashed border-slate-300",children:[l.jsx(_c,{size:48,className:"mx-auto text-slate-300 mb-4"}),l.jsx("p",{className:"text-slate-500",children:"Sin productos"})]}),Object.entries(D).map(([ie,je])=>{var ce;const ke=Number(ie),Xe=((ce=h.find(be=>be.id===ke))==null?void 0:ce.full_name)||"Stock Interno",$e=N.has(ke),Te=Object.values(je).reduce((be,oe)=>be+oe.length,0);return l.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden",children:[l.jsx("div",{onClick:()=>te(ke),className:"bg-slate-50 px-4 py-3 border-b border-slate-200 flex items-center justify-between cursor-pointer hover:bg-slate-100",children:l.jsxs("div",{className:"flex items-center gap-2",children:[$e?l.jsx(qf,{size:16}):l.jsx(Yf,{size:16}),l.jsx("h2",{className:"font-bold text-slate-700 text-sm uppercase",children:Xe}),l.jsxs(la,{variant:"secondary",className:"text-[10px]",children:[Te," Productos"]})]})}),$e&&l.jsx("div",{className:"p-0",children:Object.entries(je).map(([be,oe])=>l.jsxs("div",{className:"border-b last:border-b-0 border-slate-100",children:[l.jsxs("div",{className:"bg-indigo-50/30 px-10 py-1.5 flex items-center gap-2 border-b border-slate-50",children:[l.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-400 rounded-full"}),l.jsx("h3",{className:"text-xs font-bold text-indigo-600 uppercase",children:be})]}),l.jsxs("table",{className:"w-full text-left",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-slate-100 bg-white text-[10px] text-slate-400 uppercase",children:[l.jsx("th",{className:"pl-12 pr-4 py-2 w-[40%]",children:"Producto"}),l.jsx("th",{className:"px-4 py-2 text-center w-[15%]",children:"Estado"}),l.jsx("th",{className:"px-4 py-2 w-[20%]",children:"Versin"}),l.jsx("th",{className:"px-4 py-2 text-right w-[25%]",children:"Acciones"})]})}),l.jsx("tbody",{children:oe.map(A=>{var Z;const H=(Z=A.versions)==null?void 0:Z[0];return l.jsxs("tr",{className:"group hover:bg-indigo-50/10 border-b last:border-b-0 border-slate-50",children:[l.jsx("td",{className:"pl-12 pr-4 py-3",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-slate-100 p-1.5 rounded text-slate-400",children:l.jsx(_c,{size:16})}),l.jsxs("div",{children:[l.jsx("div",{className:`font-bold text-sm ${n?"text-slate-600 cursor-default":"text-slate-700 hover:underline cursor-pointer text-indigo-700"}`,onClick:()=>pe(A.id,A.versions),children:A.name}),l.jsxs("div",{className:"text-[10px] text-slate-400 font-mono",children:["ID: ",A.id]})]})]})}),l.jsx("td",{className:"px-4 py-3 text-center",children:(H==null?void 0:H.status)===vr.READY?l.jsxs("span",{className:"text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded-full border border-emerald-100 flex items-center justify-center gap-1",children:[l.jsx(Cl,{size:10})," Listo"]}):l.jsxs("span",{className:"text-[10px] font-bold text-amber-600 bg-amber-50 px-2 py-1 rounded-full border border-amber-100 flex items-center justify-center gap-1",children:[l.jsx(Nl,{size:10})," Borrador"]})}),l.jsx("td",{className:"px-4 py-3",children:H?l.jsx("span",{className:"text-xs bg-slate-100 px-2 py-1 rounded border border-slate-200",children:H.version_name}):l.jsx("span",{className:"text-[10px] text-slate-400 italic",children:"Sin Recetas"})}),l.jsx("td",{className:"px-4 py-3 text-right",children:l.jsxs("div",{className:"flex justify-end gap-2",children:[A.blueprint_path?l.jsxs("div",{className:`flex gap-1 mr-2 ${n?"":"border-r border-slate-200 pr-2"}`,children:[l.jsx("button",{onClick:de=>{de.stopPropagation(),ue(A.blueprint_path)},className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"Ver Plano",children:l.jsx(As,{size:16})}),!n&&l.jsx("button",{onClick:de=>R(de,A.id),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded",children:l.jsx(OE,{size:16})})]}):!n&&l.jsx("div",{className:"mr-2 border-r border-slate-200 pr-2",children:l.jsx("button",{onClick:de=>{de.stopPropagation(),q(A.id)},className:"p-1.5 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded",children:l.jsx(zE,{size:16})})}),!n&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:de=>Ee(de,A),className:"p-1.5 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded",children:l.jsx(lu,{size:16})}),l.jsx("button",{onClick:de=>xe(de,A.id,A.name),className:"p-1.5 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded",children:l.jsx(Rn,{size:16})})]})]})})]},A.id)})})]})]},be))})]},ke)})]})}),l.jsx(yy,{isOpen:p,onClose:()=>m(!1),title:x?"Editar Producto":"Nuevo Producto",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Cliente"}),l.jsxs("select",{className:"w-full p-2 border rounded",value:z.client_id,onChange:ie=>V({...z,client_id:Number(ie.target.value)}),children:[l.jsx("option",{value:0,children:"-- Seleccionar --"}),h.map(ie=>l.jsx("option",{value:ie.id,children:ie.full_name},ie.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Nombre"}),l.jsx(fr,{placeholder:"Ej. Cocina Torre Y",value:z.name,onChange:ie=>V({...z,name:ie.target.value})})]}),l.jsxs("div",{className:"relative",children:[l.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Categora"}),l.jsx(fr,{placeholder:"Ej. Cocinas",value:z.category,onChange:ie=>{V({...z,category:ie.target.value}),P(!0)},onFocus:()=>P(!0),onBlur:()=>setTimeout(()=>P(!1),300)}),S&&l.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white rounded shadow-lg border max-h-48 overflow-auto",children:B.map((ie,je)=>l.jsx("div",{className:"px-4 py-2 hover:bg-indigo-50 cursor-pointer",onMouseDown:()=>{V({...z,category:ie}),P(!1)},children:ie},je))})]}),l.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[l.jsx(ot,{variant:"secondary",onClick:()=>m(!1),children:"Cancelar"}),l.jsx(ot,{onClick:Le,disabled:!z.name||!z.client_id,children:x?"Guardar":"Crear"})]})]})}),C&&l.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-xl w-full max-w-6xl h-[90vh] flex flex-col relative",children:[l.jsxs("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold flex gap-2",children:[l.jsx(As,{size:18})," Visor"]}),l.jsx("button",{onClick:fe,children:l.jsx(kr,{size:20})})]}),l.jsx("div",{className:"flex-1 bg-slate-100",children:l.jsx("iframe",{src:C,className:"w-full h-full border-none",title:"Plano"})})]})})]})};var Ql=e=>e.type==="checkbox",Ys=e=>e instanceof Date,yr=e=>e==null;const wy=e=>typeof e=="object";var Rt=e=>!yr(e)&&!Array.isArray(e)&&wy(e)&&!Ys(e),OF=e=>Rt(e)&&e.target?Ql(e.target)?e.target.checked:e.target.value:e,IF=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,PF=(e,t)=>e.has(IF(t)),LF=e=>{const t=e.constructor&&e.constructor.prototype;return Rt(t)&&t.hasOwnProperty("isPrototypeOf")},kh=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ut(e){if(e instanceof Date)return new Date(e);const t=typeof FileList<"u"&&e instanceof FileList;if(kh&&(e instanceof Blob||t))return e;const r=Array.isArray(e);if(!r&&!(Rt(e)&&LF(e)))return e;const n=r?[]:Object.create(Object.getPrototypeOf(e));for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=ut(e[s]));return n}var Cu=e=>/^\w*$/.test(e),st=e=>e===void 0,Tu=e=>Array.isArray(e)?e.filter(Boolean):[],Rh=e=>Tu(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Re=(e,t,r)=>{if(!t||!Rt(e))return r;const n=(Cu(t)?[t]:Rh(t)).reduce((s,a)=>yr(s)?s:s[a],e);return st(n)||n===e?st(e[t])?r:e[t]:n},Tn=e=>typeof e=="boolean",dn=e=>typeof e=="function",at=(e,t,r)=>{let n=-1;const s=Cu(t)?[t]:Rh(t),a=s.length,i=a-1;for(;++n<a;){const o=s[n];let c=r;if(n!==i){const u=e[o];c=Rt(u)||Array.isArray(u)?u:isNaN(+s[n+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;e[o]=c,e=e[o]}};const cm={BLUR:"blur",FOCUS_OUT:"focusout"},Kr={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Pn={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},_y=qe.createContext(null);_y.displayName="HookFormContext";const MF=()=>qe.useContext(_y);var BF=(e,t,r,n=!0)=>{const s={defaultValues:t._defaultValues};for(const a in e)Object.defineProperty(s,a,{get:()=>{const i=a;return t._proxyFormState[i]!==Kr.all&&(t._proxyFormState[i]=!n||Kr.all),e[i]}});return s};const Sy=typeof window<"u"?qe.useLayoutEffect:qe.useEffect;var Mr=e=>typeof e=="string",UF=(e,t,r,n,s)=>Mr(e)?(n&&t.watch.add(e),Re(r,e,s)):Array.isArray(e)?e.map(a=>(n&&t.watch.add(a),Re(r,a))):(n&&(t.watchAll=!0),r),Vd=e=>yr(e)||!wy(e);function cs(e,t,r=new WeakSet){if(Vd(e)||Vd(t))return Object.is(e,t);if(Ys(e)&&Ys(t))return Object.is(e.getTime(),t.getTime());const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;if(r.has(e)||r.has(t))return!0;r.add(e),r.add(t);for(const a of n){const i=e[a];if(!s.includes(a))return!1;if(a!=="ref"){const o=t[a];if(Ys(i)&&Ys(o)||Rt(i)&&Rt(o)||Array.isArray(i)&&Array.isArray(o)?!cs(i,o,r):!Object.is(i,o))return!1}}return!0}var zF=(e,t,r,n,s)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:s||!0}}:{},Er=e=>Array.isArray(e)?e:[e],um=()=>{let e=[];return{get observers(){return e},next:s=>{for(const a of e)a.next&&a.next(s)},subscribe:s=>(e.push(s),{unsubscribe:()=>{e=e.filter(a=>a!==s)}}),unsubscribe:()=>{e=[]}}};function Ey(e,t){const r={};for(const n in e)if(e.hasOwnProperty(n)){const s=e[n],a=t[n];if(s&&Rt(s)&&a){const i=Ey(s,a);Rt(i)&&(r[n]=i)}else e[n]&&(r[n]=a)}return r}var rr=e=>Rt(e)&&!Object.keys(e).length,Fh=e=>e.type==="file",Uc=e=>{if(!kh)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Ny=e=>e.type==="select-multiple",Dh=e=>e.type==="radio",VF=e=>Dh(e)||Ql(e),S0=e=>Uc(e)&&e.isConnected;function $F(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=st(e)?n++:e[t[n++]];return e}function HF(e){for(const t in e)if(e.hasOwnProperty(t)&&!st(e[t]))return!1;return!0}function Ct(e,t){const r=Array.isArray(t)?t:Cu(t)?[t]:Rh(t),n=r.length===1?e:$F(e,r),s=r.length-1,a=r[s];return n&&delete n[a],s!==0&&(Rt(n)&&rr(n)||Array.isArray(n)&&HF(n))&&Ct(e,r.slice(0,-1)),e}var GF=e=>{for(const t in e)if(dn(e[t]))return!0;return!1};function Cy(e){return Array.isArray(e)||Rt(e)&&!GF(e)}function $d(e,t={}){for(const r in e){const n=e[r];Cy(n)?(t[r]=Array.isArray(n)?[]:{},$d(n,t[r])):st(n)||(t[r]=!0)}return t}function Ta(e,t,r){r||(r=$d(t));for(const n in e){const s=e[n];if(Cy(s))st(t)||Vd(r[n])?r[n]=$d(s,Array.isArray(s)?[]:{}):Ta(s,yr(t)?{}:t[n],r[n]);else{const a=t[n];r[n]=!cs(s,a)}}return r}const dm={value:!1,isValid:!1},fm={value:!0,isValid:!0};var Ty=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!st(e[0].attributes.value)?st(e[0].value)||e[0].value===""?fm:{value:e[0].value,isValid:!0}:fm:dm}return dm},by=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>st(e)?e:t?e===""?NaN:e&&+e:r&&Mr(e)?new Date(e):n?n(e):e;const hm={isValid:!1,value:null};var Ay=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,hm):hm;function pm(e){const t=e.ref;return Fh(t)?t.files:Dh(t)?Ay(e.refs).value:Ny(t)?[...t.selectedOptions].map(({value:r})=>r):Ql(t)?Ty(e.refs).value:by(st(t.value)?e.ref.value:t.value,e)}var WF=(e,t,r,n)=>{const s={};for(const a of e){const i=Re(t,a);i&&at(s,a,i._f)}return{criteriaMode:r,names:[...e],fields:s,shouldUseNativeValidation:n}},zc=e=>e instanceof RegExp,Pi=e=>st(e)?e:zc(e)?e.source:Rt(e)?zc(e.value)?e.value.source:e.value:e,Ua=e=>({isOnSubmit:!e||e===Kr.onSubmit,isOnBlur:e===Kr.onBlur,isOnChange:e===Kr.onChange,isOnAll:e===Kr.all,isOnTouch:e===Kr.onTouched});const xm="AsyncFunction";var XF=e=>!!e&&!!e.validate&&!!(dn(e.validate)&&e.validate.constructor.name===xm||Rt(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===xm)),qF=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),Hd=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const Ja=(e,t,r,n)=>{for(const s of r||Object.keys(e)){const a=Re(e,s);if(a){const{_f:i,...o}=a;if(i){if(i.refs&&i.refs[0]&&t(i.refs[0],s)&&!n)return!0;if(i.ref&&t(i.ref,i.name)&&!n)return!0;if(Ja(o,t))break}else if(Rt(o)&&Ja(o,t))break}}};function mm(e,t,r){const n=Re(e,r);if(n||Cu(r))return{error:n,name:r};const s=r.split(".");for(;s.length;){const a=s.join("."),i=Re(t,a),o=Re(e,a);if(i&&!Array.isArray(i)&&r!==a)return{name:r};if(o&&o.type)return{name:a,error:o};if(o&&o.root&&o.root.type)return{name:`${a}.root`,error:o.root};s.pop()}return{name:r}}var YF=(e,t,r,n)=>{r(e);const{name:s,...a}=e;return rr(a)||Object.keys(a).length>=Object.keys(t).length||Object.keys(a).find(i=>t[i]===(!n||Kr.all))},KF=(e,t,r)=>!e||!t||e===t||Er(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n))),QF=(e,t,r,n,s)=>s.isOnAll?!1:!r&&s.isOnTouch?!(t||e):(r?n.isOnBlur:s.isOnBlur)?!e:(r?n.isOnChange:s.isOnChange)?e:!0,JF=(e,t)=>!Tu(Re(e,t)).length&&Ct(e,t),jy=(e,t,r)=>{const n=Er(Re(e,r));return at(n,"root",t[r]),at(e,r,n),e};function gm(e,t,r="validate"){if(Mr(e)||Array.isArray(e)&&e.every(Mr)||Tn(e)&&!e)return{type:r,message:Mr(e)?e:"",ref:t}}var Na=e=>Rt(e)&&!zc(e)?e:{value:e,message:""},Gd=async(e,t,r,n,s,a)=>{const{ref:i,refs:o,required:c,maxLength:u,minLength:d,min:h,max:f,pattern:p,validate:m,name:x,valueAsNumber:g,mount:y}=e._f,v=Re(r,x);if(!y||t.has(x))return{};const w=o?o[0]:i,_=C=>{s&&w.reportValidity&&(w.setCustomValidity(Tn(C)?"":C||""),w.reportValidity())},S={},P=Dh(i),N=Ql(i),I=P||N,M=(g||Fh(i))&&st(i.value)&&st(v)||Uc(i)&&i.value===""||v===""||Array.isArray(v)&&!v.length,L=zF.bind(null,x,n,S),X=(C,U,z,V=Pn.maxLength,G=Pn.minLength)=>{const J=C?U:z;S[x]={type:C?V:G,message:J,ref:i,...L(C?V:G,J)}};if(a?!Array.isArray(v)||!v.length:c&&(!I&&(M||yr(v))||Tn(v)&&!v||N&&!Ty(o).isValid||P&&!Ay(o).isValid)){const{value:C,message:U}=Mr(c)?{value:!!c,message:c}:Na(c);if(C&&(S[x]={type:Pn.required,message:U,ref:w,...L(Pn.required,U)},!n))return _(U),S}if(!M&&(!yr(h)||!yr(f))){let C,U;const z=Na(f),V=Na(h);if(!yr(v)&&!isNaN(v)){const G=i.valueAsNumber||v&&+v;yr(z.value)||(C=G>z.value),yr(V.value)||(U=G<V.value)}else{const G=i.valueAsDate||new Date(v),J=ue=>new Date(new Date().toDateString()+" "+ue),q=i.type=="time",se=i.type=="week";Mr(z.value)&&v&&(C=q?J(v)>J(z.value):se?v>z.value:G>new Date(z.value)),Mr(V.value)&&v&&(U=q?J(v)<J(V.value):se?v<V.value:G<new Date(V.value))}if((C||U)&&(X(!!C,z.message,V.message,Pn.max,Pn.min),!n))return _(S[x].message),S}if((u||d)&&!M&&(Mr(v)||a&&Array.isArray(v))){const C=Na(u),U=Na(d),z=!yr(C.value)&&v.length>+C.value,V=!yr(U.value)&&v.length<+U.value;if((z||V)&&(X(z,C.message,U.message),!n))return _(S[x].message),S}if(p&&!M&&Mr(v)){const{value:C,message:U}=Na(p);if(zc(C)&&!v.match(C)&&(S[x]={type:Pn.pattern,message:U,ref:i,...L(Pn.pattern,U)},!n))return _(U),S}if(m){if(dn(m)){const C=await m(v,r),U=gm(C,w);if(U&&(S[x]={...U,...L(Pn.validate,U.message)},!n))return _(U.message),S}else if(Rt(m)){let C={};for(const U in m){if(!rr(C)&&!n)break;const z=gm(await m[U](v,r),w,U);z&&(C={...z,...L(U,z.message)},_(z.message),n&&(S[x]=C))}if(!rr(C)&&(S[x]={ref:w,...C},!n))return S}}return _(!0),S};const ZF={mode:Kr.onSubmit,reValidateMode:Kr.onChange,shouldFocusError:!0};function e5(e={}){let t={...ZF,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:dn(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},s=Rt(t.defaultValues)||Rt(t.values)?ut(t.defaultValues||t.values)||{}:{},a=t.shouldUnregister?{}:ut(s),i={action:!1,mount:!1,watch:!1,keepIsValid:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},h={...d};let f={...h};const p={array:um(),state:um()},m=t.criteriaMode===Kr.all,x=A=>H=>{clearTimeout(u),u=setTimeout(A,H)},g=async A=>{if(!i.keepIsValid&&!t.disabled&&(h.isValid||f.isValid||A)){let H;t.resolver?(H=rr((await I()).errors),y()):H=await L(n,!0),H!==r.isValid&&p.state.next({isValid:H})}},y=(A,H)=>{!t.disabled&&(h.isValidating||h.validatingFields||f.isValidating||f.validatingFields)&&((A||Array.from(o.mount)).forEach(Z=>{Z&&(H?at(r.validatingFields,Z,H):Ct(r.validatingFields,Z))}),p.state.next({validatingFields:r.validatingFields,isValidating:!rr(r.validatingFields)}))},v=(A,H=[],Z,de,ve=!0,he=!0)=>{if(de&&Z&&!t.disabled){if(i.action=!0,he&&Array.isArray(Re(n,A))){const Ie=Z(Re(n,A),de.argA,de.argB);ve&&at(n,A,Ie)}if(he&&Array.isArray(Re(r.errors,A))){const Ie=Z(Re(r.errors,A),de.argA,de.argB);ve&&at(r.errors,A,Ie),JF(r.errors,A)}if((h.touchedFields||f.touchedFields)&&he&&Array.isArray(Re(r.touchedFields,A))){const Ie=Z(Re(r.touchedFields,A),de.argA,de.argB);ve&&at(r.touchedFields,A,Ie)}(h.dirtyFields||f.dirtyFields)&&(r.dirtyFields=Ta(s,a)),p.state.next({name:A,isDirty:C(A,H),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else at(a,A,H)},w=(A,H)=>{at(r.errors,A,H),p.state.next({errors:r.errors})},_=A=>{r.errors=A,p.state.next({errors:r.errors,isValid:!1})},S=(A,H,Z,de)=>{const ve=Re(n,A);if(ve){const he=Re(a,A,st(Z)?Re(s,A):Z);st(he)||de&&de.defaultChecked||H?at(a,A,H?he:pm(ve._f)):V(A,he),i.mount&&!i.action&&g()}},P=(A,H,Z,de,ve)=>{let he=!1,Ie=!1;const He={name:A};if(!t.disabled){if(!Z||de){(h.isDirty||f.isDirty)&&(Ie=r.isDirty,r.isDirty=He.isDirty=C(),he=Ie!==He.isDirty);const Ke=cs(Re(s,A),H);Ie=!!Re(r.dirtyFields,A),Ke?Ct(r.dirtyFields,A):at(r.dirtyFields,A,!0),He.dirtyFields=r.dirtyFields,he=he||(h.dirtyFields||f.dirtyFields)&&Ie!==!Ke}if(Z){const Ke=Re(r.touchedFields,A);Ke||(at(r.touchedFields,A,Z),He.touchedFields=r.touchedFields,he=he||(h.touchedFields||f.touchedFields)&&Ke!==Z)}he&&ve&&p.state.next(He)}return he?He:{}},N=(A,H,Z,de)=>{const ve=Re(r.errors,A),he=(h.isValid||f.isValid)&&Tn(H)&&r.isValid!==H;if(t.delayError&&Z?(c=x(()=>w(A,Z)),c(t.delayError)):(clearTimeout(u),c=null,Z?at(r.errors,A,Z):Ct(r.errors,A)),(Z?!cs(ve,Z):ve)||!rr(de)||he){const Ie={...de,...he&&Tn(H)?{isValid:H}:{},errors:r.errors,name:A};r={...r,...Ie},p.state.next(Ie)}},I=async A=>(y(A,!0),await t.resolver(a,t.context,WF(A||o.mount,n,t.criteriaMode,t.shouldUseNativeValidation))),M=async A=>{const{errors:H}=await I(A);if(y(A),A)for(const Z of A){const de=Re(H,Z);de?at(r.errors,Z,de):Ct(r.errors,Z)}else r.errors=H;return H},L=async(A,H,Z={valid:!0})=>{for(const de in A){const ve=A[de];if(ve){const{_f:he,...Ie}=ve;if(he){const He=o.array.has(he.name),Ke=ve._f&&XF(ve._f);Ke&&h.validatingFields&&y([he.name],!0);const Pt=await Gd(ve,o.disabled,a,m,t.shouldUseNativeValidation&&!H,He);if(Ke&&h.validatingFields&&y([he.name]),Pt[he.name]&&(Z.valid=!1,H||e.shouldUseNativeValidation))break;!H&&(Re(Pt,he.name)?He?jy(r.errors,Pt,he.name):at(r.errors,he.name,Pt[he.name]):Ct(r.errors,he.name))}!rr(Ie)&&await L(Ie,H,Z)}}return Z.valid},X=()=>{for(const A of o.unMount){const H=Re(n,A);H&&(H._f.refs?H._f.refs.every(Z=>!S0(Z)):!S0(H._f.ref))&&Ee(A)}o.unMount=new Set},C=(A,H)=>!t.disabled&&(A&&H&&at(a,A,H),!cs(fe(),s)),U=(A,H,Z)=>UF(A,o,{...i.mount?a:st(H)?s:Mr(A)?{[A]:H}:H},Z,H),z=A=>Tu(Re(i.mount?a:s,A,t.shouldUnregister?Re(s,A,[]):[])),V=(A,H,Z={})=>{const de=Re(n,A);let ve=H;if(de){const he=de._f;he&&(!he.disabled&&at(a,A,by(H,he)),ve=Uc(he.ref)&&yr(H)?"":H,Ny(he.ref)?[...he.ref.options].forEach(Ie=>Ie.selected=ve.includes(Ie.value)):he.refs?Ql(he.ref)?he.refs.forEach(Ie=>{(!Ie.defaultChecked||!Ie.disabled)&&(Array.isArray(ve)?Ie.checked=!!ve.find(He=>He===Ie.value):Ie.checked=ve===Ie.value||!!ve)}):he.refs.forEach(Ie=>Ie.checked=Ie.value===ve):Fh(he.ref)?he.ref.value="":(he.ref.value=ve,he.ref.type||p.state.next({name:A,values:ut(a)})))}(Z.shouldDirty||Z.shouldTouch)&&P(A,ve,Z.shouldTouch,Z.shouldDirty,!0),Z.shouldValidate&&ue(A)},G=(A,H,Z)=>{for(const de in H){if(!H.hasOwnProperty(de))return;const ve=H[de],he=A+"."+de,Ie=Re(n,he);(o.array.has(A)||Rt(ve)||Ie&&!Ie._f)&&!Ys(ve)?G(he,ve,Z):V(he,ve,Z)}},J=(A,H,Z={})=>{const de=Re(n,A),ve=o.array.has(A),he=ut(H);at(a,A,he),ve?(p.array.next({name:A,values:ut(a)}),(h.isDirty||h.dirtyFields||f.isDirty||f.dirtyFields)&&Z.shouldDirty&&p.state.next({name:A,dirtyFields:Ta(s,a),isDirty:C(A,he)})):de&&!de._f&&!yr(he)?G(A,he,Z):V(A,he,Z),Hd(A,o)?p.state.next({...r,name:A,values:ut(a)}):p.state.next({name:i.mount?A:void 0,values:ut(a)})},q=async A=>{i.mount=!0;const H=A.target;let Z=H.name,de=!0;const ve=Re(n,Z),he=Ke=>{de=Number.isNaN(Ke)||Ys(Ke)&&isNaN(Ke.getTime())||cs(Ke,Re(a,Z,Ke))},Ie=Ua(t.mode),He=Ua(t.reValidateMode);if(ve){let Ke,Pt;const wn=H.type?pm(ve._f):OF(A),rn=A.type===cm.BLUR||A.type===cm.FOCUS_OUT,Jl=!qF(ve._f)&&!t.resolver&&!Re(r.errors,Z)&&!ve._f.deps||QF(rn,Re(r.touchedFields,Z),r.isSubmitted,He,Ie),va=Hd(Z,o,rn);at(a,Z,wn),rn?(!H||!H.readOnly)&&(ve._f.onBlur&&ve._f.onBlur(A),c&&c(0)):ve._f.onChange&&ve._f.onChange(A);const ya=P(Z,wn,rn),bu=!rr(ya)||va;if(!rn&&p.state.next({name:Z,type:A.type,values:ut(a)}),Jl)return(h.isValid||f.isValid)&&(t.mode==="onBlur"?rn&&g():rn||g()),bu&&p.state.next({name:Z,...va?{}:ya});if(!rn&&va&&p.state.next({...r}),t.resolver){const{errors:Zl}=await I([Z]);if(y([Z]),he(wn),de){const eo=mm(r.errors,n,Z),_i=mm(Zl,n,eo.name||Z);Ke=_i.error,Z=_i.name,Pt=rr(Zl)}}else y([Z],!0),Ke=(await Gd(ve,o.disabled,a,m,t.shouldUseNativeValidation))[Z],y([Z]),he(wn),de&&(Ke?Pt=!1:(h.isValid||f.isValid)&&(Pt=await L(n,!0)));de&&(ve._f.deps&&(!Array.isArray(ve._f.deps)||ve._f.deps.length>0)&&ue(ve._f.deps),N(Z,Pt,Ke,ya))}},se=(A,H)=>{if(Re(r.errors,H)&&A.focus)return A.focus(),1},ue=async(A,H={})=>{let Z,de;const ve=Er(A);if(t.resolver){const he=await M(st(A)?A:ve);Z=rr(he),de=A?!ve.some(Ie=>Re(he,Ie)):Z}else A?(de=(await Promise.all(ve.map(async he=>{const Ie=Re(n,he);return await L(Ie&&Ie._f?{[he]:Ie}:Ie)}))).every(Boolean),!(!de&&!r.isValid)&&g()):de=Z=await L(n);return p.state.next({...!Mr(A)||(h.isValid||f.isValid)&&Z!==r.isValid?{}:{name:A},...t.resolver||!A?{isValid:Z}:{},errors:r.errors}),H.shouldFocus&&!de&&Ja(n,se,A?ve:o.mount),de},fe=(A,H)=>{let Z={...i.mount?a:s};return H&&(Z=Ey(H.dirtyFields?r.dirtyFields:r.touchedFields,Z)),st(A)?Z:Mr(A)?Re(Z,A):A.map(de=>Re(Z,de))},R=(A,H)=>({invalid:!!Re((H||r).errors,A),isDirty:!!Re((H||r).dirtyFields,A),error:Re((H||r).errors,A),isValidating:!!Re(r.validatingFields,A),isTouched:!!Re((H||r).touchedFields,A)}),W=A=>{A&&Er(A).forEach(H=>Ct(r.errors,H)),p.state.next({errors:A?r.errors:{}})},B=(A,H,Z)=>{const de=(Re(n,A,{_f:{}})._f||{}).ref,ve=Re(r.errors,A)||{},{ref:he,message:Ie,type:He,...Ke}=ve;at(r.errors,A,{...Ke,...H,ref:de}),p.state.next({name:A,errors:r.errors,isValid:!1}),Z&&Z.shouldFocus&&de&&de.focus&&de.focus()},D=(A,H)=>dn(A)?p.state.subscribe({next:Z=>"values"in Z&&A(U(void 0,H),Z)}):U(A,H,!0),te=A=>p.state.subscribe({next:H=>{KF(A.name,H.name,A.exact)&&YF(H,A.formState||h,ce,A.reRenderRoot)&&A.callback({values:{...a},...r,...H,defaultValues:s})}}).unsubscribe,we=A=>(i.mount=!0,f={...f,...A.formState},te({...A,formState:{...d,...A.formState}})),Ee=(A,H={})=>{for(const Z of A?Er(A):o.mount)o.mount.delete(Z),o.array.delete(Z),H.keepValue||(Ct(n,Z),Ct(a,Z)),!H.keepError&&Ct(r.errors,Z),!H.keepDirty&&Ct(r.dirtyFields,Z),!H.keepTouched&&Ct(r.touchedFields,Z),!H.keepIsValidating&&Ct(r.validatingFields,Z),!t.shouldUnregister&&!H.keepDefaultValue&&Ct(s,Z);p.state.next({values:ut(a)}),p.state.next({...r,...H.keepDirty?{isDirty:C()}:{}}),!H.keepIsValid&&g()},xe=({disabled:A,name:H})=>{(Tn(A)&&i.mount||A||o.disabled.has(H))&&(A?o.disabled.add(H):o.disabled.delete(H))},pe=(A,H={})=>{let Z=Re(n,A);const de=Tn(H.disabled)||Tn(t.disabled);return at(n,A,{...Z||{},_f:{...Z&&Z._f?Z._f:{ref:{name:A}},name:A,mount:!0,...H}}),o.mount.add(A),Z?xe({disabled:Tn(H.disabled)?H.disabled:t.disabled,name:A}):S(A,!0,H.value),{...de?{disabled:H.disabled||t.disabled}:{},...t.progressive?{required:!!H.required,min:Pi(H.min),max:Pi(H.max),minLength:Pi(H.minLength),maxLength:Pi(H.maxLength),pattern:Pi(H.pattern)}:{},name:A,onChange:q,onBlur:q,ref:ve=>{if(ve){pe(A,H),Z=Re(n,A);const he=st(ve.value)&&ve.querySelectorAll&&ve.querySelectorAll("input,select,textarea")[0]||ve,Ie=VF(he),He=Z._f.refs||[];if(Ie?He.find(Ke=>Ke===he):he===Z._f.ref)return;at(n,A,{_f:{...Z._f,...Ie?{refs:[...He.filter(S0),he,...Array.isArray(Re(s,A))?[{}]:[]],ref:{type:he.type,name:A}}:{ref:he}}}),S(A,!1,void 0,he)}else Z=Re(n,A,{}),Z._f&&(Z._f.mount=!1),(t.shouldUnregister||H.shouldUnregister)&&!(PF(o.array,A)&&i.action)&&o.unMount.add(A)}}},Le=()=>t.shouldFocusError&&Ja(n,se,o.mount),ie=A=>{Tn(A)&&(p.state.next({disabled:A}),Ja(n,(H,Z)=>{const de=Re(n,Z);de&&(H.disabled=de._f.disabled||A,Array.isArray(de._f.refs)&&de._f.refs.forEach(ve=>{ve.disabled=de._f.disabled||A}))},0,!1))},je=(A,H)=>async Z=>{let de;Z&&(Z.preventDefault&&Z.preventDefault(),Z.persist&&Z.persist());let ve=ut(a);if(p.state.next({isSubmitting:!0}),t.resolver){const{errors:he,values:Ie}=await I();y(),r.errors=he,ve=ut(Ie)}else await L(n);if(o.disabled.size)for(const he of o.disabled)Ct(ve,he);if(Ct(r.errors,"root"),rr(r.errors)){p.state.next({errors:{}});try{await A(ve,Z)}catch(he){de=he}}else H&&await H({...r.errors},Z),Le(),setTimeout(Le);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:rr(r.errors)&&!de,submitCount:r.submitCount+1,errors:r.errors}),de)throw de},ke=(A,H={})=>{Re(n,A)&&(st(H.defaultValue)?J(A,ut(Re(s,A))):(J(A,H.defaultValue),at(s,A,ut(H.defaultValue))),H.keepTouched||Ct(r.touchedFields,A),H.keepDirty||(Ct(r.dirtyFields,A),r.isDirty=H.defaultValue?C(A,ut(Re(s,A))):C()),H.keepError||(Ct(r.errors,A),h.isValid&&g()),p.state.next({...r}))},Xe=(A,H={})=>{const Z=A?ut(A):s,de=ut(Z),ve=rr(A),he=ve?s:de;if(H.keepDefaultValues||(s=Z),!H.keepValues){if(H.keepDirtyValues){const Ie=new Set([...o.mount,...Object.keys(Ta(s,a))]);for(const He of Array.from(Ie)){const Ke=Re(r.dirtyFields,He),Pt=Re(a,He),wn=Re(he,He);Ke&&!st(Pt)?at(he,He,Pt):!Ke&&!st(wn)&&J(He,wn)}}else{if(kh&&st(A))for(const Ie of o.mount){const He=Re(n,Ie);if(He&&He._f){const Ke=Array.isArray(He._f.refs)?He._f.refs[0]:He._f.ref;if(Uc(Ke)){const Pt=Ke.closest("form");if(Pt){Pt.reset();break}}}}if(H.keepFieldsRef)for(const Ie of o.mount)J(Ie,Re(he,Ie));else n={}}a=t.shouldUnregister?H.keepDefaultValues?ut(s):{}:ut(he),p.array.next({values:{...he}}),p.state.next({values:{...he}})}o={mount:H.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!h.isValid||!!H.keepIsValid||!!H.keepDirtyValues||!t.shouldUnregister&&!rr(he),i.watch=!!t.shouldUnregister,i.keepIsValid=!!H.keepIsValid,i.action=!1,H.keepErrors||(r.errors={}),p.state.next({submitCount:H.keepSubmitCount?r.submitCount:0,isDirty:ve?!1:H.keepDirty?r.isDirty:!!(H.keepDefaultValues&&!cs(A,s)),isSubmitted:H.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:ve?{}:H.keepDirtyValues?H.keepDefaultValues&&a?Ta(s,a):r.dirtyFields:H.keepDefaultValues&&A?Ta(s,A):H.keepDirty?r.dirtyFields:{},touchedFields:H.keepTouched?r.touchedFields:{},errors:H.keepErrors?r.errors:{},isSubmitSuccessful:H.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},$e=(A,H)=>Xe(dn(A)?A(a):A,{...t.resetOptions,...H}),Te=(A,H={})=>{const Z=Re(n,A),de=Z&&Z._f;if(de){const ve=de.refs?de.refs[0]:de.ref;ve.focus&&setTimeout(()=>{ve.focus(),H.shouldSelect&&dn(ve.select)&&ve.select()})}},ce=A=>{r={...r,...A}},oe={control:{register:pe,unregister:Ee,getFieldState:R,handleSubmit:je,setError:B,_subscribe:te,_runSchema:I,_updateIsValidating:y,_focusError:Le,_getWatch:U,_getDirty:C,_setValid:g,_setFieldArray:v,_setDisabledField:xe,_setErrors:_,_getFieldArray:z,_reset:Xe,_resetDefaultValues:()=>dn(t.defaultValues)&&t.defaultValues().then(A=>{$e(A,t.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:X,_disableForm:ie,_subjects:p,_proxyFormState:h,get _fields(){return n},get _formValues(){return a},get _state(){return i},set _state(A){i=A},get _defaultValues(){return s},get _names(){return o},set _names(A){o=A},get _formState(){return r},get _options(){return t},set _options(A){t={...t,...A}}},subscribe:we,trigger:ue,register:pe,handleSubmit:je,watch:D,setValue:J,getValues:fe,reset:$e,resetField:ke,clearErrors:W,unregister:Ee,setError:B,setFocus:Te,getFieldState:R};return{...oe,formControl:oe}}var ns=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=(Math.random()*16+e)%16|0;return(t=="x"?r:r&3|8).toString(16)})},E0=(e,t,r={})=>r.shouldFocus||st(r.shouldFocus)?r.focusName||`${e}.${st(r.focusIndex)?t:r.focusIndex}.`:"",N0=(e,t)=>[...e,...Er(t)],C0=e=>Array.isArray(e)?e.map(()=>{}):void 0;function T0(e,t,r){return[...e.slice(0,t),...Er(r),...e.slice(t)]}var b0=(e,t,r)=>Array.isArray(e)?(st(e[r])&&(e[r]=void 0),e.splice(r,0,e.splice(t,1)[0]),e):[],A0=(e,t)=>[...Er(t),...Er(e)];function t5(e,t){let r=0;const n=[...e];for(const s of t)n.splice(s-r,1),r++;return Tu(n).length?n:[]}var j0=(e,t)=>st(t)?[]:t5(e,Er(t).sort((r,n)=>r-n)),k0=(e,t,r)=>{[e[t],e[r]]=[e[r],e[t]]},vm=(e,t,r)=>(e[t]=r,e);function r5(e){const t=MF(),{control:r=t.control,name:n,keyName:s="id",shouldUnregister:a,rules:i}=e,[o,c]=qe.useState(r._getFieldArray(n)),u=qe.useRef(r._getFieldArray(n).map(ns)),d=qe.useRef(!1);r._names.array.add(n),qe.useMemo(()=>i&&o.length>=0&&r.register(n,i),[r,n,o.length,i]),Sy(()=>r._subjects.array.subscribe({next:({values:_,name:S})=>{if(S===n||!S){const P=Re(_,n);Array.isArray(P)&&(c(P),u.current=P.map(ns))}}}).unsubscribe,[r,n]);const h=qe.useCallback(_=>{d.current=!0,r._setFieldArray(n,_)},[r,n]),f=(_,S)=>{const P=Er(ut(_)),N=N0(r._getFieldArray(n),P);r._names.focus=E0(n,N.length-1,S),u.current=N0(u.current,P.map(ns)),h(N),c(N),r._setFieldArray(n,N,N0,{argA:C0(_)})},p=(_,S)=>{const P=Er(ut(_)),N=A0(r._getFieldArray(n),P);r._names.focus=E0(n,0,S),u.current=A0(u.current,P.map(ns)),h(N),c(N),r._setFieldArray(n,N,A0,{argA:C0(_)})},m=_=>{const S=j0(r._getFieldArray(n),_);u.current=j0(u.current,_),h(S),c(S),!Array.isArray(Re(r._fields,n))&&at(r._fields,n,void 0),r._setFieldArray(n,S,j0,{argA:_})},x=(_,S,P)=>{const N=Er(ut(S)),I=T0(r._getFieldArray(n),_,N);r._names.focus=E0(n,_,P),u.current=T0(u.current,_,N.map(ns)),h(I),c(I),r._setFieldArray(n,I,T0,{argA:_,argB:C0(S)})},g=(_,S)=>{const P=r._getFieldArray(n);k0(P,_,S),k0(u.current,_,S),h(P),c(P),r._setFieldArray(n,P,k0,{argA:_,argB:S},!1)},y=(_,S)=>{const P=r._getFieldArray(n);b0(P,_,S),b0(u.current,_,S),h(P),c(P),r._setFieldArray(n,P,b0,{argA:_,argB:S},!1)},v=(_,S)=>{const P=ut(S),N=vm(r._getFieldArray(n),_,P);u.current=[...N].map((I,M)=>!I||M===_?ns():u.current[M]),h(N),c([...N]),r._setFieldArray(n,N,vm,{argA:_,argB:P},!0,!1)},w=_=>{const S=Er(ut(_));u.current=S.map(ns),h([...S]),c([...S]),r._setFieldArray(n,[...S],P=>P,{},!0,!1)};return qe.useEffect(()=>{if(r._state.action=!1,Hd(n,r._names)&&r._subjects.state.next({...r._formState}),d.current&&(!Ua(r._options.mode).isOnSubmit||r._formState.isSubmitted)&&!Ua(r._options.reValidateMode).isOnSubmit)if(r._options.resolver)r._runSchema([n]).then(_=>{r._updateIsValidating([n]);const S=Re(_.errors,n),P=Re(r._formState.errors,n);(P?!S&&P.type||S&&(P.type!==S.type||P.message!==S.message):S&&S.type)&&(S?at(r._formState.errors,n,S):Ct(r._formState.errors,n),r._subjects.state.next({errors:r._formState.errors}))});else{const _=Re(r._fields,n);_&&_._f&&!(Ua(r._options.reValidateMode).isOnSubmit&&Ua(r._options.mode).isOnSubmit)&&Gd(_,r._names.disabled,r._formValues,r._options.criteriaMode===Kr.all,r._options.shouldUseNativeValidation,!0).then(S=>!rr(S)&&r._subjects.state.next({errors:jy(r._formState.errors,S,n)}))}r._subjects.state.next({name:n,values:ut(r._formValues)}),r._names.focus&&Ja(r._fields,(_,S)=>{if(r._names.focus&&S.startsWith(r._names.focus)&&_.focus)return _.focus(),1}),r._names.focus="",r._setValid(),d.current=!1},[o,n,r]),qe.useEffect(()=>(!Re(r._formValues,n)&&r._setFieldArray(n),()=>{const _=(S,P)=>{const N=Re(r._fields,S);N&&N._f&&(N._f.mount=P)};r._options.shouldUnregister||a?r.unregister(n):_(n,!1)}),[n,r,s,a]),{swap:qe.useCallback(g,[h,n,r]),move:qe.useCallback(y,[h,n,r]),prepend:qe.useCallback(p,[h,n,r]),append:qe.useCallback(f,[h,n,r]),remove:qe.useCallback(m,[h,n,r]),insert:qe.useCallback(x,[h,n,r]),update:qe.useCallback(v,[h,n,r]),replace:qe.useCallback(w,[h,n,r]),fields:qe.useMemo(()=>o.map((_,S)=>({..._,[s]:u.current[S]||ns()})),[o,s])}}function n5(e={}){const t=qe.useRef(void 0),r=qe.useRef(void 0),[n,s]=qe.useState({isDirty:!1,isValidating:!1,isLoading:dn(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:dn(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:n},e.defaultValues&&!dn(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:i,...o}=e5(e);t.current={...o,formState:n}}const a=t.current.control;return a._options=e,Sy(()=>{const i=a._subscribe({formState:a._proxyFormState,callback:()=>s({...a._formState}),reRenderRoot:!0});return s(o=>({...o,isReady:!0})),a._formState.isReady=!0,i},[a]),qe.useEffect(()=>a._disableForm(e.disabled),[a,e.disabled]),qe.useEffect(()=>{e.mode&&(a._options.mode=e.mode),e.reValidateMode&&(a._options.reValidateMode=e.reValidateMode)},[a,e.mode,e.reValidateMode]),qe.useEffect(()=>{e.errors&&(a._setErrors(e.errors),a._focusError())},[a,e.errors]),qe.useEffect(()=>{e.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,e.shouldUnregister]),qe.useEffect(()=>{if(a._proxyFormState.isDirty){const i=a._getDirty();i!==n.isDirty&&a._subjects.state.next({isDirty:i})}},[a,n.isDirty]),qe.useEffect(()=>{var i;e.values&&!cs(e.values,r.current)?(a._reset(e.values,{keepFieldsRef:!0,...a._options.resetOptions}),!((i=a._options.resetOptions)===null||i===void 0)&&i.keepIsValid||a._setValid(),r.current=e.values,s(o=>({...o}))):a._resetDefaultValues()},[a,e.values]),qe.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),t.current.formState=BF(n,a),t.current}const s5=({materials:e,edgebandingFactor:t,defaultValues:r,onSave:n,isLoading:s,initialStatus:a})=>{const{control:i,register:o,handleSubmit:c,setValue:u,getValues:d,watch:h}=n5({defaultValues:{components:[]},mode:"onChange"}),{fields:f,append:p,insert:m}=r5({control:i,name:"components"}),x=h("components"),[g,y]=b.useState(vr.DRAFT),[v,w]=b.useState({boardsTotal:0,producTotal:0}),_=(localStorage.getItem("user_role")||"").toUpperCase(),S=["ADMIN","ADMINISTRADOR","DIRECTOR","DIRECCION","DIRECTION"].includes(_),P=t&&t>0?t:25;b.useEffect(()=>{r&&r.length>0&&d("components").length===0&&u("components",r),a&&y(a)},[r,a,u,d]);const N=g===vr.READY||g===vr.OBSOLETE,I=C=>C?C.current_cost:0,M=(C,U)=>{var fe,R,W;if(N)return;const z=parseFloat(U)||0;u(`components.${C}.quantity`,z,{shouldValidate:!0});const V=d("components"),G=V[C],J=e.find(B=>B.id===Number(G.material_id));if(!J)return;const q=((fe=J.category)==null?void 0:fe.toUpperCase())||"",se=((R=J.name)==null?void 0:R.toUpperCase())||"";if((q.includes("TABLERO")||se.includes("MDF"))&&!se.includes("CUBRECANTO")){const B=(W=J.associated_element_sku)==null?void 0:W.trim().toUpperCase();if(B&&B.length>1){const Ee=V.findIndex(Le=>{const ie=e.find(je=>je.id===Number(Le.material_id));return ie&&ie.sku.trim().toUpperCase()===B});let xe=0;V.forEach((Le,ie)=>{var Xe;const je=ie===C?z:parseFloat(String(Le.quantity))||0,ke=e.find($e=>$e.id===Number(Le.material_id));ke&&((Xe=ke.associated_element_sku)==null?void 0:Xe.trim().toUpperCase())===B&&(xe+=je)});const pe=Number((xe*P).toFixed(2));if(Ee!==-1)u(`components.${Ee}.quantity`,pe);else{const Le=e.find(ie=>ie.sku.trim().toUpperCase()===B);Le&&m(C+1,{material_id:Le.id,quantity:pe,temp_category:G.temp_category})}}let D=0,te=0;d("components").forEach((Ee,xe)=>{var ie,je;const pe=xe===C?z:parseFloat(String(Ee.quantity))||0,Le=e.find(ke=>ke.id===Number(Ee.material_id));if(Le){const ke=((ie=Le.category)==null?void 0:ie.toUpperCase())||"",Xe=((je=Le.name)==null?void 0:je.toUpperCase())||"";(ke.includes("TABLERO")||Xe.includes("MDF"))&&!Xe.includes("CUBRECANTO")&&(D+=pe,te+=Math.ceil(pe))}});const we=V.findIndex(Ee=>{var xe;return((xe=e.find(pe=>pe.id===Number(Ee.material_id)))==null?void 0:xe.sku)==="PRODUC"});we!==-1&&u(`components.${we}.quantity`,te),w({boardsTotal:D,producTotal:te})}},L=b.useMemo(()=>{const C={Gabinetes:[],Piedra:[],Otros:[]};return f.forEach((U,z)=>{const V=x==null?void 0:x[z],G=(V==null?void 0:V.temp_category)||U.temp_category||"Otros";C[G]||(C[G]=[]),C[G].push({...U,originalIndex:z})}),C},[f,x]);let X=0;return x&&x.forEach(C=>{const U=e.find(z=>z.id===Number(C.material_id));if(U){const z=parseFloat(String(C.quantity||0)),V=I(U);X+=Math.ceil(V*z*100)/100}}),l.jsxs("form",{onSubmit:c(C=>n(C.components,g)),className:"pb-2",children:[l.jsxs("div",{className:"mb-6 bg-amber-50 border border-amber-200 rounded-lg p-3 shadow-sm sticky top-0 z-20 flex flex-col lg:flex-row gap-4 lg:items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2 font-bold uppercase text-xs text-amber-900",children:[l.jsx(bd,{size:16})," Monitor"]}),l.jsxs("div",{className:"flex gap-4 border-l border-amber-200 pl-4 text-xs",children:[l.jsxs("div",{children:["Tableros: ",l.jsx("b",{children:v.boardsTotal.toFixed(2)})]}),l.jsxs("div",{children:["Hojas: ",l.jsx("b",{className:"text-emerald-700",children:v.producTotal})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2 bg-white/50 p-1.5 rounded border border-amber-100",children:[g===vr.READY?l.jsx(qE,{size:14,className:"text-emerald-600"}):l.jsx(aa,{size:14,className:"text-amber-600"}),l.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Estatus:"}),l.jsxs("select",{className:`text-xs font-bold border-none outline-none cursor-pointer rounded px-2 py-1 ${g===vr.READY?"text-emerald-700 bg-emerald-100":"text-amber-700 bg-amber-100"}`,value:g,onChange:C=>y(C.target.value),children:[l.jsx("option",{value:vr.DRAFT,children:" BORRADOR (Editable)"}),l.jsx("option",{value:vr.READY,children:" LISTO (Bloqueado)"}),l.jsx("option",{value:vr.OBSOLETE,children:" OBSOLETO"})]})]})]}),N&&l.jsxs("div",{className:"mb-4 bg-slate-100 border border-slate-300 text-slate-600 px-4 py-2 rounded text-xs flex items-center gap-2",children:[l.jsx(aa,{size:14})," ",l.jsxs("span",{children:["Receta en modo ",l.jsx("b",{children:"Solo Lectura"}),". Cambia a Borrador para editar."]})]}),!S&&l.jsxs("div",{className:"mb-4 bg-blue-50 border border-blue-200 text-blue-700 px-4 py-2 rounded text-xs flex items-center gap-2",children:[l.jsx(W1,{size:14})," ",l.jsx("span",{children:"Modo Operativo: Informacin financiera oculta por seguridad."})]}),Object.entries(L).map(([C,U])=>l.jsxs("div",{className:`mb-6 border rounded-lg overflow-hidden shadow-sm ${N?"opacity-70":"border-slate-200"}`,children:[l.jsx("div",{className:"bg-slate-50 px-4 py-2 border-b border-slate-200 flex justify-between",children:l.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-700 uppercase tracking-widest",children:[C==="Gabinetes"?l.jsx(_c,{size:14}):l.jsx(Cs,{size:14})," ",C]})}),l.jsxs("div",{className:"divide-y divide-slate-100 bg-white",children:[l.jsxs("div",{className:"grid grid-cols-12 gap-2 px-3 py-2 bg-slate-50/50 text-[10px] uppercase font-bold text-slate-400",children:[l.jsx("div",{className:"col-span-2",children:"SKU"}),l.jsx("div",{className:S?"col-span-6":"col-span-8",children:"Descripcin / Artculo"}),l.jsx("div",{className:"col-span-1 text-center",children:"Cant."}),l.jsx("div",{className:"col-span-1 text-center",children:"Unidad"}),S&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"col-span-1 text-right",children:"Costo"}),l.jsx("div",{className:"col-span-1 text-right",children:"Importe"})]})]}),U.map(z=>{const V=z.originalIndex,G=x==null?void 0:x[V],J=e.find(fe=>fe.id===Number(G==null?void 0:G.material_id)),q=I(J),se=parseFloat(String((G==null?void 0:G.quantity)||0)),ue=Math.ceil(q*se*100)/100;return l.jsxs("div",{className:"grid grid-cols-12 gap-2 px-3 py-1 items-center hover:bg-slate-50",children:[l.jsx("div",{className:"col-span-2 text-xs font-mono text-slate-500 truncate",children:(J==null?void 0:J.sku)||"---"}),l.jsx("div",{className:S?"col-span-6":"col-span-8",children:l.jsxs("select",{...o(`components.${V}.material_id`),disabled:N,className:"w-full text-xs bg-transparent border-none truncate disabled:cursor-not-allowed",children:[l.jsx("option",{value:0,children:"Seleccionar..."}),e.map(fe=>l.jsx("option",{value:fe.id,children:fe.name},fe.id))]})}),l.jsx("div",{className:"col-span-1",children:l.jsx("input",{type:"number",step:"0.01",disabled:N,...o(`components.${V}.quantity`),onChange:fe=>M(V,fe.target.value),className:"w-full text-center text-xs border rounded h-6 disabled:bg-slate-100"})}),l.jsx("div",{className:"col-span-1 text-center text-[10px] text-slate-400",children:(J==null?void 0:J.usage_unit)||"-"}),S&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"col-span-1 text-right text-[10px] text-slate-500 font-mono",children:J?`$${q.toFixed(2)}`:"-"}),l.jsx("div",{className:"col-span-1 text-right text-xs font-bold font-mono",children:ue>0?`$${ue.toFixed(2)}`:"-"})]})]},z.id)})]}),l.jsx("div",{className:"bg-slate-50 p-2 text-center",children:l.jsxs("button",{type:"button",onClick:()=>!N&&p({material_id:0,quantity:0,temp_category:C}),disabled:N,className:"text-xs text-indigo-600 font-medium px-4 py-1 border border-dashed border-indigo-300 rounded hover:bg-indigo-50 disabled:opacity-50",children:[l.jsx(xr,{size:12,className:"inline mr-1"})," Agregar"]})})]},C)),l.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-3 shadow-lg z-30 md:pl-64 flex justify-between items-center px-4",children:l.jsxs("div",{className:"text-right flex items-center gap-4 ml-auto",children:[S&&l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold",children:"Costo Total"}),l.jsxs("div",{className:"text-2xl font-black text-emerald-600",children:["$",X.toLocaleString("es-MX",{minimumFractionDigits:2})]})]}),l.jsxs("button",{type:"submit",disabled:s,className:"bg-emerald-600 hover:bg-emerald-700 text-white py-2 px-6 rounded-lg font-bold shadow-md flex items-center gap-2 disabled:bg-slate-400",children:[s?"Guardando...":"Guardar Receta"," ",l.jsx(ou,{size:18})]})]})}),l.jsx("div",{className:"h-20"})]})},ym=[{sku:"MDFBCO152C",default_qty:0,section:"Gabinetes"},{sku:"MDFNEG152C",default_qty:0,section:"Gabinetes"},{sku:"CHPCTA1BCO",default_qty:0,section:"Gabinetes"},{sku:"CHPCTA1COL",default_qty:0,section:"Gabinetes"},{sku:"0601-368",default_qty:0,section:"Gabinetes"},{sku:"0303-086",default_qty:0,section:"Gabinetes"},{sku:"0402-540",default_qty:0,section:"Gabinetes"},{sku:"0502-019",default_qty:0,section:"Gabinetes"},{sku:"0508-084",default_qty:0,section:"Gabinetes"},{sku:"0502-002",default_qty:0,section:"Gabinetes"},{sku:"0501-057",default_qty:0,section:"Gabinetes"},{sku:"0502-004",default_qty:0,section:"Gabinetes"},{sku:"0506-018",default_qty:0,section:"Gabinetes"},{sku:"0507-185",default_qty:0,section:"Gabinetes"},{sku:"0507-169",default_qty:0,section:"Gabinetes"},{sku:"0204-022",default_qty:0,section:"Gabinetes"},{sku:"0508-051",default_qty:0,section:"Gabinetes"},{sku:"1205-055",default_qty:0,section:"Gabinetes"},{sku:"1208-003",default_qty:0,section:"Gabinetes"},{sku:"1208-005",default_qty:0,section:"Gabinetes"},{sku:"1208-007",default_qty:0,section:"Gabinetes"},{sku:"1208-011",default_qty:0,section:"Gabinetes"},{sku:"1208-012",default_qty:0,section:"Gabinetes"},{sku:"PRODUC",default_qty:0,section:"Gabinetes"},{sku:"INSTALACOCINA",default_qty:0,section:"Gabinetes"},{sku:"GRASNGAB",default_qty:0,section:"Piedra"},{sku:"MAQGRANITO",default_qty:0,section:"Piedra"},{sku:"INSTALAGRANITO",default_qty:0,section:"Piedra"},{sku:"Viticos",default_qty:0,section:"Otros"}];function a5(){var S;const{id:e}=M1(),t=On(),[r,n]=b.useState(null),[s,a]=b.useState([]),[i,o]=b.useState([]),[c,u]=b.useState(0),[d,h]=b.useState([]),[f,p]=b.useState(""),[m,x]=b.useState(!0),[g,y]=b.useState(!1);b.useEffect(()=>{(async()=>{var N;try{if(x(!0),!e)return;const[I,M,L,X]=await Promise.all([dr.getVersion(Number(e)),Oe.get(it.FOUNDATIONS.MATERIALS),Oe.get(it.FOUNDATIONS.GLOBAL_CONFIG),Oe.get(it.FOUNDATIONS.CLIENTS)]),C=M.data,U=Array.isArray(L.data)?L.data[0]:L.data;if(n(I),a(C),o(X.data),u((U==null?void 0:U.default_edgebanding_factor)||0),p(((N=I.master)==null?void 0:N.name)||""),!I.components||I.components.length===0){const z=ym.map(V=>{const G=C.find(J=>J.sku.trim().toUpperCase()===V.sku.trim().toUpperCase());return G?{material_id:G.id,quantity:V.default_qty,temp_category:V.section,temp_material_sku:G.sku,temp_material_name:G.name}:null}).filter(V=>V!==null);h(z)}else{const z=I.components.map(V=>{const G=C.find(q=>q.id===V.material_id),J=ym.find(q=>q.sku.toUpperCase()===(G==null?void 0:G.sku.toUpperCase()));return{...V,temp_category:J?J.section:"Agregados Manualmente",temp_material_sku:(G==null?void 0:G.sku)||"",temp_material_name:(G==null?void 0:G.name)||""}});h(z)}}catch(I){console.error("Error cargando datos:",I)}finally{x(!1)}})()},[e]);const v=async(P,N)=>{var I;if(!(!(r!=null&&r.id)||!((I=r.master)!=null&&I.id)))try{y(!0);const M=P.filter(L=>L.quantity>0);await dr.updateVersion(r.id,{...r,status:vr.DRAFT,components:M}),N!==vr.DRAFT&&(await new Promise(L=>setTimeout(L,200)),await dr.updateVersion(r.id,{master_id:r.master.id,version_name:r.version_name,status:N,components:M})),alert(" Guardado correctamente."),window.location.reload()}catch(M){console.error("Error al guardar:",M),alert("Error al guardar.")}finally{y(!1)}};if(m)return l.jsx("div",{className:"p-10 flex justify-center",children:l.jsx(Qf,{className:"animate-spin text-indigo-600"})});if(!r)return l.jsx("div",{className:"p-10 text-red-500",children:"Versin no encontrada"});const w=i.find(P=>{var N;return P.id===((N=r.master)==null?void 0:N.client_id)}),_=(w==null?void 0:w.full_name)||(w==null?void 0:w.name)||"Producto Interno";return l.jsxs("div",{className:"flex flex-col h-screen bg-slate-50 overflow-hidden",children:[l.jsx("div",{className:"bg-white border-b border-slate-200 px-5 py-3 flex justify-between items-start shadow-sm shrink-0 z-40",children:l.jsxs("div",{className:"flex items-start gap-4 w-full",children:[l.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>t(-1),className:"mt-1 text-slate-400 hover:text-slate-700",children:l.jsx($1,{className:"h-5 w-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-3 group flex-wrap",children:[l.jsx("h1",{className:"text-xl font-black text-slate-800 tracking-tight leading-none truncate max-w-md",title:f,children:f||"Sin Nombre"}),l.jsx("span",{className:"text-slate-300 text-xl font-light",children:"/"}),l.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500 bg-slate-100 px-2 py-0.5 rounded-md",children:[l.jsx(ks,{size:14,className:"text-indigo-500"}),l.jsx("span",{className:"text-sm font-bold tracking-wide uppercase",children:_})]})]}),l.jsx("p",{className:"text-xs text-slate-400 font-medium mt-1",children:((S=r.master)==null?void 0:S.category)||"General"})]})]})}),l.jsx("div",{className:"flex-1 overflow-auto p-4 md:p-6 bg-slate-50/50",children:l.jsx("div",{className:"max-w-6xl mx-auto bg-white rounded-xl shadow-sm border border-slate-200 p-0 overflow-hidden",children:l.jsx(s5,{materials:s,edgebandingFactor:c,defaultValues:d,initialStatus:r.status,onSave:v,isLoading:g})})})]})}const i5=({orderId:e,onClose:t})=>{var g;const[r,n]=b.useState(null),[s,a]=b.useState(!1),[i,o]=b.useState(""),[c,u]=b.useState(""),[d,h]=b.useState(!1),[f,p]=b.useState(!1);b.useEffect(()=>{e&&(a(!0),wt.getOrderDetail(e).then(y=>{n(y),o(y.notes||""),u(y.conditions||"")}).catch(console.error).finally(()=>a(!1)))},[e]);const m=async()=>{if(e){h(!0);try{await wt.updateOrder(e,{notes:i,conditions:c})}catch(y){console.error(y),alert("Error al guardar.")}finally{h(!1)}}},x=async()=>{if(!(!e||!r)){p(!0);try{await wt.updateOrder(e,{notes:i,conditions:c});const y=`Cotizacion_${r.project_name.replace(/\s+/g,"_")}.pdf`;await wt.downloadPDF(e,y)}catch(y){console.error(y),alert("Error al generar el PDF.")}finally{p(!1)}}};return e?l.jsx(yy,{isOpen:!!e,onClose:t,title:"Editor de Cotizacin",size:"custom",className:"w-[95vw] max-w-[1800px] h-[90vh]",children:s||!r?l.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-20 text-slate-400",children:[l.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mb-4"}),"Cargando..."]}):l.jsxs("div",{className:"flex flex-col h-full gap-6",children:[l.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 grid grid-cols-1 md:grid-cols-3 gap-6 shadow-sm shrink-0",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1 flex items-center gap-1",children:[l.jsx(K1,{size:12})," Referencia"]}),l.jsx("div",{className:"text-xl font-black text-slate-800 truncate",children:r.project_name}),l.jsxs("div",{className:"text-sm text-slate-500 font-mono",children:["Folio: #",r.id]})]}),l.jsxs("div",{className:"border-l border-slate-200 pl-6",children:[l.jsxs("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1 flex items-center gap-1",children:[l.jsx(ks,{size:12})," Cliente"]}),l.jsx("div",{className:"text-base font-bold text-slate-700",children:r.client_id?`Cliente ID: ${r.client_id}`:"General"}),l.jsxs("div",{className:"text-sm text-slate-500",children:[l.jsx(kn,{size:12,className:"inline mr-1"}),"Vence: ",new Date(r.valid_until).toLocaleDateString()]})]}),l.jsxs("div",{className:"border-l border-slate-200 pl-6 text-right",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Total"}),l.jsxs("div",{className:"text-3xl font-black text-emerald-600",children:["$",r.total_price.toLocaleString("es-MX",{minimumFractionDigits:2})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 flex-1 min-h-0",children:[l.jsxs("div",{className:"flex flex-col h-full min-h-0 lg:col-span-1",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-2 flex items-center gap-2 shrink-0",children:[l.jsx(au,{size:16,className:"text-indigo-600"})," Productos"]}),l.jsx("div",{className:"border border-slate-200 rounded-lg overflow-auto flex-1 bg-white shadow-sm",children:l.jsxs("table",{className:"w-full text-xs",children:[l.jsx("thead",{className:"bg-slate-100 text-slate-500 font-semibold sticky top-0 z-10",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-2 text-left",children:"Concepto"}),l.jsx("th",{className:"p-2 text-right",children:"Importe"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:(g=r.items)==null?void 0:g.map(y=>l.jsxs("tr",{className:"hover:bg-slate-50",children:[l.jsxs("td",{className:"p-2",children:[l.jsx("div",{className:"font-bold text-slate-700 truncate max-w-[150px]",children:y.product_name}),l.jsxs("div",{className:"text-[10px] text-slate-400",children:["Cant: ",y.quantity]})]}),l.jsxs("td",{className:"p-2 text-right font-mono text-slate-800",children:["$",y.subtotal_price.toLocaleString()]})]},y.id))})]})})]}),l.jsxs("div",{className:"flex flex-col h-full min-h-0 lg:col-span-3 gap-4",children:[l.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[l.jsxs("div",{className:"flex justify-between items-center mb-1 shrink-0",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[l.jsx(As,{size:16,className:"text-indigo-600"}),"1. Saludo / Descripcin / Alcance"]}),l.jsx("span",{className:"text-[10px] text-slate-400 uppercase tracking-widest",children:"Aparece ANTES de los precios"})]}),l.jsx("textarea",{className:"w-full flex-1 p-4 text-sm text-slate-700 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white shadow-sm resize-none leading-relaxed font-sans",placeholder:"Ej. Por este medio te envo un cordial saludo... Cocinas fabricadas en panel MDF...",value:i,onChange:y=>o(y.target.value),onBlur:m})]}),l.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[l.jsxs("div",{className:"flex justify-between items-center mb-1 shrink-0",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[l.jsx(G1,{size:16,className:"text-emerald-600"}),"2. Condiciones Comerciales"]}),l.jsx("span",{className:"text-[10px] text-slate-400 uppercase tracking-widest",children:"Aparece DESPUS de los precios"})]}),l.jsx("textarea",{className:"w-full flex-1 p-4 text-sm text-slate-700 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 bg-emerald-50/30 shadow-sm resize-none leading-relaxed font-sans",placeholder:"Ej. Anticipo del 70%. Tiempo de entrega 60 das. Precios ms IVA...",value:c,onChange:y=>u(y.target.value),onBlur:m})]})]})]}),l.jsxs("div",{className:"border-t border-slate-200 pt-4 mt-auto flex justify-between items-center shrink-0",children:[l.jsx("div",{className:"text-xs text-slate-400 flex items-center gap-2",children:d?l.jsx("span",{className:"text-amber-600 font-bold animate-pulse",children:"Guardando cambios..."}):l.jsx("span",{className:"text-emerald-600 font-bold",children:" Cambios guardados"})}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(ot,{variant:"secondary",onClick:t,children:"Cerrar"}),l.jsx(ot,{onClick:x,disabled:f,className:"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-100",children:f?"Generando...":l.jsxs(l.Fragment,{children:[l.jsx(DE,{size:18,className:"mr-2"})," Descargar PDF Oficial"]})})]})]})]})}):null},l5=()=>{const e=On(),{orders:t,fetchOrders:r,loading:n}=sh(),{clients:s,fetchClients:a}=Nu(),[i,o]=b.useState(null),[c,u]=b.useState(null),[d,h]=b.useState("active"),[f,p]=b.useState(null),[m,x]=b.useState(new Date),[g,y]=b.useState(null),[v,w]=b.useState("");b.useEffect(()=>{r(),a();const z=localStorage.getItem("user_id"),V=localStorage.getItem("user_role");if(z){const J=parseInt(z.toString().trim(),10);isNaN(J)||y(J)}V&&w(V.toUpperCase().trim());const G=setInterval(()=>{r(void 0,void 0,!0),x(new Date)},5e3);return()=>clearInterval(G)},[r,a]);const _=b.useMemo(()=>{var z;if(!t||t.length===0)return[];if(v==="DIRECTOR"||v==="ADMIN")return t;if(v==="SALES"){const V=(z=localStorage.getItem("user_id"))==null?void 0:z.trim(),G=g?String(g):V;return G?t.filter(J=>J.user_id?String(J.user_id).trim()===String(G).trim():!1):[]}return[]},[t,v,g]);b.useEffect(()=>{if(n)return;const z=_.some(G=>G.status===Pe.SENT||G.status===Pe.ACCEPTED||G.status===Pe.CHANGE_REQUESTED),V=_.some(G=>G.status===Pe.DRAFT||G.status===Pe.REJECTED);!z&&V&&d==="active"&&!f&&h("drafts")},[_,n]);const S=b.useMemo(()=>{const z=new Date,V=z.getMonth(),G=z.getFullYear(),J=_.filter(W=>W.status===Pe.SOLD),q=_.filter(W=>W.status===Pe.SENT),se=J.filter(W=>{if(!W.created_at)return!1;const B=new Date(W.created_at);return B.getMonth()===V&&B.getFullYear()===G}),ue=se.reduce((W,B)=>W+(B.total_price||0),0),fe=se.reduce((W,B)=>{const D=(B.applied_commission_percent||0)/100;return W+(B.total_price||0)*D},0),R=q.reduce((W,B)=>W+(B.total_price||0),0);return{drafts:_.filter(W=>W.status===Pe.DRAFT||W.status===Pe.REJECTED).length,inReview:q.length,inReviewAmount:R,monthlyCount:se.length,monthlyRevenue:ue,monthlyCommissions:fe}},[_]),P=b.useMemo(()=>{if(!_)return[];let z=[];switch(d){case"active":z=_.filter(V=>V.status===Pe.SENT||V.status===Pe.ACCEPTED||V.status===Pe.CHANGE_REQUESTED);break;case"drafts":z=_.filter(V=>V.status===Pe.DRAFT||V.status===Pe.REJECTED);break;case"history":z=_.filter(V=>V.status===Pe.SOLD||V.status===Pe.CLIENT_REJECTED);break;default:z=[]}return f?z.filter(V=>V.status===f):z},[_,d,f]),N=z=>z.toLocaleString("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2,maximumFractionDigits:2}),I=z=>{h(z),p(null)},M=()=>{h("active"),p(Pe.SENT)},L=async(z,V)=>{if(!(V&&!window.confirm(V)))try{await z(),await r()}catch(G){alert("Ocurri un error al procesar la solicitud."),console.error(G)}},X=z=>{wt.downloadPDF(z)},C=z=>{const V=s.find(G=>G.id===z);return V?V.full_name:`Cliente ID: ${z}`},U=z=>{switch(z){case Pe.SENT:return l.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 border border-amber-200 rounded text-[10px] font-bold uppercase tracking-wide flex items-center gap-1 w-fit",children:[l.jsx(Xa,{size:10})," EN REVISIN"]});case Pe.CHANGE_REQUESTED:return l.jsxs("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 border border-orange-200 rounded text-[10px] font-bold uppercase tracking-wide flex items-center gap-1 w-fit",children:[l.jsx(Sc,{size:10})," EN AJUSTES"]});case Pe.ACCEPTED:return l.jsxs("span",{className:"inline-flex flex-col items-center justify-center px-3 py-1 bg-blue-100 text-blue-800 border border-blue-200 rounded text-[10px] font-bold uppercase text-center leading-tight shadow-sm",children:[l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(Xs,{size:10})," AUTORIZADA"]}),l.jsx("span",{className:"text-[9px] text-blue-600 opacity-80",children:"LISTA PARA CLIENTE"})]});case Pe.SOLD:return l.jsxs("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 border border-emerald-200 rounded text-[10px] font-bold uppercase tracking-wide flex items-center gap-1 w-fit",children:[l.jsx(fn,{size:10})," VENDIDA"]});case Pe.DRAFT:return l.jsx("span",{className:"px-2 py-1 bg-slate-100 text-slate-500 border border-slate-200 rounded text-[10px] font-bold uppercase tracking-wide border-dashed border-slate-300",children:"BORRADOR"});case Pe.CLIENT_REJECTED:return l.jsxs("span",{className:"px-2 py-1 bg-slate-100 text-slate-500 border border-slate-200 rounded text-[10px] font-bold uppercase tracking-wide flex items-center gap-1 w-fit",children:[l.jsx(XE,{size:10})," PERDIDA"]});case Pe.REJECTED:return l.jsxs("span",{className:"px-2 py-1 bg-red-50 text-red-600 border border-red-100 rounded text-[10px] font-bold uppercase tracking-wide flex items-center gap-1 w-fit",children:[l.jsx(Vn,{size:10})," CORREGIR"]});default:return l.jsx("span",{className:"bg-slate-100 text-slate-800 px-2 py-1 rounded text-xs",children:z})}};return l.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6 pb-24",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl font-black text-slate-800 flex items-center gap-2",children:[l.jsx(fn,{className:"text-emerald-600"})," Ventas y Cotizaciones"]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[l.jsxs("span",{className:"font-mono bg-slate-100 px-2 rounded border border-slate-200 text-xs",children:[" ID: ",g??"?"," | ROL: ",v]}),l.jsxs("span",{className:"flex items-center gap-1 text-[10px] bg-emerald-50 px-2 py-0.5 rounded-full border border-emerald-100 text-emerald-600 font-bold",children:[l.jsx(bd,{size:10,className:"animate-pulse"})," En vivo ",m.toLocaleTimeString()]})]})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Kl,{data:_,fileName:`Reporte_Ventas_${v}`,label:"Excel",mapping:z=>z}),l.jsxs(ot,{onClick:()=>e("/sales/new"),className:"bg-emerald-600 hover:bg-emerald-700 shadow-md shadow-emerald-200",children:[l.jsx(xr,{size:18,className:"mr-2"})," Nueva Cotizacin"]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs(St,{className:`p-4 border-l-4 shadow-sm cursor-pointer transition-all ${d==="drafts"?"bg-slate-50 ring-2 ring-slate-200":"bg-white"} border-l-slate-400`,onClick:()=>I("drafts"),children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase font-bold",children:"Borradores"}),l.jsx("div",{className:"text-2xl font-black text-slate-700",children:S.drafts}),l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"Clic para ver"})]}),l.jsxs(St,{className:`p-4 border-l-4 shadow-sm cursor-pointer transition-all ${f===Pe.SENT?"bg-amber-50 ring-2 ring-amber-200":"bg-white"} border-l-amber-500`,onClick:M,children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase font-bold",children:"Por Autorizar"}),f===Pe.SENT&&l.jsx(bd,{size:14,className:"text-amber-500 animate-pulse"})]}),l.jsxs("div",{className:"flex flex-row items-baseline mt-1",children:[S.inReview>0&&l.jsx("div",{className:"text-2xl font-black text-amber-600/60",children:S.inReview}),l.jsx("div",{className:"ml-auto text-2xl font-black text-orange-600",children:N(S.inReviewAmount)})]}),l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"Requieren firma Direccin"})]}),l.jsxs(St,{className:"p-4 bg-white border-l-4 border-l-emerald-500 shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase font-bold",children:"Ventas Mes"}),l.jsx(fn,{size:14,className:"text-emerald-500"})]}),l.jsxs("div",{className:"flex flex-row items-baseline mt-1",children:[S.monthlyCount>0&&l.jsx("div",{className:"text-2xl font-black text-emerald-600/50",children:S.monthlyCount}),l.jsx("div",{className:"ml-auto text-2xl font-black text-emerald-600",children:N(S.monthlyRevenue)})]}),l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"Cerradas este mes"})]}),l.jsxs(St,{className:"p-4 bg-white border-l-4 border-l-indigo-500 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"text-xs text-slate-500 uppercase font-bold",children:"Comisiones Mes"}),l.jsx(rv,{size:14,className:"text-indigo-400"})]}),l.jsxs("div",{className:"flex flex-row items-baseline mt-1",children:[S.monthlyCount>0&&l.jsx("div",{className:"text-2xl font-black text-indigo-600/50",children:S.monthlyCount}),l.jsx("div",{className:"ml-auto text-2xl font-black text-indigo-600",children:N(S.monthlyCommissions)})]}),l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"Ganancia estimada"})]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg border border-slate-200 w-fit",children:[l.jsxs("button",{onClick:()=>I("active"),className:`px-4 py-1.5 text-xs font-bold rounded-md flex items-center gap-2 transition-all ${d==="active"&&!f?"bg-white text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(Kf,{size:14})," En Proceso (Todas)"]}),l.jsxs("button",{onClick:()=>I("drafts"),className:`px-4 py-1.5 text-xs font-bold rounded-md flex items-center gap-2 transition-all ${d==="drafts"?"bg-white text-slate-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(TE,{size:14})," Borradores ",S.drafts>0&&l.jsx("span",{className:"ml-1 bg-slate-600 text-white text-[9px] px-1.5 rounded-full",children:S.drafts})]}),l.jsxs("button",{onClick:()=>I("history"),className:`px-4 py-1.5 text-xs font-bold rounded-md flex items-center gap-2 transition-all ${d==="history"?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(PE,{size:14})," Histrico Cerrado"]})]}),f===Pe.SENT&&l.jsxs("div",{className:"flex items-center gap-2 bg-amber-50 text-amber-800 text-xs px-3 py-1.5 rounded-full border border-amber-200 animate-fadeIn",children:[l.jsx(IE,{size:12}),l.jsxs("span",{className:"font-bold",children:["Filtrando: Por Autorizar (",P.length,")"]}),l.jsx("button",{onClick:()=>I("active"),className:"underline ml-1 hover:text-amber-900",children:"Ver todas"})]})]}),l.jsx(St,{className:"overflow-hidden bg-white border border-slate-200 shadow-sm min-h-[400px]",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold text-xs uppercase border-b border-slate-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3",children:"Folio / Proyecto"}),l.jsx("th",{className:"px-6 py-3",children:"Cliente"}),l.jsx("th",{className:"px-6 py-3 text-center",children:"Estatus"}),l.jsx("th",{className:"px-6 py-3 text-right",children:"Total"}),l.jsx("th",{className:"px-6 py-3 text-center",children:"Acciones"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:P.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"p-12 text-center text-slate-400 italic",children:f===Pe.SENT?"Excelente! No hay cotizaciones pendientes de autorizacin.":d==="drafts"?"No tienes borradores pendientes.":"No hay cotizaciones en esta vista."})}):P.map(z=>{var V;return l.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[l.jsxs("td",{className:"px-6 py-4",children:[l.jsx("div",{className:"font-bold text-slate-800",children:z.project_name}),l.jsxs("div",{className:"text-xs text-slate-400 font-mono",children:["ID: #",z.id]})]}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-400",children:l.jsx(ks,{size:16})}),l.jsxs("div",{children:[l.jsx("div",{className:"font-bold text-slate-700 text-sm",children:C(z.client_id)}),l.jsx("div",{className:"text-[10px] text-slate-400",children:new Date(z.created_at||Date.now()).toLocaleDateString("es-MX")})]})]})}),l.jsx("td",{className:"px-6 py-4 text-center",children:U(z.status)}),l.jsxs("td",{className:"px-6 py-4 text-right font-mono font-bold text-slate-700",children:["$",(V=z.total_price)==null?void 0:V.toLocaleString("es-MX",{minimumFractionDigits:2})]}),l.jsx("td",{className:"px-6 py-4 text-center",children:l.jsxs("div",{className:"flex justify-center items-center gap-2",children:[(z.status===Pe.DRAFT||z.status===Pe.CHANGE_REQUESTED||z.status===Pe.REJECTED)&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>L(()=>wt.requestAuth(z.id),"Enviar a revisin?"),disabled:c===z.id,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Enviar a Revisin",children:l.jsx(GE,{size:18})}),l.jsx("button",{onClick:()=>e(`/sales/edit/${z.id}`),className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg",title:"Editar",children:l.jsx(js,{size:18})}),l.jsx("button",{onClick:()=>L(()=>wt.deleteOrder(z.id),"Eliminar?"),className:"p-2 text-slate-400 hover:bg-rose-50 hover:text-rose-500 rounded-lg",title:"Eliminar",children:l.jsx(Rn,{size:18})})]}),z.status===Pe.SENT&&l.jsxs("div",{className:"flex gap-2 bg-amber-50 p-1 rounded-lg border border-amber-100",children:[l.jsx("button",{onClick:()=>o(z.id),className:"p-2 text-slate-600 hover:bg-white rounded shadow-sm",title:"Ver Detalles",children:l.jsx(Zp,{size:18})}),(v==="DIRECTOR"||v==="ADMIN")&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-px bg-amber-200 mx-1"}),l.jsx("button",{onClick:()=>L(()=>wt.authorizeOrder(z.id),"Autorizar esta cotizacin?"),className:"p-2 text-emerald-600 hover:bg-emerald-100 hover:text-emerald-700 rounded transition-colors",title:"Autorizar",children:l.jsx(Ad,{size:18,strokeWidth:3})}),l.jsx("button",{onClick:()=>L(()=>wt.requestChanges(z.id),"Devolver a Ventas para ajustes?"),className:"p-2 text-orange-500 hover:bg-orange-100 hover:text-orange-700 rounded transition-colors",title:"Solicitar Cambios",children:l.jsx(Sc,{size:18})}),l.jsx("button",{onClick:()=>L(()=>wt.rejectOrder(z.id),"Rechazar definitivamente?"),className:"p-2 text-slate-400 hover:bg-red-100 hover:text-red-600 rounded transition-colors",title:"Rechazar",children:l.jsx(Zf,{size:18})})]})]}),z.status===Pe.ACCEPTED&&l.jsxs("div",{className:"flex gap-1 p-1 bg-green-50 border border-green-100 rounded-lg shadow-sm",children:[l.jsx("button",{onClick:()=>X(z.id),className:"p-2 text-slate-600 hover:bg-blue-100 hover:text-blue-700 rounded",title:"Descargar PDF",children:l.jsx(As,{size:18})}),l.jsx("button",{onClick:()=>L(()=>wt.markAsSold(z.id),"Confirmar que el cliente acept? Se generar la Orden de Venta."),className:"p-2 text-emerald-600 hover:bg-emerald-100 hover:text-emerald-700 rounded shadow-sm",title:"Cliente Acept (Vender)",children:l.jsx(fn,{size:18})}),l.jsx("div",{className:"w-px bg-slate-300 mx-1"}),l.jsx("button",{onClick:()=>e(`/sales/edit/${z.id}`),className:"p-2 text-amber-600 hover:bg-amber-100 rounded",title:"Modificar (Re-enviar a Direccin)",children:l.jsx(js,{size:18})}),l.jsx("button",{onClick:()=>L(()=>wt.deleteOrder(z.id),"Seguro que deseas eliminar esta cotizacin autorizada?"),className:"p-2 text-slate-400 hover:bg-red-100 hover:text-red-600 rounded",title:"Eliminar",children:l.jsx(Rn,{size:18})})]}),(z.status===Pe.SOLD||z.status===Pe.CLIENT_REJECTED)&&l.jsx("button",{onClick:()=>o(z.id),className:"p-2 text-gray-400 hover:bg-gray-100 rounded-lg",children:l.jsx(Zp,{size:18})})]})})]},z.id)})})]})})}),l.jsx(i5,{orderId:i,onClose:()=>o(null)})]})},o5="http://127.0.0.1:8000/api/v1",ss=e=>e==null||isNaN(e)?"$ 0.00":new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(e),c5=e=>{if(!e)return new Date().toISOString().split("T")[0];try{return new Date(e).toISOString().split("T")[0]}catch{return new Date().toISOString().split("T")[0]}},wm=()=>{const e=On(),{id:t}=M1(),r=!!t,n=sh(),s=n==null?void 0:n.loading,a=Nu(),i=pu(),o=a!=null&&a.clients&&Array.isArray(a.clients)?a.clients:[],c=i!=null&&i.taxRates&&Array.isArray(i.taxRates)?i.taxRates:[],u=(i==null?void 0:i.config)||null,[d,h]=b.useState([]),[f,p]=b.useState(!1),[m,x]=b.useState(!1),[g,y]=b.useState(""),[v,w]=b.useState(null),[_,S]=b.useState(0),[P,N]=b.useState(!1),[I,M]=b.useState({client_id:0,project_name:"",tax_rate_id:0,valid_until:new Date(Date.now()+15*24*60*60*1e3).toISOString().split("T")[0],applied_margin_percent:0,notes:"",conditions:""}),[L,X]=b.useState([]),[C,U]=b.useState({master_id:0,version_id:0,quantity:1,unit_price:0,manual_name:"",frozen_cost:0}),[z,V]=b.useState(!1),[G,J]=b.useState("CATALOG"),[q,se]=b.useState(null),ue=async()=>{N(!0);const ce=localStorage.getItem("token");if(!ce){console.error("Token de autenticacin no encontrado."),N(!1);return}try{const be=`${o5}/api/v1/users/me`;let A=(await Nt.get(be,{headers:{Authorization:`Bearer ${ce}`}})).data.commission_rate;A==null&&(A=0),A>1&&(A=A/100),S(A)}catch(be){console.error("Error obteniendo datos del usuario:",be)}finally{N(!1)}};b.useEffect(()=>{(async()=>{try{a!=null&&a.fetchClients&&await a.fetchClients(),i!=null&&i.fetchTaxRates&&await i.fetchTaxRates(),i!=null&&i.fetchConfig&&await i.fetchConfig();const be=await dr.getMasters(void 0,!0);h(be),r||await ue()}catch(be){console.error("Error inicializando pgina",be)}})()},[r]),b.useEffect(()=>{r&&t&&(async()=>{p(!0);try{const be=await wt.getOrderDetail(Number(t));if(be&&(M({client_id:be.client_id||0,project_name:be.project_name||"",tax_rate_id:be.tax_rate_id||0,valid_until:c5(be.valid_until),applied_margin_percent:be.applied_margin_percent||0,notes:be.notes||"",conditions:be.conditions||""}),X(Array.isArray(be.items)?be.items:[]),w(be.status),be.applied_commission_percent!==void 0)){let oe=be.applied_commission_percent;oe>1&&(oe=oe/100),S(oe)}}catch(be){console.error("Error cargando orden:",be),alert("No se pudo cargar la cotizacin."),e("/sales")}finally{p(!1)}})()},[t,r,e]),b.useEffect(()=>{if(!r&&u&&I.applied_margin_percent===0){const ce=Number(u.target_profit_margin)||0;M(be=>({...be,applied_margin_percent:ce}))}},[u,r]);const fe=b.useMemo(()=>I.client_id?d.filter(ce=>ce.client_id===Number(I.client_id)):[],[d,I.client_id]),R=b.useMemo(()=>{const ce=fe.map(be=>be.category);return Array.from(new Set(ce))},[fe]),W=b.useMemo(()=>g?fe.filter(ce=>ce.category===g):[],[fe,g]),B=W.find(ce=>ce.id===Number(C.master_id)),D=B&&Array.isArray(B.versions)?B.versions:[],te=b.useMemo(()=>L.reduce((ce,be)=>ce+be.quantity*be.unit_price,0),[L]),we=te*_,Ee=te+we,xe=c.find(ce=>ce.id===I.tax_rate_id),pe=xe?Ee*xe.rate:0,Le=Ee+pe;b.useEffect(()=>{let ce=!0;return(async()=>{if(G==="CATALOG"&&C.version_id){V(!0);try{const oe=await dr.getVersion(Number(C.version_id));if(!ce)return;const A=Number(oe.estimated_cost)||0,H=Number(I.applied_margin_percent)||0;let Z=1;H>0&&H<=1?Z=1+H:Z=1+H/100;const de=A*Z;U(ve=>({...ve,unit_price:parseFloat(de.toFixed(2)),frozen_cost:A}))}catch(oe){console.error(oe)}finally{ce&&V(!1)}}})(),()=>{ce=!1}},[C.version_id,I.applied_margin_percent,G]);const ie=ce=>{M({...I,client_id:Number(ce.target.value)}),y(""),U({...C,master_id:0,version_id:0,unit_price:0,frozen_cost:0}),se(null)},je=ce=>{var A;const be=L[ce];se(ce);const oe={master_id:0,version_id:0,quantity:be.quantity,unit_price:be.unit_price,manual_name:be.product_name,frozen_cost:be.frozen_unit_cost||0};if(be.origin_version_id){J("CATALOG");let H=!1;for(const Z of d){const de=(A=Z.versions)==null?void 0:A.find(ve=>ve.id===be.origin_version_id);if(de){y(Z.category),oe.master_id=Z.id,oe.version_id=de.id,H=!0;break}}H||J("MANUAL")}else J("MANUAL");U(oe)},ke=()=>{se(null),U({...C,master_id:0,version_id:0,quantity:1,unit_price:0,manual_name:""}),J("CATALOG")},Xe=()=>{if(C.quantity<=0||C.unit_price<=0){alert("Precio/Cantidad invlidos");return}let ce=C.manual_name;if(G==="CATALOG"){const A=D.find(H=>H.id===Number(C.version_id));if(!A){alert("Error versin");return}ce=`${B==null?void 0:B.name} - ${A.version_name}`}const be={id:q!==null?L[q].id:-Date.now(),product_name:ce,origin_version_id:G==="CATALOG"?Number(C.version_id):null,quantity:Number(C.quantity),unit_price:Number(C.unit_price),frozen_unit_cost:G==="CATALOG"?C.frozen_cost:q!==null?L[q].frozen_unit_cost:0},oe=[...L];q!==null?(oe[q]=be,se(null)):oe.push(be),X(oe),U(A=>({...A,quantity:1,manual_name:"",master_id:0,version_id:0,unit_price:0}))},$e=ce=>{X(L.filter(be=>be.id!==ce)),q!==null&&ke()},Te=async()=>{var ce,be;if(!I.client_id||!I.project_name||!I.tax_rate_id||L.length===0){alert("Faltan datos obligatorios");return}x(!0);try{const oe=L.map(H=>({product_name:H.product_name,origin_version_id:H.origin_version_id||null,quantity:Number(H.quantity),unit_price:Number(H.unit_price),frozen_unit_cost:Number(H.frozen_unit_cost||0),cost_snapshot:H.cost_snapshot||{}})),A={client_id:Number(I.client_id),project_name:I.project_name,tax_rate_id:Number(I.tax_rate_id),valid_until:new Date(I.valid_until).toISOString(),applied_margin_percent:Number(I.applied_margin_percent),applied_tolerance_percent:3,currency:"MXN",is_warranty:!1,notes:I.notes,conditions:I.conditions,items:oe};r&&t?(await wt.updateOrder(Number(t),A),alert(" Cotizacin Actualizada.")):(await wt.createOrder(A),alert(" Cotizacin Creada Exitosamente.")),e("/sales")}catch(oe){alert("Error al guardar: "+(((be=(ce=oe.response)==null?void 0:ce.data)==null?void 0:be.detail)||oe.message))}finally{x(!1)}};return f?l.jsxs("div",{className:"text-center p-10",children:[l.jsx(Qf,{className:"animate-spin mx-auto"})," Cargando..."]}):l.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6 pb-20 bg-slate-50 min-h-full",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("h1",{className:"text-2xl font-black text-slate-800 flex items-center gap-2",children:[r?l.jsx(lu,{className:"text-indigo-600"}):l.jsx(xr,{className:"text-emerald-600"}),r?`Editando Cotizacin #${t}`:"Nueva Cotizacin"]}),l.jsxs(ot,{variant:"secondary",onClick:()=>e("/sales"),children:[l.jsx($1,{size:18,className:"mr-2"})," Regresar"]})]}),r&&(v===Pe.ACCEPTED||v===Pe.SENT)&&l.jsxs("div",{className:"bg-amber-100 border-l-4 border-amber-500 text-amber-700 p-4 rounded shadow-sm flex items-center gap-3 animate-pulse-slow",children:[l.jsx(Vn,{className:"shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold",children:"Modo de Edicin Restrictiva"}),l.jsx("p",{className:"text-sm",children:'Esta cotizacin ya fue enviada o aceptada. Si guardas cambios, perder su autorizacin y volver a estatus "EN AJUSTES".'})]})]}),l.jsx(St,{className:"p-6 bg-white shadow-sm border-slate-200",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"md:col-span-2 grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"CLIENTE *"}),l.jsxs("select",{className:"w-full p-2 border border-slate-300 rounded bg-slate-50",value:I.client_id,onChange:ie,children:[l.jsx("option",{value:0,children:"-- Seleccionar --"}),o.map(ce=>l.jsx("option",{value:ce.id,children:ce.full_name},ce.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"PROYECTO *"}),l.jsx(fr,{value:I.project_name,onChange:ce=>M({...I,project_name:ce.target.value})})]})]}),l.jsxs("div",{className:"space-y-4 border-l pl-6 border-slate-100",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"IMPUESTO *"}),l.jsxs("select",{className:"w-full p-2 border border-slate-300 rounded text-sm",value:I.tax_rate_id,onChange:ce=>M({...I,tax_rate_id:Number(ce.target.value)}),children:[l.jsx("option",{value:0,children:"-- Seleccionar --"}),c.map(ce=>l.jsxs("option",{value:ce.id,children:[ce.name," (",ce.rate*100,"%)"]},ce.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"VIGENCIA"}),l.jsx(fr,{type:"date",value:I.valid_until,onChange:ce=>M({...I,valid_until:ce.target.value})})]})]})]})}),l.jsx(St,{className:"p-6 bg-white shadow-sm border-slate-200",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"NOTAS"}),l.jsx("textarea",{className:"w-full p-2 border rounded text-sm h-20",value:I.notes,onChange:ce=>M({...I,notes:ce.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"CONDICIONES"}),l.jsx("textarea",{className:"w-full p-2 border rounded text-sm h-20",value:I.conditions,onChange:ce=>M({...I,conditions:ce.target.value})})]})]})}),l.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[l.jsx("div",{className:`w-full lg:w-1/3 p-6 rounded-xl border ${q!==null?"bg-amber-50 border-amber-300":"bg-white border-slate-200"}`,children:l.jsxs("div",{className:"space-y-4",children:[G==="CATALOG"?l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500",children:"CATEGORA"}),l.jsxs("select",{className:"w-full p-2 border rounded text-sm",value:g,disabled:!I.client_id,onChange:ce=>{y(ce.target.value),U({...C,master_id:0,version_id:0})},children:[l.jsx("option",{value:"",children:"-- Seleccionar --"}),R.map(ce=>l.jsx("option",{value:ce,children:ce},ce))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500",children:"PRODUCTO"}),l.jsxs("select",{className:"w-full p-2 border rounded text-sm",value:C.master_id,disabled:!g,onChange:ce=>U({...C,master_id:Number(ce.target.value),version_id:0}),children:[l.jsx("option",{value:0,children:"-- Seleccionar --"}),W.map(ce=>l.jsx("option",{value:ce.id,children:ce.name},ce.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500",children:"VERSIN"}),l.jsxs("select",{className:"w-full p-2 border rounded text-sm",disabled:!C.master_id,value:C.version_id,onChange:ce=>U({...C,version_id:Number(ce.target.value)}),children:[l.jsx("option",{value:0,children:"-- Seleccionar --"}),D.map(ce=>l.jsx("option",{value:ce.id,children:ce.version_name},ce.id))]})]})]}):l.jsx(fr,{placeholder:"Producto manual...",value:C.manual_name,onChange:ce=>U({...C,manual_name:ce.target.value})}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsx(fr,{type:"number",placeholder:"Cant",value:C.quantity,onChange:ce=>U({...C,quantity:Number(ce.target.value)})}),l.jsx("div",{className:"relative",children:z?l.jsx("span",{className:"text-xs text-slate-400",children:"Cargando..."}):l.jsx(fr,{type:G==="CATALOG"?"text":"number",readOnly:G==="CATALOG",className:G==="CATALOG"?"bg-slate-100":"",value:G==="CATALOG"?ss(C.unit_price).replace("MX$",""):C.unit_price,onChange:ce=>G==="MANUAL"&&U({...C,unit_price:Number(ce.target.value)})})})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(ot,{className:"flex-1",onClick:Xe,children:q!==null?"Actualizar":"Agregar"}),q!==null&&l.jsx(ot,{variant:"secondary",onClick:ke,children:l.jsx(kr,{size:16})})]})]})}),l.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 shadow-sm flex flex-col",children:[l.jsx("div",{className:"flex-1 overflow-x-auto min-h-[300px] p-0",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"bg-slate-50 border-b text-xs text-slate-500 uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2",children:"Producto"}),l.jsx("th",{className:"text-center",children:"Cant."}),l.jsx("th",{className:"text-right",children:"Unitario"}),l.jsx("th",{className:"text-right px-4",children:"Total"}),l.jsx("th",{className:"text-center"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:L.map((ce,be)=>l.jsxs("tr",{className:q===be?"bg-amber-50":"",children:[l.jsx("td",{className:"px-4 py-2",children:ce.product_name}),l.jsx("td",{className:"text-center font-bold",children:ce.quantity}),l.jsx("td",{className:"text-right font-mono",children:ss(ce.unit_price)}),l.jsx("td",{className:"text-right px-4 font-bold font-mono",children:ss(ce.quantity*ce.unit_price)}),l.jsxs("td",{className:"text-center px-2",children:[l.jsx("button",{onClick:()=>je(be),className:"text-indigo-500 mr-2",children:l.jsx(js,{size:16})}),l.jsx("button",{onClick:()=>$e(ce.id),className:"text-red-500",children:l.jsx(Rn,{size:16})})]})]},be))})]})}),l.jsxs("div",{className:"p-6 bg-slate-50 border-t border-slate-200 text-right space-y-2",children:[l.jsxs("div",{className:"flex justify-end gap-12 text-sm text-slate-500",children:[l.jsx("span",{children:"Suma Partidas:"})," ",l.jsx("span",{className:"font-mono",children:ss(te)})]}),l.jsxs("div",{className:"flex justify-end gap-12 text-sm text-amber-600 font-bold border-b border-dashed border-slate-200 pb-2 mb-2",children:[l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(xr,{size:10})," Comisin (",(_*100).toFixed(1),"%):",_===0&&!r&&l.jsx("button",{onClick:ue,disabled:P,className:"ml-2 text-indigo-600 hover:text-indigo-800 p-1 rounded hover:bg-indigo-50",title:"Recargar",children:l.jsx(Sc,{size:12,className:P?"animate-spin":""})})]}),l.jsx("span",{className:"font-mono",children:ss(we)})]}),l.jsxs("div",{className:"flex justify-end gap-12 text-sm text-slate-700 font-bold",children:[l.jsx("span",{children:"Subtotal:"})," ",l.jsx("span",{className:"font-mono",children:ss(Ee)})]}),l.jsxs("div",{className:"flex justify-end gap-12 text-sm text-slate-500",children:[l.jsx("span",{children:"IVA:"})," ",l.jsx("span",{className:"font-mono",children:ss(pe)})]}),l.jsxs("div",{className:"flex justify-end gap-12 text-xl font-black text-slate-800 border-t pt-2",children:[l.jsx("span",{children:"Total:"})," ",l.jsx("span",{className:"font-mono",children:ss(Le)})]}),l.jsx("div",{className:"flex justify-end gap-4 mt-4",children:l.jsxs(ot,{className:"w-64 bg-emerald-600 hover:bg-emerald-700",onClick:Te,disabled:m||s,children:[m?"Guardando...":r?"Actualizar":"Guardar"," ",l.jsx(ou,{size:18,className:"ml-2"})]})})]})]})]})]})},u5={createReception:async e=>(await Oe.post("/inventory/reception",e)).data,getReceptions:async()=>(await Oe.get("/inventory/receptions")).data,getAccountsPayableSummary:async()=>(await Oe.get("/inventory/financial-summary")).data},d5=()=>{const e=On(),{providers:t,fetchProviders:r}=vy(),{materials:n,fetchMaterials:s}=Av(),[a,i]=b.useState({provider_id:0,invoice_number:"",invoice_date:new Date().toISOString().split("T")[0],due_date:"",total_amount:0,notes:""}),[o,c]=b.useState([]),[u,d]=b.useState(0),[h,f]=b.useState({material_id:0,quantity:1,unit_cost:0,line_total_cost:0,searchQuery:""}),[p,m]=b.useState(!1),[x,g]=b.useState(!1);b.useEffect(()=>{r(),s()},[]),b.useEffect(()=>{if(a.provider_id&&a.invoice_date){const C=t.find(U=>U.id===a.provider_id);if(C){const U=C.credit_days||0;d(U);const z=a.invoice_date.split("-"),V=new Date(Number(z[0]),Number(z[1])-1,Number(z[2]));V.setDate(V.getDate()+U);const G=V.toISOString().split("T")[0];i(J=>({...J,due_date:G}))}}},[a.provider_id,a.invoice_date,t]);const y=b.useMemo(()=>h.searchQuery?n.filter(C=>C.name.toLowerCase().includes(h.searchQuery.toLowerCase())||C.sku.toLowerCase().includes(h.searchQuery.toLowerCase())):Array.isArray(n)?n:[],[n,h.searchQuery]),v=b.useMemo(()=>o.reduce((C,U)=>C+Number(U.line_total_cost),0),[o]),w=a.total_amount-v,_=Math.abs(w)<.1,S=C=>{const U=Number(C);f({...h,quantity:U,line_total_cost:U*h.unit_cost})},P=C=>{const U=Number(C);f({...h,unit_cost:U,line_total_cost:U*h.quantity})},N=()=>{if(h.material_id===0||h.quantity<=0||h.unit_cost<=0){alert("Datos invlidos (Revise material, cantidad o costo unitario).");return}const C=n.find(z=>z.id===h.material_id),U={material_id:h.material_id,quantity:Number(h.quantity),line_total_cost:Number(h.line_total_cost),tempId:Date.now().toString(),material_name:(C==null?void 0:C.name)||"Desconocido",unit_cost_calculated:Number(h.unit_cost)};c([...o,U]),f({...h,material_id:0,quantity:1,unit_cost:0,line_total_cost:0,searchQuery:""})},I=C=>{const U=o.find(z=>z.tempId===C);U&&(f({material_id:U.material_id,quantity:U.quantity,unit_cost:U.unit_cost_calculated||0,line_total_cost:U.line_total_cost,searchQuery:U.material_name||""}),c(o.filter(z=>z.tempId!==C)))},M=C=>{window.confirm("Eliminar esta lnea?")&&c(o.filter(U=>U.tempId!==C))},L=()=>{if(v===0||a.total_amount===0)return;const C=a.total_amount/v,U=(1-C)*100;if(!window.confirm(` PRORRATEO DE DESCUENTO

Se detect una diferencia del ${U.toFixed(2)}%.

El sistema va a AJUSTAR proporcionalmente los costos.

Proceder?`))return;const z=o.map(V=>{const G=V.line_total_cost*C;return{...V,line_total_cost:G,unit_cost_calculated:G/V.quantity}});c(z)},X=async()=>{if(a.provider_id===0||!a.invoice_number||o.length===0){alert("Faltan datos obligatorios.");return}if(!_){const C=` DESCUADRE DETECTADO

Total Factura: $${a.total_amount}
Suma Materiales: $${v.toFixed(2)}

Deseas guardar as de todos modos?`;if(!window.confirm(C))return}m(!0);try{await u5.createReception({...a,total_amount:Number(a.total_amount),provider_id:Number(a.provider_id),due_date:a.due_date?a.due_date:void 0,items:o}),alert(" Recepcin Registrada Correctamente."),c([]),i({provider_id:0,invoice_number:"",invoice_date:new Date().toISOString().split("T")[0],due_date:"",total_amount:0,notes:""}),e("/materials")}catch(C){console.error(C),alert(" Error al guardar.")}finally{m(!1)}};return l.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6 pb-20 bg-slate-50 min-h-full",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl font-black text-slate-800 flex items-center gap-2",children:[l.jsx(Cs,{className:"text-indigo-600"})," Entrada de Almacn"]}),l.jsx("p",{className:"text-slate-500 text-sm",children:"Registro de Facturas de Proveedores"})]}),l.jsxs("div",{className:`px-4 py-2 rounded-lg font-bold border flex items-center gap-3 transition-colors ${_?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-amber-50 text-amber-700 border-amber-200"}`,children:[_?l.jsx(Cl,{size:24}):l.jsx(Vn,{size:24}),l.jsxs("div",{className:"text-right leading-tight",children:[l.jsx("div",{className:"text-[10px] uppercase opacity-70",children:"Diferencia"}),l.jsxs("div",{className:"text-lg",children:["$",w.toFixed(2)]})]})]})]}),l.jsxs(St,{className:"p-6 grid grid-cols-1 md:grid-cols-5 gap-6 bg-white shadow-sm border-slate-200",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Proveedor *"}),l.jsxs("select",{className:"w-full p-2.5 border border-slate-300 rounded-md bg-slate-50 focus:ring-2 focus:ring-indigo-500 outline-none",value:a.provider_id,onChange:C=>i({...a,provider_id:Number(C.target.value)}),children:[l.jsx("option",{value:0,children:"-- Seleccionar Proveedor --"}),(t==null?void 0:t.map(C=>l.jsxs("option",{value:C.id,children:[C.business_name," (",C.credit_days," das)"]},C.id)))||l.jsx("option",{disabled:!0,children:"Cargando..."})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Folio Factura *"}),l.jsx(fr,{placeholder:"Ej. A-4500",value:a.invoice_number,onChange:C=>i({...a,invoice_number:C.target.value})})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-bold text-slate-700 mb-1 flex items-center gap-1",children:[l.jsx(kn,{size:14})," Fecha Factura"]}),l.jsx(fr,{type:"date",value:a.invoice_date,onChange:C=>i({...a,invoice_date:C.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Total (Neto) *"}),l.jsxs("div",{className:"relative",children:[l.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-bold",children:"$"}),l.jsx(fr,{type:"number",className:"pl-8 font-bold text-indigo-700",placeholder:"0.00",value:a.total_amount||"",onChange:C=>i({...a,total_amount:Number(C.target.value)})})]})]}),l.jsxs("div",{className:"md:col-span-1 bg-slate-50 p-2 rounded border border-slate-200",children:[l.jsxs("label",{className:"block text-xs font-bold text-slate-500 mb-1 flex items-center gap-1 uppercase",children:[l.jsx(Xa,{size:12})," Vencimiento"]}),l.jsx("div",{className:"font-mono font-bold text-slate-700",children:a.due_date||"-"}),l.jsx("div",{className:"text-[10px] text-indigo-600 font-medium mt-1",children:u>0?`Crdito: ${u} das`:"Contado / Inmediato"})]})]}),l.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[l.jsxs("div",{className:"w-full lg:w-1/3 bg-white p-6 rounded-xl border border-slate-200 h-fit shadow-sm sticky top-4",children:[l.jsxs("h3",{className:"font-bold text-slate-700 mb-4 flex items-center gap-2 border-b pb-2",children:[l.jsx(xr,{size:18,className:"text-indigo-600"})," Agregar Material"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1 uppercase",children:"Material"}),l.jsx(fr,{placeholder:"Seleccionar o buscar SKU...",value:h.searchQuery,onChange:C=>{f({...h,searchQuery:C.target.value}),g(!0)},onFocus:()=>g(!0),onBlur:()=>setTimeout(()=>g(!1),200)}),x&&l.jsxs("div",{className:"absolute z-10 w-full bg-white border border-slate-200 rounded-md shadow-xl mt-1 max-h-60 overflow-y-auto",children:[y.map(C=>l.jsxs("div",{className:"px-4 py-2 hover:bg-indigo-50 cursor-pointer border-b last:border-0 text-sm flex justify-between items-center group",onMouseDown:()=>{f({...h,material_id:C.id,searchQuery:C.name}),g(!1)},children:[l.jsxs("div",{children:[l.jsx("div",{className:"font-bold text-slate-700 group-hover:text-indigo-700",children:C.name}),l.jsx("div",{className:"text-xs text-slate-400",children:C.sku})]}),l.jsx(la,{variant:"outline",className:"text-[10px]",children:C.usage_unit})]},C.id)),y.length===0&&l.jsx("div",{className:"p-3 text-xs text-center text-slate-400 italic",children:"No se encontraron materiales"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1 uppercase",children:"Cantidad"}),l.jsx(fr,{type:"number",value:h.quantity,onChange:C=>S(C.target.value)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1 uppercase",children:"Costo Unitario ($)"}),l.jsx(fr,{type:"number",value:h.unit_cost===0?"":h.unit_cost,onChange:C=>P(C.target.value),placeholder:"0.00"})]})]}),l.jsxs("div",{className:"bg-indigo-50 p-3 rounded text-center border border-indigo-100",children:[l.jsx("div",{className:"text-[10px] text-indigo-400 font-bold uppercase tracking-wider",children:"Total de Lnea Calculado"}),l.jsxs("div",{className:"text-xl font-black text-indigo-700",children:["$",h.line_total_cost.toFixed(2)]})]}),l.jsxs(ot,{className:"w-full bg-slate-800 hover:bg-slate-900",onClick:N,disabled:h.material_id===0,children:[l.jsx(xr,{size:16,className:"mr-2"})," Agregar a Lista"]})]})]}),l.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm flex flex-col",children:[l.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-200 font-bold text-slate-600 flex justify-between",children:[l.jsx("span",{children:"Items en Recepcin"}),l.jsx(la,{variant:"secondary",children:o.length})]}),l.jsx("div",{className:"flex-1 overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"bg-white border-b border-slate-100 text-xs uppercase text-slate-400",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 font-semibold",children:"Material"}),l.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Cant."}),l.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"Unitario"}),l.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"Total"}),l.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Acciones"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:o.map(C=>{var U;return l.jsxs("tr",{className:"hover:bg-indigo-50/30 transition-colors",children:[l.jsx("td",{className:"px-4 py-3 font-medium text-slate-700",children:C.material_name}),l.jsx("td",{className:"px-4 py-3 text-center text-slate-600",children:C.quantity}),l.jsxs("td",{className:"px-4 py-3 text-right text-slate-500",children:["$",(U=C.unit_cost_calculated)==null?void 0:U.toFixed(2)]}),l.jsxs("td",{className:"px-4 py-3 text-right font-mono font-bold text-slate-800",children:["$",C.line_total_cost.toFixed(2)]}),l.jsxs("td",{className:"px-4 py-3 text-center flex justify-center gap-2",children:[l.jsx("button",{onClick:()=>I(C.tempId),className:"p-1 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded transition-colors",children:l.jsx(lu,{size:16})}),l.jsx("button",{onClick:()=>M(C.tempId),className:"p-1 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",children:l.jsx(Rn,{size:16})})]})]},C.tempId)})})]})}),l.jsxs("div",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end items-center gap-4",children:[l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Suma Items"}),l.jsxs("div",{className:"text-lg font-bold text-slate-700",children:["$",v.toFixed(2)]})]}),!_&&v>0&&l.jsxs(ot,{variant:"secondary",className:"bg-amber-100 text-amber-800 hover:bg-amber-200 border border-amber-300",onClick:L,children:[l.jsx(H1,{size:18,className:"mr-2"}),"Ajustar Diferencia (Desc.)"]}),l.jsxs(ot,{onClick:X,disabled:p||o.length===0,className:_?"bg-indigo-600":"bg-slate-700",children:[p?"Guardando...":"Confirmar"," ",l.jsx(ou,{size:18,className:"ml-2"})]})]})]})]})]})},f5=()=>{const[e,t]=b.useState(null),[r,n]=b.useState([]),[s,a]=b.useState([]),[i,o]=b.useState(!1),[c,u]=b.useState(null),[d,h]=b.useState("TO_REQUEST"),[f,p]=b.useState(null),[m,x]=b.useState(null),[g,y]=b.useState(null);b.useEffect(()=>{v()},[]);const v=async()=>{try{const V=await _r.getPayableDashboardStats();t(V)}catch(V){console.error("Error cargando KPIs:",V)}};b.useEffect(()=>{c==="PAYABLE"&&w()},[c,d]);const w=async()=>{o(!0);try{const[V,G]=await Promise.all([_r.getPendingInvoices(),_r.getPendingApprovals()]);n(V),a(G),v()}catch(V){console.error("Error al refrescar datos",V)}finally{o(!1)}},S=(()=>{if(!f)return[];const V=new Date;V.setHours(0,0,0,0);const G=V.getDay();let J=5-G;G===6&&(J=6);const q=new Date(V);q.setDate(V.getDate()+J),q.setHours(23,59,59,999);const se=new Date(q);return se.setDate(q.getDate()+15),r.filter(ue=>{const fe=new Date(ue.due_date+"T12:00:00");return f==="THIS_FRIDAY"?fe<=q:f==="NEXT_15_DAYS"?fe>q&&fe<=se:f==="FUTURE"?fe>se:!1})})(),P=V=>V.toLocaleString("es-MX",{style:"currency",currency:"MXN"}),N=V=>{if(!V)return"-";if(V.includes("T"))return new Date(V).toLocaleDateString("es-MX",{day:"2-digit",month:"2-digit"});const[G,J,q]=V.split("-");return`${q}/${J}/${G}`},I=V=>{const G=r.find(J=>J.invoice_number===V.invoice_folio&&J.provider_name===V.provider_name);x(G||null),y(V)},M=async V=>{try{g?(await _r.updatePaymentRequest(g.id,V),alert(" Solicitud actualizada correctamente.")):(await _r.requestPayment(V),alert(" Solicitud enviada a Direccin.")),X(),w()}catch{alert(" Error al procesar la solicitud.")}},L=async V=>{if(confirm("Ests seguro de cancelar esta solicitud? Se eliminar y el saldo volver a estar disponible."))try{await _r.cancelPaymentRequest(V),w()}catch{alert("Error al cancelar la solicitud.")}},X=()=>{x(null),y(null)},C=((e==null?void 0:e.overdue_amount)||0)+((e==null?void 0:e.next_period_amount)||0)+((e==null?void 0:e.future_amount)||0),U=(e==null?void 0:e.total_pending_approval)||0,z=((e==null?void 0:e.overdue_count)||0)+((e==null?void 0:e.next_period_count)||0)+((e==null?void 0:e.future_count)||0);return l.jsxs("div",{className:"p-8 max-w-7xl mx-auto pb-24 space-y-8 animate-fadeIn",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-black text-slate-800",children:"Panel de Gerencia"}),l.jsx("p",{className:"text-slate-500",children:"Visin Estratgica y Flujo de Efectivo."})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsxs(St,{className:"p-4 opacity-60 grayscale cursor-not-allowed border-l-4 border-l-slate-400 bg-white h-full",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Cotizaciones"}),l.jsx(jE,{size:14,className:"text-slate-400"})]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-700",children:"Por Autorizar"}),l.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Prximamente"})]})]}),l.jsxs(St,{className:"p-4 opacity-60 grayscale cursor-not-allowed border-l-4 border-l-indigo-400 bg-white h-full",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Facturacin"}),l.jsx(fn,{size:14,className:"text-indigo-400"})]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-700",children:"Ventas del Mes"}),l.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Prximamente"})]})]}),l.jsxs(St,{className:"p-4 opacity-60 grayscale cursor-not-allowed border-l-4 border-l-emerald-400 bg-white h-full",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Ingresos"}),l.jsx(bl,{size:14,className:"text-emerald-400"})]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-700",children:"Ctas. por Cobrar"}),l.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Prximamente"})]})]}),l.jsxs(St,{onClick:()=>{u(c==="PAYABLE"?null:"PAYABLE"),p(null),h("TO_REQUEST")},className:`p-4 cursor-pointer hover:shadow-lg transition-all border-l-4 border-l-red-500 transform hover:-translate-y-1 h-full
                    ${c==="PAYABLE"?"ring-2 ring-red-500 bg-slate-50 shadow-md":"bg-white shadow-sm"}`,children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Cuentas x Pagar"}),l.jsx(Qi,{size:14,className:"text-red-500"})]}),l.jsxs("div",{className:"flex flex-row items-baseline mt-1 justify-between w-full",children:[z>0?l.jsx("div",{className:"text-2xl font-black text-red-600/50 animate-pulse",children:z}):l.jsx("div",{}),l.jsx("div",{className:"text-xl font-black text-red-600 text-right",children:P(C)})]}),U>0?l.jsxs("p",{className:"text-[10px] text-red-600 font-bold mt-1 flex items-center gap-1",children:[l.jsx(Xa,{size:10})," ",U," solicitudes"]}):l.jsxs("p",{className:"text-[10px] text-slate-400 mt-1 flex items-center gap-1",children:[l.jsx(Cl,{size:10})," Al da"]})]})]}),c==="PAYABLE"&&l.jsxs("div",{className:"animate-in slide-in-from-top-4 duration-300 relative mt-6 pt-6 border-t border-slate-200",children:[l.jsx("button",{onClick:()=>u(null),className:"absolute -top-3 -right-2 p-2 bg-white shadow-md rounded-full text-slate-400 hover:text-red-500 z-10",children:l.jsx(kr,{size:20})}),l.jsxs("div",{className:"flex items-center space-x-1 mb-6 bg-slate-100 p-1 rounded-lg w-fit",children:[l.jsxs("button",{onClick:()=>h("TO_REQUEST"),className:`px-4 py-2 text-sm font-bold rounded-md transition-all flex items-center gap-2 ${d==="TO_REQUEST"?"bg-white text-slate-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(Qi,{size:16})," Por Solicitar"]}),l.jsxs("button",{onClick:()=>h("REQUESTED"),className:`px-4 py-2 text-sm font-bold rounded-md transition-all flex items-center gap-2 ${d==="REQUESTED"?"bg-white text-indigo-600 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(Xa,{size:16})," En Espera de Autorizacin ",U>0&&l.jsx("span",{className:"bg-indigo-100 text-indigo-700 text-xs px-2 py-0.5 rounded-full",children:U})]})]}),d==="TO_REQUEST"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm font-bold tracking-wide mb-4",children:[l.jsx(Qi,{size:16})," ",l.jsx("span",{children:"Flujo de Efectivo: Seleccione una tarjeta para auditar"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsx(St,{onClick:()=>p("THIS_FRIDAY"),className:`p-6 cursor-pointer border transition-all group relative overflow-hidden
                                    ${f==="THIS_FRIDAY"?"bg-gradient-to-br from-red-600 to-red-700 text-white shadow-xl scale-105 border-transparent":"bg-white border-slate-200 hover:border-red-400 hover:shadow-md"}`,children:l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsxs("span",{className:`text-xs font-bold uppercase tracking-wider ${f==="THIS_FRIDAY"?"text-red-100":"text-red-600"}`,children:[l.jsx(Vn,{className:"inline mr-1 mb-1",size:14})," Pago Inmediato"]})}),l.jsx("p",{className:`text-sm mb-2 ${f==="THIS_FRIDAY"?"text-red-100":"text-slate-400"}`,children:"Vencido + Este Viernes"}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsx("div",{className:`text-xl font-bold leading-none ${f==="THIS_FRIDAY"?"text-red-200":"text-slate-300"}`,children:(e==null?void 0:e.overdue_count)||0}),l.jsx("div",{className:`text-xl font-black text-right ${f==="THIS_FRIDAY"?"text-white":"text-slate-800"}`,children:P((e==null?void 0:e.overdue_amount)||0)})]})]})}),l.jsx(St,{onClick:()=>p("NEXT_15_DAYS"),className:`p-6 cursor-pointer border transition-all group relative overflow-hidden
                                    ${f==="NEXT_15_DAYS"?"bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-xl scale-105 border-transparent":"bg-white border-slate-200 hover:border-orange-400 hover:shadow-md"}`,children:l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsxs("span",{className:`text-xs font-bold uppercase tracking-wider ${f==="NEXT_15_DAYS"?"text-orange-100":"text-orange-600"}`,children:[l.jsx(kn,{className:"inline mr-1 mb-1",size:14})," Proyeccin Corta"]})}),l.jsx("p",{className:`text-sm mb-2 ${f==="NEXT_15_DAYS"?"text-orange-100":"text-slate-400"}`,children:"Siguientes 15 Das"}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsx("div",{className:`text-xl font-bold leading-none ${f==="NEXT_15_DAYS"?"text-orange-200":"text-slate-300"}`,children:(e==null?void 0:e.next_period_count)||0}),l.jsx("div",{className:`text-xl font-black text-right ${f==="NEXT_15_DAYS"?"text-white":"text-slate-800"}`,children:P((e==null?void 0:e.next_period_amount)||0)})]})]})}),l.jsx(St,{onClick:()=>p("FUTURE"),className:`p-6 cursor-pointer border transition-all group relative overflow-hidden
                                    ${f==="FUTURE"?"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white shadow-xl scale-105 border-transparent":"bg-white border-slate-200 hover:border-emerald-400 hover:shadow-md"}`,children:l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsxs("span",{className:`text-xs font-bold uppercase tracking-wider ${f==="FUTURE"?"text-emerald-100":"text-emerald-600"}`,children:[l.jsx(wc,{className:"inline mr-1 mb-1",size:14})," Largo Plazo"]})}),l.jsx("p",{className:`text-sm mb-2 ${f==="FUTURE"?"text-emerald-100":"text-slate-400"}`,children:"Vencimientos Futuros"}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsx("div",{className:`text-xl font-bold leading-none ${f==="FUTURE"?"text-emerald-200":"text-slate-300"}`,children:(e==null?void 0:e.future_count)||0}),l.jsx("div",{className:`text-xl font-black text-right ${f==="FUTURE"?"text-white":"text-slate-800"}`,children:P((e==null?void 0:e.future_amount)||0)})]})]})})]}),f&&l.jsxs("div",{className:"animate-in slide-in-from-bottom-4 duration-500 bg-white rounded-xl shadow-xl border border-slate-200 overflow-hidden mt-8",children:[l.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-200 flex flex-col md:flex-row justify-between items-center gap-4",children:[l.jsxs("h3",{className:"font-bold text-slate-700 flex items-center gap-2 text-lg",children:[l.jsx(q1,{size:18,className:"text-slate-400"})," Auditora:",l.jsx("span",{className:`uppercase ml-1 font-black px-2 py-0.5 rounded text-sm ${f==="THIS_FRIDAY"?"bg-red-100 text-red-700":f==="NEXT_15_DAYS"?"bg-orange-100 text-orange-700":"bg-emerald-100 text-emerald-700"}`,children:f==="THIS_FRIDAY"?"Pago Inmediato":f==="NEXT_15_DAYS"?"Proyeccin 15 Das":"Futuros"})]}),l.jsxs(la,{variant:"secondary",className:"text-sm px-3 py-1",children:[S.length," Documentos"]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"text-xs text-slate-500 uppercase bg-slate-50 border-b border-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4",children:"Proveedor"}),l.jsx("th",{className:"px-6 py-4",children:"Factura"}),l.jsx("th",{className:"px-6 py-4",children:"Vencimiento"}),l.jsx("th",{className:"px-6 py-4 text-right",children:"Saldo Disponible"}),l.jsx("th",{className:"px-6 py-4 text-center",children:"Accin"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:i?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"text-center py-12 text-slate-400",children:"Cargando datos..."})}):S.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"text-center py-12 text-slate-400 italic",children:"No hay documentos pendientes."})}):S.map(V=>{const J=s.filter(ue=>ue.invoice_folio===V.invoice_number&&ue.provider_name===V.provider_name).reduce((ue,fe)=>ue+fe.amount,0),q=V.outstanding_balance-J,se=q<=.01;return l.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4 font-bold text-slate-700",children:V.provider_name}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"font-mono bg-slate-100 px-2 py-1 rounded text-slate-600 text-xs",children:V.invoice_number})}),l.jsx("td",{className:"px-6 py-4 text-slate-600",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(kn,{size:14,className:"text-slate-400"}),N(V.due_date)]})}),l.jsxs("td",{className:"px-6 py-4 text-right",children:[l.jsx("div",{className:"font-black text-slate-800",children:P(q)}),J>0&&l.jsxs("div",{className:"text-[10px] text-amber-600 italic",children:["(-",P(J)," en espera)"]})]}),l.jsx("td",{className:"px-6 py-4 text-center",children:l.jsx(ot,{size:"sm",className:`shadow-sm ${se?"bg-slate-300 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 text-white"}`,disabled:se,onClick:()=>!se&&x({...V,outstanding_balance:q}),children:se?"En Proceso":l.jsxs(l.Fragment,{children:[l.jsx(Cl,{size:16,className:"mr-1"})," Solicitar"]})})})]},V.id)})})]})})]})]}),d==="REQUESTED"&&l.jsx("div",{className:"animate-in slide-in-from-right-4 duration-300",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-slate-200 overflow-hidden",children:[l.jsxs("div",{className:"p-4 bg-indigo-50 border-b border-indigo-100 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-indigo-800 flex items-center gap-2 text-lg",children:[l.jsx(Xa,{className:"text-indigo-600"})," Solicitudes en Espera de Direccin"]}),l.jsxs(la,{variant:"secondary",className:"bg-white text-indigo-700 border border-indigo-200",children:[s.length," Solicitudes"]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm text-left",children:[l.jsx("thead",{className:"text-xs text-indigo-800 uppercase bg-indigo-50/50 border-b border-indigo-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4",children:"Proveedor"}),l.jsx("th",{className:"px-6 py-4",children:"Detalle Factura"}),l.jsx("th",{className:"px-6 py-4",children:"Monto Solicitado"}),l.jsx("th",{className:"px-6 py-4",children:"Fecha Solicitud"}),l.jsx("th",{className:"px-6 py-4 text-center",children:"Acciones"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:i?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"text-center py-12 text-slate-400",children:"Cargando solicitudes..."})}):s.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:5,className:"text-center py-12 text-slate-400 italic",children:"No hay solicitudes pendientes de aprobacin."})}):s.map(V=>l.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4 font-bold text-slate-700",children:V.provider_name}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("span",{className:"font-mono text-xs text-slate-500",children:["Folio: ",V.invoice_folio]}),V.notes&&l.jsxs("span",{className:"text-[10px] text-amber-600 mt-1 italic",children:['"',V.notes,'"']})]})}),l.jsx("td",{className:"px-6 py-4 font-black text-slate-800",children:P(V.amount)}),l.jsx("td",{className:"px-6 py-4 text-slate-500",children:new Date(V.created_at).toLocaleDateString("es-MX")}),l.jsx("td",{className:"px-6 py-4 text-center",children:l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsx("button",{onClick:()=>I(V),title:"Editar Solicitud",className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-full transition-colors",children:l.jsx(VE,{size:16})}),l.jsx("button",{onClick:()=>L(V.id),title:"Cancelar Solicitud",className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors",children:l.jsx(Rn,{size:16})})]})})]},V.id))})]})})]})})]}),(m||g)&&l.jsx(bv,{invoice:m||void 0,existingRequest:g||void 0,onClose:X,onSubmit:M})]})},h5=({children:e})=>localStorage.getItem("token")?e:l.jsx(Wf,{to:"/login",replace:!0});function p5(){return l.jsx(yE,{children:l.jsxs(fE,{children:[l.jsx(Lt,{path:"/login",element:l.jsx(P4,{})}),l.jsxs(Lt,{element:l.jsx(h5,{children:l.jsx(F4,{})}),children:[l.jsx(Lt,{path:"/",element:l.jsx(I4,{})}),l.jsx(Lt,{path:"/materials",element:l.jsx(bF,{})}),l.jsx(Lt,{path:"/providers",element:l.jsx(AF,{})}),l.jsx(Lt,{path:"/clients",element:l.jsx(jF,{})}),l.jsx(Lt,{path:"/tax-rates",element:l.jsx(kF,{})}),l.jsx(Lt,{path:"/config",element:l.jsx(RF,{})}),l.jsx(Lt,{path:"/users",element:l.jsx(M4,{})}),l.jsx(Lt,{path:"/design",element:l.jsx(DF,{})}),l.jsx(Lt,{path:"/design/versions/:id",element:l.jsx(a5,{})}),l.jsx(Lt,{path:"/sales",element:l.jsx(l5,{})}),l.jsx(Lt,{path:"/sales/new",element:l.jsx(wm,{})}),l.jsx(Lt,{path:"/sales/edit/:id",element:l.jsx(wm,{})}),l.jsx(Lt,{path:"/inventory/reception",element:l.jsx(d5,{})}),l.jsx(Lt,{path:"/management",element:l.jsx(f5,{})})]}),l.jsx(Lt,{path:"*",element:l.jsx(Wf,{to:"/",replace:!0})})]})})}R0.createRoot(document.getElementById("root")).render(l.jsx(qe.StrictMode,{children:l.jsx(p5,{})}));
